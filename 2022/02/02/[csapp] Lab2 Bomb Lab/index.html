<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[csapp] Lab2 Bomb Lab - Ubios home</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Ubios home"><meta name="msapplication-TileImage" content="/img/mylogo_h.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Ubios home"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Bomb lab for csapp."><meta property="og:type" content="blog"><meta property="og:title" content="[csapp] Lab2 Bomb Lab"><meta property="og:url" content="https://chenghuawang.github.io/2022/02/02/[csapp]%20Lab2%20Bomb%20Lab/"><meta property="og:site_name" content="Ubios home"><meta property="og:description" content="Bomb lab for csapp."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://chenghuawang.github.io/img/og_image.png"><meta property="article:published_time" content="2022-02-02T05:51:00.000Z"><meta property="article:modified_time" content="2022-02-11T07:42:30.344Z"><meta property="article:author" content="WangCH"><meta property="article:tag" content="CSAPP"><meta property="article:tag" content="computer-architecture"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://chenghuawang.github.io/2022/02/02/[csapp]%20Lab2%20Bomb%20Lab/"},"headline":"[csapp] Lab2 Bomb Lab","image":["https://chenghuawang.github.io/img/og_image.png"],"datePublished":"2022-02-02T05:51:00.000Z","dateModified":"2022-02-11T07:42:30.344Z","author":{"@type":"Person","name":"WangCH"},"publisher":{"@type":"Organization","name":"Ubios home","logo":{"@type":"ImageObject","url":"https://chenghuawang.github.io/img/mylogo_h.png"}},"description":"Bomb lab for csapp."}</script><link rel="canonical" href="https://chenghuawang.github.io/2022/02/02/[csapp]%20Lab2%20Bomb%20Lab/"><link rel="icon" href="/img/mylogo_h.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/mylogo_h.png" alt="Ubios home" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/chenghuaWang"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-02-02T05:51:00.000Z" title="2022/2/2 下午1:51:00">2022-02-02</time>发表</span><span class="level-item"><time dateTime="2022-02-11T07:42:30.344Z" title="2022/2/11 下午3:42:30">2022-02-11</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/computer-architecture/">computer architecture</a></span><span class="level-item">25 分钟读完 (大约3740个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">[csapp] Lab2 Bomb Lab</h1><div class="content"><h1 id="Lab2-Bomb-Lab"><a href="#Lab2-Bomb-Lab" class="headerlink" title="Lab2 Bomb Lab"></a>Lab2 Bomb Lab</h1><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>熟悉GDB调试工具，熟悉 objdump 反汇编，熟悉汇编代码阅读。</p>
<h1 id="2-Puzzle"><a href="#2-Puzzle" class="headerlink" title="2. Puzzle"></a>2. Puzzle</h1><h2 id="2-1-Phase-1"><a href="#2-1-Phase-1" class="headerlink" title="2.1 Phase 1"></a>2.1 Phase 1</h2><p>首先使用 <code>objdump -d bomb</code> 获得bomb文件的反编译代码。可以在 <code>0000000000400da0 &lt;main&gt;:</code>函数中找到 <code>phase_1</code> 的函数入口。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">400e32:	e8 67 06 00 00       	callq  40149e &lt;read_line&gt;</span><br><span class="line">400e37:	48 89 c7             	mov    %rax,%rdi</span><br><span class="line">400e3a:	e8 a1 00 00 00       	callq  400ee0 &lt;phase_1&gt;</span><br><span class="line">400e3f:	e8 80 07 00 00       	callq  4015c4 &lt;phase_defused&gt;</span><br></pre></td></tr></table></figure>

<p>跳转到 <code>phase_1</code> 函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0000000000400ee0 &lt;phase_1&gt;:</span><br><span class="line">  400ee0:	48 83 ec 08          	sub    $0x8,%rsp</span><br><span class="line">  400ee4:	be 00 24 40 00       	mov    $0x402400,%esi</span><br><span class="line">  400ee9:	e8 4a 04 00 00       	callq  401338 &lt;strings_not_equal&gt;</span><br><span class="line">  400eee:	85 c0                	test   %eax,%eax</span><br><span class="line">  400ef0:	74 05                	je     400ef7 &lt;phase_1+0x17&gt;</span><br><span class="line">  400ef2:	e8 43 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400ef7:	48 83 c4 08          	add    $0x8,%rsp</span><br><span class="line">  400efb:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>这段代码只是在比对两个值。我们可以看到 <code>$0x402400</code> 被移动到了 <code>%esi</code> 中，其实我们已经可以猜到这个就是答案，再gdb中查看这个地址里面存储的string，得到 <code>Border relations with Canada have never been better.</code> 。至此，第一个puzzle解除。</p>
<p>我们在这里再分析一下 <code>callq  401338 &lt;strings_not_equal&gt;</code> 函数。下面使用 <code>--</code> 表示注释</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">0000000000401338 &lt;strings_not_equal&gt;: ;-- input is(char* a, char*b)</span><br><span class="line">  401338:	41 54                	push   %r12; -- callee saved</span><br><span class="line">  40133a:	55                   	push   %rbp; -- callee saved</span><br><span class="line">  40133b:	53                   	push   %rbx; -- callee saved</span><br><span class="line">  40133c:	48 89 fb             	mov    %rdi,%rbx; -- parameter1 type:char*</span><br><span class="line">  40133f:	48 89 f5             	mov    %rsi,%rbp; -- parameter2 type:char*</span><br><span class="line">  401342:	e8 d4 ff ff ff       	callq  40131b &lt;string_length&gt;</span><br><span class="line">  401347:	41 89 c4             	mov    %eax,%r12d; --%r12d len(char* a)</span><br><span class="line">  40134a:	48 89 ef             	mov    %rbp,%rdi</span><br><span class="line">  40134d:	e8 c9 ff ff ff       	callq  40131b &lt;string_length&gt;</span><br><span class="line">  401352:	ba 01 00 00 00       	mov    $0x1,%edx</span><br><span class="line">  401357:	41 39 c4             	cmp    %eax,%r12d --% last len is store in %eax</span><br><span class="line">  40135a:	75 3f                	jne    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  40135c:	0f b6 03             	movzbl (%rbx),%eax</span><br><span class="line">  40135f:	84 c0                	test   %al,%al</span><br><span class="line">  401361:	74 25                	je     401388 &lt;strings_not_equal+0x50&gt;</span><br><span class="line">  401363:	3a 45 00             	cmp    0x0(%rbp),%al</span><br><span class="line">  401366:	74 0a                	je     401372 &lt;strings_not_equal+0x3a&gt;</span><br><span class="line">  401368:	eb 25                	jmp    40138f &lt;strings_not_equal+0x57&gt;</span><br><span class="line">  40136a:	3a 45 00             	cmp    0x0(%rbp),%al</span><br><span class="line">  40136d:	0f 1f 00             	nopl   (%rax)</span><br><span class="line">  401370:	75 24                	jne    401396 &lt;strings_not_equal+0x5e&gt;</span><br><span class="line">  401372:	48 83 c3 01          	add    $0x1,%rbx</span><br><span class="line">  401376:	48 83 c5 01          	add    $0x1,%rbp</span><br><span class="line">  40137a:	0f b6 03             	movzbl (%rbx),%eax</span><br><span class="line">  40137d:	84 c0                	test   %al,%al</span><br><span class="line">  40137f:	75 e9                	jne    40136a &lt;strings_not_equal+0x32&gt;; --char loop</span><br><span class="line">  401381:	ba 00 00 00 00       	mov    $0x0,%edx</span><br><span class="line">  401386:	eb 13                	jmp    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  401388:	ba 00 00 00 00       	mov    $0x0,%edx</span><br><span class="line">  40138d:	eb 0c                	jmp    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  40138f:	ba 01 00 00 00       	mov    $0x1,%edx</span><br><span class="line">  401394:	eb 05                	jmp    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  401396:	ba 01 00 00 00       	mov    $0x1,%edx</span><br><span class="line">  40139b:	89 d0                	mov    %edx,%eax; -- return not eql is true</span><br><span class="line">  40139d:	5b                   	pop    %rbx</span><br><span class="line">  40139e:	5d                   	pop    %rbp</span><br><span class="line">  40139f:	41 5c                	pop    %r12</span><br><span class="line">  4013a1:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>本函数先是判断两个字符串的长度，然后再逐字符判断，如果两个字符串的长度不相等，或者其中有字符不相等，那么返回 <code>true</code> ，反之返回 <code>false</code> 。</p>
<h2 id="2-2-phase-2"><a href="#2-2-phase-2" class="headerlink" title="2.2 phase 2"></a>2.2 phase 2</h2><p>同理，找到 <code>phase_2</code> 的函数入口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">0000000000400efc &lt;phase_2&gt;:</span><br><span class="line">  400efc:	55                   	push   %rbp</span><br><span class="line">  400efd:	53                   	push   %rbx</span><br><span class="line">  400efe:	48 83 ec 28          	sub    $0x28,%rsp</span><br><span class="line">  400f02:	48 89 e6             	mov    %rsp,%rsi</span><br><span class="line">  400f05:	e8 52 05 00 00       	callq  40145c &lt;read_six_numbers&gt;</span><br><span class="line">  400f0a:	83 3c 24 01          	cmpl   $0x1,(%rsp)</span><br><span class="line">  400f0e:	74 20                	je     400f30 &lt;phase_2+0x34&gt;</span><br><span class="line">  400f10:	e8 25 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400f15:	eb 19                	jmp    400f30 &lt;phase_2+0x34&gt;</span><br><span class="line">  400f17:	8b 43 fc             	mov    -0x4(%rbx),%eax</span><br><span class="line">  400f1a:	01 c0                	add    %eax,%eax</span><br><span class="line">  400f1c:	39 03                	cmp    %eax,(%rbx)</span><br><span class="line">  400f1e:	74 05                	je     400f25 &lt;phase_2+0x29&gt;</span><br><span class="line">  400f20:	e8 15 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400f25:	48 83 c3 04          	add    $0x4,%rbx</span><br><span class="line">  400f29:	48 39 eb             	cmp    %rbp,%rbx</span><br><span class="line">  400f2c:	75 e9                	jne    400f17 &lt;phase_2+0x1b&gt;</span><br><span class="line">  400f2e:	eb 0c                	jmp    400f3c &lt;phase_2+0x40&gt;</span><br><span class="line">  400f30:	48 8d 5c 24 04       	lea    0x4(%rsp),%rbx</span><br><span class="line">  400f35:	48 8d 6c 24 18       	lea    0x18(%rsp),%rbp</span><br><span class="line">  400f3a:	eb db                	jmp    400f17 &lt;phase_2+0x1b&gt;</span><br><span class="line">  400f3c:	48 83 c4 28          	add    $0x28,%rsp</span><br><span class="line">  400f40:	5b                   	pop    %rbx</span><br><span class="line">  400f41:	5d                   	pop    %rbp</span><br><span class="line">  400f42:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>这段代码实际上是一个非常简单的循环。可以看到在 callee-saved 参数后，申请了 28 byte的内存。之后把栈顶的 <code>%rsp mov to %rsi</code> 是因为在之后 call 的函数中又会覆盖掉 <code>%rsp</code> 现有的参数，所以先做了备份，然后进入了 <code>read_six_number</code>函数，这个函数显然是读入6个数字。我们进入到这个函数具体看。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">000000000040145c &lt;read_six_numbers&gt;:</span><br><span class="line">  40145c:	48 83 ec 18          	sub    $0x18,%rsp</span><br><span class="line">  401460:	48 89 f2             	mov    %rsi,%rdx</span><br><span class="line">  401463:	48 8d 4e 04          	lea    0x4(%rsi),%rcx</span><br><span class="line">  401467:	48 8d 46 14          	lea    0x14(%rsi),%rax</span><br><span class="line">  40146b:	48 89 44 24 08       	mov    %rax,0x8(%rsp)</span><br><span class="line">  401470:	48 8d 46 10          	lea    0x10(%rsi),%rax</span><br><span class="line">  401474:	48 89 04 24          	mov    %rax,(%rsp)</span><br><span class="line">  401478:	4c 8d 4e 0c          	lea    0xc(%rsi),%r9</span><br><span class="line">  40147c:	4c 8d 46 08          	lea    0x8(%rsi),%r8</span><br><span class="line">  401480:	be c3 25 40 00       	mov    $0x4025c3,%esi</span><br><span class="line">  401485:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  40148a:	e8 61 f7 ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  40148f:	83 f8 05             	cmp    $0x5,%eax</span><br><span class="line">  401492:	7f 05                	jg     401499 &lt;read_six_numbers+0x3d&gt;</span><br><span class="line">  401494:	e8 a1 ff ff ff       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  401499:	48 83 c4 18          	add    $0x18,%rsp</span><br><span class="line">  40149d:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>我们首先看到有一个 <code>sscanf</code> 函数，那么按照惯例，其上的 <code>%esi</code> 应该是传入这个函数的参数，在gdb中打印这个参数看到 <code>&quot;%d %d %d %d %d %d&quot;</code> 显然。然后我们分析这6个数字在 stack 和 register 中是怎么存储的。</p>
<p>首先这里的 <code>%rsi</code> 是从 <code>phase_2</code> 这个函数中得到的参数，其参数是 <code>phase_2</code> 函数中申请到的 stack top。</p>
<ul>
<li><code>%rdx</code> 存储的实际上是  <code>phase_2</code> 的 stack top。存储的是第一个参数</li>
<li><code>%rcx</code> 是 stack top + 0x4。存储第二个参数。显然这里的参数类型是 int。</li>
<li><code>%r8</code> 是 stack top + 0x8。存储第三个参数。</li>
<li><code>%r9</code> 是 stack top + 0xc。存储第四个参数。</li>
</ul>
<p>之后的两个值需要压栈传参。</p>
<ul>
<li>stack top + 0x10。在 <code>read_six_numbers</code> 函数中是 <code>%rsp</code> 。存储第五个参数。</li>
<li>stack top + 0x14。在 <code>read_six_numbers</code> 函数中是 <code>%rsp + 0x8</code>  。存储第二个参数。</li>
</ul>
<p>函数之后再接受了 <code>sscanf</code> 的参数，得到参数数量，并作比较。</p>
<p>再看 <code>phase_2</code> 函数就非常简单了，转换为C语言表述如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((*rsp[<span class="number">0</span>]) == <span class="number">1</span>)&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*rsp[i+<span class="number">1</span>])!=(*rsp[i]*<span class="number">2</span>)) explode_bomb();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	explode_bomb();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据这个思路，得到最终的结果为 <code>1,2,4,8,16,32</code> </p>
<h2 id="2-3-phase-3"><a href="#2-3-phase-3" class="headerlink" title="2.3 phase 3"></a>2.3 phase 3</h2><p>同理，找到 <code>phase_3</code> 的函数入口</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000400f</span>43 &lt;phase_3&gt;:</span><br><span class="line">  <span class="number">400f</span>43:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">18</span>          	sub    $<span class="number">0x18</span>,%rsp</span><br><span class="line">  <span class="number">400f</span>47:	<span class="number">48</span> <span class="number">8</span>d <span class="number">4</span>c <span class="number">24</span> <span class="number">0</span>c       	lea    <span class="number">0xc</span>(%rsp),%rcx</span><br><span class="line">  <span class="number">400f</span>4c:	<span class="number">48</span> <span class="number">8</span>d <span class="number">54</span> <span class="number">24</span> <span class="number">08</span>       	lea    <span class="number">0x8</span>(%rsp),%rdx</span><br><span class="line">  <span class="number">400f</span>51:	be cf <span class="number">25</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x4025cf</span>,%esi</span><br><span class="line">  <span class="number">400f</span>56:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax</span><br><span class="line">  <span class="number">400f</span>5b:	e8 <span class="number">90</span> fc ff ff       	callq  <span class="number">400b</span>f0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  <span class="number">400f</span>60:	<span class="number">83</span> f8 <span class="number">01</span>             	cmp    $<span class="number">0x1</span>,%eax</span><br><span class="line">  <span class="number">400f</span>63:	<span class="number">7f</span> <span class="number">05</span>                	jg     <span class="number">400f</span>6a &lt;phase_3+<span class="number">0x27</span>&gt;</span><br><span class="line">  <span class="number">400f</span>65:	e8 d0 <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">400f</span>6a:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">08</span> <span class="number">07</span>       	cmpl   $<span class="number">0x7</span>,<span class="number">0x8</span>(%rsp)</span><br><span class="line">  <span class="number">400f</span>6f:	<span class="number">77</span> <span class="number">3</span>c                	ja     <span class="number">400f</span>ad &lt;phase_3+<span class="number">0x6a</span>&gt;</span><br><span class="line">  <span class="number">400f</span>71:	<span class="number">8b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">08</span>          	mov    <span class="number">0x8</span>(%rsp),%eax</span><br><span class="line">  <span class="number">400f</span>75:	ff <span class="number">24</span> c5 <span class="number">70</span> <span class="number">24</span> <span class="number">40</span> <span class="number">00</span> 	jmpq   *<span class="number">0x402470</span>(,%rax,<span class="number">8</span>)</span><br><span class="line">  <span class="number">400f</span>7c:	b8 cf <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0xcf</span>,%eax  -- 当第一个数为<span class="number">0</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>81:	eb <span class="number">3b</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>83:	b8 c3 <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x2c3</span>,%eax -- 当第一个数为<span class="number">2</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>88:	eb <span class="number">34</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>8a:	b8 <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x100</span>,%eax -- 当第一个数为<span class="number">3</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>8f:	eb <span class="number">2</span>d                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>91:	b8 <span class="number">85</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x185</span>,%eax -- 当第一个数为<span class="number">4</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>96:	eb <span class="number">26</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>98:	b8 ce <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0xce</span>,%eax  -- 当第一个数为<span class="number">5</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>9d:	eb <span class="number">1f</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>9f:	b8 aa <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x2aa</span>,%eax -- 当第一个数为<span class="number">6</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>a4:	eb <span class="number">18</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>a6:	b8 <span class="number">47</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x147</span>,%eax</span><br><span class="line">  <span class="number">400f</span>ab:	eb <span class="number">11</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>ad:	e8 <span class="number">88</span> <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">400f</span>b2:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax</span><br><span class="line">  <span class="number">400f</span>b7:	eb <span class="number">05</span>                	jmp    <span class="number">400f</span>be &lt;phase_3+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">400f</span>b9:	b8 <span class="number">37</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x137</span>,%eax -- 当第一个数为<span class="number">1</span>时跳转到此处</span><br><span class="line">  <span class="number">400f</span>be:	<span class="number">3b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">0</span>c          	cmp    <span class="number">0xc</span>(%rsp),%eax</span><br><span class="line">  <span class="number">400f</span>c2:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">400f</span>c9 &lt;phase_3+<span class="number">0x86</span>&gt;</span><br><span class="line">  <span class="number">400f</span>c4:	e8 <span class="number">71</span> <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">400f</span>c9:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">18</span>          	add    $<span class="number">0x18</span>,%rsp</span><br><span class="line">  <span class="number">400f</span>cd:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>首先，栈申请了 18 byte。盲猜用 <code>sscanf</code> 传入了两个 int 类型的参数，使用 gdb 打印 <code>0x4025cf</code> 位置的内存，得到 <code>&quot;%d %d&quot;</code> ，正确。接下来做了一个判断，判断传进来的参数量。然后判断了传进来的第一个参数是否小于7，跳转跳转到<code>0x402470+8*%eax</code>地址所存储的地址。发现 <code>%eax</code> 与输入有关。比如我现在的 <code>%rax</code> 是 0，那么跳转的地址就是 <code>0x402470</code> 中存储的值 0xf7c，把 <code>0xcf</code> 写入到 <code>%eax</code> 中进行比较。这里有多个答案，第一个数从0→6都行，后面的数按照这个跳转表来就行。</p>
<h2 id="2-4-phase-4"><a href="#2-4-phase-4" class="headerlink" title="2.4 phase 4"></a>2.4 phase 4</h2><p>同理，找到 <code>phase_4</code> 的函数入口</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">000000000040100</span>c &lt;phase_4&gt;:</span><br><span class="line">  <span class="number">40100</span>c:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">18</span>          	sub    $<span class="number">0x18</span>,%rsp</span><br><span class="line">  <span class="number">401010</span>:	<span class="number">48</span> <span class="number">8</span>d <span class="number">4</span>c <span class="number">24</span> <span class="number">0</span>c       	lea    <span class="number">0xc</span>(%rsp),%rcx</span><br><span class="line">  <span class="number">401015</span>:	<span class="number">48</span> <span class="number">8</span>d <span class="number">54</span> <span class="number">24</span> <span class="number">08</span>       	lea    <span class="number">0x8</span>(%rsp),%rdx</span><br><span class="line">  <span class="number">40101</span>a:	be cf <span class="number">25</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x4025cf</span>,%esi</span><br><span class="line">  <span class="number">40101f</span>:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax</span><br><span class="line">  <span class="number">401024</span>:	e8 c7 fb ff ff       	callq  <span class="number">400b</span>f0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  <span class="number">401029</span>:	<span class="number">83</span> f8 <span class="number">02</span>             	cmp    $<span class="number">0x2</span>,%eax</span><br><span class="line">  <span class="number">40102</span>c:	<span class="number">75</span> <span class="number">07</span>                	jne    <span class="number">401035</span> &lt;phase_4+<span class="number">0x29</span>&gt;</span><br><span class="line">  <span class="number">40102</span>e:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">08</span> <span class="number">0</span>e       	cmpl   $<span class="number">0xe</span>,<span class="number">0x8</span>(%rsp)</span><br><span class="line">  <span class="number">401033</span>:	<span class="number">76</span> <span class="number">05</span>                	jbe    <span class="number">40103</span>a &lt;phase_4+<span class="number">0x2e</span>&gt;</span><br><span class="line">  <span class="number">401035</span>:	e8 <span class="number">00</span> <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">40103</span>a:	ba <span class="number">0</span>e <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0xe</span>,%edx</span><br><span class="line">  <span class="number">40103f</span>:	be <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%esi</span><br><span class="line">  <span class="number">401044</span>:	<span class="number">8b</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">08</span>          	mov    <span class="number">0x8</span>(%rsp),%edi</span><br><span class="line">  <span class="number">401048</span>:	e8 <span class="number">81</span> ff ff ff       	callq  <span class="number">400f</span>ce &lt;func4&gt;</span><br><span class="line">  <span class="number">40104</span>d:	<span class="number">85</span> c0                	test   %eax,%eax</span><br><span class="line">  <span class="number">40104f</span>:	<span class="number">75</span> <span class="number">07</span>                	jne    <span class="number">401058</span> &lt;phase_4+<span class="number">0x4c</span>&gt;</span><br><span class="line">  <span class="number">401051</span>:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">0</span>c <span class="number">00</span>       	cmpl   $<span class="number">0x0</span>,<span class="number">0xc</span>(%rsp)</span><br><span class="line">  <span class="number">401056</span>:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">40105</span>d &lt;phase_4+<span class="number">0x51</span>&gt;</span><br><span class="line">  <span class="number">401058</span>:	e8 dd <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">40105</span>d:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">18</span>          	add    $<span class="number">0x18</span>,%rsp</span><br><span class="line">  <span class="number">401061</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p><code>sscanf</code> 读入了 <code>%d %d</code> 到 <code>%rdx %rcx</code> ，假设读入的两个参数是 <code>a,b</code> 。</p>
<p>用c语言描述这个函数就是:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phase_4</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a, b;</span><br><span class="line">	<span class="keyword">int</span> c = <span class="built_in">sscanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">	<span class="keyword">if</span> (c != <span class="number">2</span>)&#123;explode_bomb();&#125;</span><br><span class="line">	<span class="keyword">if</span> (a &lt;= <span class="number">0xe</span>)&#123;</span><br><span class="line">		<span class="keyword">int</span> fans = func4(a, <span class="number">0x0</span>, <span class="number">0xe</span>);</span><br><span class="line">		<span class="keyword">if</span> (fans != <span class="number">0</span> || b != <span class="number">0</span>)&#123;</span><br><span class="line">			explode_bomb();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		explode_bomb();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明 fans 和 输入的 b 都必须是 0。如果 14 ≤ a，跳转到 <code>func4</code> ， <code>func4</code> 的入口：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000400f</span>ce &lt;func4&gt;:</span><br><span class="line">  <span class="number">400f</span>ce:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">08</span>          	sub    $<span class="number">0x8</span>,%rsp</span><br><span class="line">  <span class="number">400f</span>d2:	<span class="number">89</span> d0                	mov    %edx,%eax</span><br><span class="line">  <span class="number">400f</span>d4:	<span class="number">29</span> f0                	sub    %esi,%eax</span><br><span class="line">  <span class="number">400f</span>d6:	<span class="number">89</span> c1                	mov    %eax,%ecx</span><br><span class="line">  <span class="number">400f</span>d8:	c1 e9 <span class="number">1f</span>             	shr    $<span class="number">0x1f</span>,%ecx</span><br><span class="line">  <span class="number">400f</span>db:	<span class="number">01</span> c8                	add    %ecx,%eax</span><br><span class="line">  <span class="number">400f</span>dd:	d1 f8                	sar    %eax</span><br><span class="line">  <span class="number">400f</span>df:	<span class="number">8</span>d <span class="number">0</span>c <span class="number">30</span>             	lea    (%rax,%rsi,<span class="number">1</span>),%ecx</span><br><span class="line">  <span class="number">400f</span>e2:	<span class="number">39</span> f9                	cmp    %edi,%ecx</span><br><span class="line">  <span class="number">400f</span>e4:	<span class="number">7</span>e <span class="number">0</span>c                	jle    <span class="number">400f</span>f2 &lt;func4+<span class="number">0x24</span>&gt;</span><br><span class="line">  <span class="number">400f</span>e6:	<span class="number">8</span>d <span class="number">51</span> ff             	lea    <span class="number">-0x1</span>(%rcx),%edx</span><br><span class="line">  <span class="number">400f</span>e9:	e8 e0 ff ff ff       	callq  <span class="number">400f</span>ce &lt;func4&gt;</span><br><span class="line">  <span class="number">400f</span>ee:	<span class="number">01</span> c0                	add    %eax,%eax</span><br><span class="line">  <span class="number">400f</span>f0:	eb <span class="number">15</span>                	jmp    <span class="number">401007</span> &lt;func4+<span class="number">0x39</span>&gt;</span><br><span class="line">  <span class="number">400f</span>f2:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax</span><br><span class="line">  <span class="number">400f</span>f7:	<span class="number">39</span> f9                	cmp    %edi,%ecx</span><br><span class="line">  <span class="number">400f</span>f9:	<span class="number">7</span>d <span class="number">0</span>c                	jge    <span class="number">401007</span> &lt;func4+<span class="number">0x39</span>&gt;</span><br><span class="line">  <span class="number">400f</span>fb:	<span class="number">8</span>d <span class="number">71</span> <span class="number">01</span>             	lea    <span class="number">0x1</span>(%rcx),%esi</span><br><span class="line">  <span class="number">400f</span>fe:	e8 cb ff ff ff       	callq  <span class="number">400f</span>ce &lt;func4&gt;</span><br><span class="line">  <span class="number">401003</span>:	<span class="number">8</span>d <span class="number">44</span> <span class="number">00</span> <span class="number">01</span>          	lea    <span class="number">0x1</span>(%rax,%rax,<span class="number">1</span>),%eax</span><br><span class="line">  <span class="number">401007</span>:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">08</span>          	add    $<span class="number">0x8</span>,%rsp</span><br><span class="line">  <span class="number">40100b</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>用c语言描述 <code>func4</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// edi-&gt;a, esi-&gt;b, edx-&gt;c</span></span><br><span class="line"><span class="comment">// the rules of X86-64 conventional set %rdi, %rsi, %rdx as 1-&gt;3 parameters&#x27; register.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func4</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans = c - b;</span><br><span class="line">	<span class="keyword">int</span> tmp = ans &gt;&gt; <span class="number">31</span>;  <span class="comment">// tmp is register %ecx in func4.</span></span><br><span class="line">	ans = (tmp + ans) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	tmp = ans + b;</span><br><span class="line">	<span class="keyword">if</span> (a &gt;= tmp)&#123;</span><br><span class="line">		ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (a &lt;= tmp)&#123;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			b = c + <span class="number">1</span>;</span><br><span class="line">			ans = func4(a, b, c);</span><br><span class="line">			ans = <span class="number">2</span> * ans + <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		c = tmp - <span class="number">1</span>;</span><br><span class="line">		ans = func4(a, b, c);</span><br><span class="line">		<span class="keyword">return</span> ans * <span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了让输出是 0 ，当 tmp = a 时返回的 ans=0 ，因为 b = 0x0，c = 0xe，tmp = 7 = ans</p>
<p>所以最终的答案是 <code>0 7</code></p>
<h2 id="2-5-phase-5"><a href="#2-5-phase-5" class="headerlink" title="2.5 phase 5"></a>2.5 phase 5</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000401062</span> &lt;phase_5&gt;:</span><br><span class="line">  <span class="number">401062</span>:	<span class="number">53</span>                   	push   %rbx</span><br><span class="line">  <span class="number">401063</span>:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">20</span>          	sub    $<span class="number">0x20</span>,%rsp  <span class="comment">// stack frame depth 0x20 byte</span></span><br><span class="line">  <span class="number">401067</span>:	<span class="number">48</span> <span class="number">89</span> fb             	mov    %rdi,%rbx  <span class="comment">// A parameter load in, string address</span></span><br><span class="line">  <span class="number">40106</span>a:	<span class="number">64</span> <span class="number">48</span> <span class="number">8b</span> <span class="number">04</span> <span class="number">25</span> <span class="number">28</span> <span class="number">00</span> 	mov    %fs:<span class="number">0x28</span>,%rax  <span class="comment">// canary of stack;</span></span><br><span class="line">  <span class="number">401071</span>:	<span class="number">00</span> <span class="number">00</span> </span><br><span class="line">  <span class="number">401073</span>:	<span class="number">48</span> <span class="number">89</span> <span class="number">44</span> <span class="number">24</span> <span class="number">18</span>       	mov    %rax,<span class="number">0x18</span>(%rsp)  <span class="comment">// canary store.</span></span><br><span class="line">  <span class="number">401078</span>:	<span class="number">31</span> c0                	<span class="keyword">xor</span>    %eax,%eax</span><br><span class="line">  <span class="number">40107</span>a:	e8 <span class="number">9</span>c <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40131b</span> &lt;string_length&gt; <span class="comment">// string address is %rbx</span></span><br><span class="line">  <span class="number">40107f</span>:	<span class="number">83</span> f8 <span class="number">06</span>             	cmp    $<span class="number">0x6</span>,%eax  <span class="comment">// find string length must be 6;</span></span><br><span class="line">  <span class="number">401082</span>:	<span class="number">74</span> <span class="number">4</span>e                	je     <span class="number">4010</span>d2 &lt;phase_5+<span class="number">0x70</span>&gt;</span><br><span class="line">  <span class="number">401084</span>:	e8 b1 <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">401089</span>:	eb <span class="number">47</span>                	jmp    <span class="number">4010</span>d2 &lt;phase_5+<span class="number">0x70</span>&gt;</span><br><span class="line">  <span class="number">40108b</span>:	<span class="number">0f</span> b6 <span class="number">0</span>c <span class="number">03</span>          	movzbl (%rbx,%rax,<span class="number">1</span>),%ecx  <span class="comment">// get single character</span></span><br><span class="line">  <span class="number">40108f</span>:	<span class="number">88</span> <span class="number">0</span>c <span class="number">24</span>             	mov    %cl,(%rsp)</span><br><span class="line">  <span class="number">401092</span>:	<span class="number">48</span> <span class="number">8b</span> <span class="number">14</span> <span class="number">24</span>          	mov    (%rsp),%rdx <span class="comment">// move single character to rdx</span></span><br><span class="line">  <span class="number">401096</span>:	<span class="number">83</span> e2 <span class="number">0f</span>             	<span class="keyword">and</span>    $<span class="number">0xf</span>,%edx <span class="comment">// get lower-bits of %rdx</span></span><br><span class="line">  <span class="number">401099</span>:	<span class="number">0f</span> b6 <span class="number">92</span> b0 <span class="number">24</span> <span class="number">40</span> <span class="number">00</span> 	movzbl <span class="number">0x4024b0</span>(%rdx),%edx</span><br><span class="line">  <span class="number">4010</span>a0:	<span class="number">88</span> <span class="number">54</span> <span class="number">04</span> <span class="number">10</span>          	mov    %dl,<span class="number">0x10</span>(%rsp,%rax,<span class="number">1</span>)</span><br><span class="line">  <span class="number">4010</span>a4:	<span class="number">48</span> <span class="number">83</span> c0 <span class="number">01</span>          	add    $<span class="number">0x1</span>,%rax</span><br><span class="line">  <span class="number">4010</span>a8:	<span class="number">48</span> <span class="number">83</span> f8 <span class="number">06</span>          	cmp    $<span class="number">0x6</span>,%rax <span class="comment">// loop 6 times.</span></span><br><span class="line">  <span class="number">4010</span>ac:	<span class="number">75</span> dd                	jne    <span class="number">40108b</span> &lt;phase_5+<span class="number">0x29</span>&gt;</span><br><span class="line">  <span class="number">4010</span>ae:	c6 <span class="number">44</span> <span class="number">24</span> <span class="number">16</span> <span class="number">00</span>       	movb   $<span class="number">0x0</span>,<span class="number">0x16</span>(%rsp) <span class="comment">// last &#x27;\0&#x27; in string.</span></span><br><span class="line">  <span class="number">4010b</span>3:	be <span class="number">5</span>e <span class="number">24</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x40245e</span>,%esi <span class="comment">// compare string %esi and %rdi</span></span><br><span class="line">  <span class="number">4010b</span>8:	<span class="number">48</span> <span class="number">8</span>d <span class="number">7</span>c <span class="number">24</span> <span class="number">10</span>       	lea    <span class="number">0x10</span>(%rsp),%rdi <span class="comment">// compare string %esi and %rdi</span></span><br><span class="line">  <span class="number">4010b</span>d:	e8 <span class="number">76</span> <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">401338</span> &lt;strings_not_equal&gt;</span><br><span class="line">  <span class="number">4010</span>c2:	<span class="number">85</span> c0                	test   %eax,%eax</span><br><span class="line">  <span class="number">4010</span>c4:	<span class="number">74</span> <span class="number">13</span>                	je     <span class="number">4010</span>d9 &lt;phase_5+<span class="number">0x77</span>&gt;</span><br><span class="line">  <span class="number">4010</span>c6:	e8 <span class="number">6f</span> <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">4010</span>cb:	<span class="number">0f</span> <span class="number">1f</span> <span class="number">44</span> <span class="number">00</span> <span class="number">00</span>       	nopl   <span class="number">0x0</span>(%rax,%rax,<span class="number">1</span>)</span><br><span class="line">  <span class="number">4010</span>d0:	eb <span class="number">07</span>                	jmp    <span class="number">4010</span>d9 &lt;phase_5+<span class="number">0x77</span>&gt;</span><br><span class="line">  <span class="number">4010</span>d2:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax  <span class="comment">// set ans = 0;</span></span><br><span class="line">  <span class="number">4010</span>d7:	eb b2                	jmp    <span class="number">40108b</span> &lt;phase_5+<span class="number">0x29</span>&gt;</span><br><span class="line">  <span class="number">4010</span>d9:	<span class="number">48</span> <span class="number">8b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">18</span>       	mov    <span class="number">0x18</span>(%rsp),%rax</span><br><span class="line">  <span class="number">4010</span>de:	<span class="number">64</span> <span class="number">48</span> <span class="number">33</span> <span class="number">04</span> <span class="number">25</span> <span class="number">28</span> <span class="number">00</span> 	<span class="keyword">xor</span>    %fs:<span class="number">0x28</span>,%rax</span><br><span class="line">  <span class="number">4010e5</span>:	<span class="number">00</span> <span class="number">00</span> </span><br><span class="line">  <span class="number">4010e7</span>:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">4010</span>ee &lt;phase_5+<span class="number">0x8c</span>&gt;</span><br><span class="line">  <span class="number">4010e9</span>:	e8 <span class="number">42</span> fa ff ff       	callq  <span class="number">400b</span>30 &lt;__stack_chk_fail@plt&gt;  <span class="comment">// stack canary</span></span><br><span class="line">  <span class="number">4010</span>ee:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">20</span>          	add    $<span class="number">0x20</span>,%rsp</span><br><span class="line">  <span class="number">4010f</span>2:	<span class="number">5b</span>                   	pop    %rbx</span><br><span class="line">  <span class="number">4010f</span>3:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>gdb 打印 <code>0x4024b0</code> 处的字符串，得到 <code>maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?</code> 打印位于 <code>0x40245e</code> 处的字符串，得到 <code>&quot;flyers&quot;</code> 。显然最后的结果需要与这个作比较。如代码中的注释显示，这里做的操作就是读取我输入的字符串的每个字符，然后把这个字符的后4个bit取出来作为 offsite 在 <code>0x4024b0</code> 处的字符串中找到相应的字符。</p>
<h2 id="2-6-phase-6-loop-amp-linked-list"><a href="#2-6-phase-6-loop-amp-linked-list" class="headerlink" title="2.6 phase 6 loop &amp; linked-list"></a>2.6 phase 6 loop &amp; linked-list</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00000000004010f</span>4 &lt;phase_6&gt;:</span><br><span class="line">  <span class="number">4010f</span>4:	<span class="number">41</span> <span class="number">56</span>                	push   %r14</span><br><span class="line">  <span class="number">4010f</span>6:	<span class="number">41</span> <span class="number">55</span>                	push   %r13</span><br><span class="line">  <span class="number">4010f</span>8:	<span class="number">41</span> <span class="number">54</span>                	push   %r12</span><br><span class="line">  <span class="number">4010f</span>a:	<span class="number">55</span>                   	push   %rbp</span><br><span class="line">  <span class="number">4010f</span>b:	<span class="number">53</span>                   	push   %rbx</span><br><span class="line">  <span class="number">4010f</span>c:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">50</span>          	sub    $<span class="number">0x50</span>,%rsp <span class="comment">// stack init</span></span><br><span class="line">  <span class="number">401100</span>:	<span class="number">49</span> <span class="number">89</span> e5             	mov    %rsp,%r13</span><br><span class="line">  <span class="number">401103</span>:	<span class="number">48</span> <span class="number">89</span> e6             	mov    %rsp,%rsi</span><br><span class="line">  <span class="number">401106</span>:	e8 <span class="number">51</span> <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40145</span>c &lt;read_six_numbers&gt; <span class="comment">// read six value</span></span><br><span class="line">  <span class="number">40110b</span>:	<span class="number">49</span> <span class="number">89</span> e6             	mov    %rsp,%r14</span><br><span class="line">  <span class="number">40110</span>e:	<span class="number">41</span> bc <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    	mov    $<span class="number">0x0</span>,%r12d</span><br><span class="line">  <span class="number">401114</span>:	<span class="number">4</span>c <span class="number">89</span> ed             	mov    %r13,%rbp</span><br><span class="line">  <span class="number">401117</span>:	<span class="number">41</span> <span class="number">8b</span> <span class="number">45</span> <span class="number">00</span>          	mov    <span class="number">0x0</span>(%r13),%eax</span><br><span class="line">  <span class="number">40111b</span>:	<span class="number">83</span> e8 <span class="number">01</span>             	sub    $<span class="number">0x1</span>,%eax</span><br><span class="line">  <span class="number">40111</span>e:	<span class="number">83</span> f8 <span class="number">05</span>             	cmp    $<span class="number">0x5</span>,%eax</span><br><span class="line">  <span class="number">401121</span>:	<span class="number">76</span> <span class="number">05</span>                	jbe    <span class="number">401128</span> &lt;phase_6+<span class="number">0x34</span>&gt;</span><br><span class="line">  <span class="number">401123</span>:	e8 <span class="number">12</span> <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">401128</span>:	<span class="number">41</span> <span class="number">83</span> c4 <span class="number">01</span>          	add    $<span class="number">0x1</span>,%r12d</span><br><span class="line">  <span class="number">40112</span>c:	<span class="number">41</span> <span class="number">83</span> fc <span class="number">06</span>          	cmp    $<span class="number">0x6</span>,%r12d</span><br><span class="line">  <span class="number">401130</span>:	<span class="number">74</span> <span class="number">21</span>                	je     <span class="number">401153</span> &lt;phase_6+<span class="number">0x5f</span>&gt;</span><br><span class="line">  <span class="number">401132</span>:	<span class="number">44</span> <span class="number">89</span> e3             	mov    %r12d,%ebx</span><br><span class="line">  <span class="number">401135</span>:	<span class="number">48</span> <span class="number">63</span> c3             	movslq %ebx,%rax</span><br><span class="line">  <span class="number">401138</span>:	<span class="number">8b</span> <span class="number">04</span> <span class="number">84</span>             	mov    (%rsp,%rax,<span class="number">4</span>),%eax</span><br><span class="line">  <span class="number">40113b</span>:	<span class="number">39</span> <span class="number">45</span> <span class="number">00</span>             	cmp    %eax,<span class="number">0x0</span>(%rbp)</span><br><span class="line">  <span class="number">40113</span>e:	<span class="number">75</span> <span class="number">05</span>                	jne    <span class="number">401145</span> &lt;phase_6+<span class="number">0x51</span>&gt;</span><br><span class="line">  <span class="number">401140</span>:	e8 f5 <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">401145</span>:	<span class="number">83</span> c3 <span class="number">01</span>             	add    $<span class="number">0x1</span>,%ebx</span><br><span class="line">  <span class="number">401148</span>:	<span class="number">83</span> fb <span class="number">05</span>             	cmp    $<span class="number">0x5</span>,%ebx</span><br><span class="line">  <span class="number">40114b</span>:	<span class="number">7</span>e e8                	jle    <span class="number">401135</span> &lt;phase_6+<span class="number">0x41</span>&gt;</span><br><span class="line">  <span class="number">40114</span>d:	<span class="number">49</span> <span class="number">83</span> c5 <span class="number">04</span>          	add    $<span class="number">0x4</span>,%r13</span><br><span class="line">  <span class="number">401151</span>:	eb c1                	jmp    <span class="number">401114</span> &lt;phase_6+<span class="number">0x20</span>&gt;</span><br><span class="line">  <span class="number">401153</span>:	<span class="number">48</span> <span class="number">8</span>d <span class="number">74</span> <span class="number">24</span> <span class="number">18</span>       	lea    <span class="number">0x18</span>(%rsp),%rsi</span><br><span class="line">  <span class="number">401158</span>:	<span class="number">4</span>c <span class="number">89</span> f0             	mov    %r14,%rax</span><br><span class="line">  <span class="number">40115b</span>:	b9 <span class="number">07</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x7</span>,%ecx</span><br><span class="line">  <span class="number">401160</span>:	<span class="number">89</span> ca                	mov    %ecx,%edx</span><br><span class="line">  <span class="number">401162</span>:	<span class="number">2b</span> <span class="number">10</span>                	sub    (%rax),%edx</span><br><span class="line">  <span class="number">401164</span>:	<span class="number">89</span> <span class="number">10</span>                	mov    %edx,(%rax)</span><br><span class="line">  <span class="number">401166</span>:	<span class="number">48</span> <span class="number">83</span> c0 <span class="number">04</span>          	add    $<span class="number">0x4</span>,%rax</span><br><span class="line">  <span class="number">40116</span>a:	<span class="number">48</span> <span class="number">39</span> f0             	cmp    %rsi,%rax</span><br><span class="line">  <span class="number">40116</span>d:	<span class="number">75</span> f1                	jne    <span class="number">401160</span> &lt;phase_6+<span class="number">0x6c</span>&gt;</span><br><span class="line">  <span class="number">40116f</span>:	be <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%esi</span><br><span class="line">  <span class="number">401174</span>:	eb <span class="number">21</span>                	jmp    <span class="number">401197</span> &lt;phase_6+<span class="number">0xa3</span>&gt;</span><br><span class="line">  <span class="number">401176</span>:	<span class="number">48</span> <span class="number">8b</span> <span class="number">52</span> <span class="number">08</span>          	mov    <span class="number">0x8</span>(%rdx),%rdx</span><br><span class="line">  <span class="number">40117</span>a:	<span class="number">83</span> c0 <span class="number">01</span>             	add    $<span class="number">0x1</span>,%eax</span><br><span class="line">  <span class="number">40117</span>d:	<span class="number">39</span> c8                	cmp    %ecx,%eax</span><br><span class="line">  <span class="number">40117f</span>:	<span class="number">75</span> f5                	jne    <span class="number">401176</span> &lt;phase_6+<span class="number">0x82</span>&gt;</span><br><span class="line">  <span class="number">401181</span>:	eb <span class="number">05</span>                	jmp    <span class="number">401188</span> &lt;phase_6+<span class="number">0x94</span>&gt;</span><br><span class="line">  <span class="number">401183</span>:	ba d0 <span class="number">32</span> <span class="number">60</span> <span class="number">00</span>       	mov    $<span class="number">0x6032d0</span>,%edx</span><br><span class="line">  <span class="number">401188</span>:	<span class="number">48</span> <span class="number">89</span> <span class="number">54</span> <span class="number">74</span> <span class="number">20</span>       	mov    %rdx,<span class="number">0x20</span>(%rsp,%rsi,<span class="number">2</span>)</span><br><span class="line">  <span class="number">40118</span>d:	<span class="number">48</span> <span class="number">83</span> c6 <span class="number">04</span>          	add    $<span class="number">0x4</span>,%rsi</span><br><span class="line">  <span class="number">401191</span>:	<span class="number">48</span> <span class="number">83</span> fe <span class="number">18</span>          	cmp    $<span class="number">0x18</span>,%rsi</span><br><span class="line">  <span class="number">401195</span>:	<span class="number">74</span> <span class="number">14</span>                	je     <span class="number">4011</span>ab &lt;phase_6+<span class="number">0xb7</span>&gt;</span><br><span class="line">  <span class="number">401197</span>:	<span class="number">8b</span> <span class="number">0</span>c <span class="number">34</span>             	mov    (%rsp,%rsi,<span class="number">1</span>),%ecx</span><br><span class="line">  <span class="number">40119</span>a:	<span class="number">83</span> f9 <span class="number">01</span>             	cmp    $<span class="number">0x1</span>,%ecx</span><br><span class="line">  <span class="number">40119</span>d:	<span class="number">7</span>e e4                	jle    <span class="number">401183</span> &lt;phase_6+<span class="number">0x8f</span>&gt;</span><br><span class="line">  <span class="number">40119f</span>:	b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x1</span>,%eax</span><br><span class="line">  <span class="number">4011</span>a4:	ba d0 <span class="number">32</span> <span class="number">60</span> <span class="number">00</span>       	mov    $<span class="number">0x6032d0</span>,%edx</span><br><span class="line">  <span class="number">4011</span>a9:	eb cb                	jmp    <span class="number">401176</span> &lt;phase_6+<span class="number">0x82</span>&gt;</span><br><span class="line">  <span class="number">4011</span>ab:	<span class="number">48</span> <span class="number">8b</span> <span class="number">5</span>c <span class="number">24</span> <span class="number">20</span>       	mov    <span class="number">0x20</span>(%rsp),%rbx</span><br><span class="line">  <span class="number">4011b</span>0:	<span class="number">48</span> <span class="number">8</span>d <span class="number">44</span> <span class="number">24</span> <span class="number">28</span>       	lea    <span class="number">0x28</span>(%rsp),%rax</span><br><span class="line">  <span class="number">4011b</span>5:	<span class="number">48</span> <span class="number">8</span>d <span class="number">74</span> <span class="number">24</span> <span class="number">50</span>       	lea    <span class="number">0x50</span>(%rsp),%rsi</span><br><span class="line">  <span class="number">4011b</span>a:	<span class="number">48</span> <span class="number">89</span> d9             	mov    %rbx,%rcx</span><br><span class="line">  <span class="number">4011b</span>d:	<span class="number">48</span> <span class="number">8b</span> <span class="number">10</span>             	mov    (%rax),%rdx</span><br><span class="line">  <span class="number">4011</span>c0:	<span class="number">48</span> <span class="number">89</span> <span class="number">51</span> <span class="number">08</span>          	mov    %rdx,<span class="number">0x8</span>(%rcx)</span><br><span class="line">  <span class="number">4011</span>c4:	<span class="number">48</span> <span class="number">83</span> c0 <span class="number">08</span>          	add    $<span class="number">0x8</span>,%rax</span><br><span class="line">  <span class="number">4011</span>c8:	<span class="number">48</span> <span class="number">39</span> f0             	cmp    %rsi,%rax</span><br><span class="line">  <span class="number">4011</span>cb:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">4011</span>d2 &lt;phase_6+<span class="number">0xde</span>&gt;</span><br><span class="line">  <span class="number">4011</span>cd:	<span class="number">48</span> <span class="number">89</span> d1             	mov    %rdx,%rcx</span><br><span class="line">  <span class="number">4011</span>d0:	eb eb                	jmp    <span class="number">4011b</span>d &lt;phase_6+<span class="number">0xc9</span>&gt;</span><br><span class="line">  <span class="number">4011</span>d2:	<span class="number">48</span> c7 <span class="number">42</span> <span class="number">08</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 	movq   $<span class="number">0x0</span>,<span class="number">0x8</span>(%rdx)</span><br><span class="line">  <span class="number">4011</span>d9:	<span class="number">00</span> </span><br><span class="line">  <span class="number">4011</span>da:	bd <span class="number">05</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x5</span>,%ebp</span><br><span class="line">  <span class="number">4011</span>df:	<span class="number">48</span> <span class="number">8b</span> <span class="number">43</span> <span class="number">08</span>          	mov    <span class="number">0x8</span>(%rbx),%rax</span><br><span class="line">  <span class="number">4011e3</span>:	<span class="number">8b</span> <span class="number">00</span>                	mov    (%rax),%eax</span><br><span class="line">  <span class="number">4011e5</span>:	<span class="number">39</span> <span class="number">03</span>                	cmp    %eax,(%rbx)</span><br><span class="line">  <span class="number">4011e7</span>:	<span class="number">7</span>d <span class="number">05</span>                	jge    <span class="number">4011</span>ee &lt;phase_6+<span class="number">0xfa</span>&gt;</span><br><span class="line">  <span class="number">4011e9</span>:	e8 <span class="number">4</span>c <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">4011</span>ee:	<span class="number">48</span> <span class="number">8b</span> <span class="number">5b</span> <span class="number">08</span>          	mov    <span class="number">0x8</span>(%rbx),%rbx</span><br><span class="line">  <span class="number">4011f</span>2:	<span class="number">83</span> ed <span class="number">01</span>             	sub    $<span class="number">0x1</span>,%ebp</span><br><span class="line">  <span class="number">4011f</span>5:	<span class="number">75</span> e8                	jne    <span class="number">4011</span>df &lt;phase_6+<span class="number">0xeb</span>&gt;</span><br><span class="line">  <span class="number">4011f</span>7:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">50</span>          	add    $<span class="number">0x50</span>,%rsp</span><br><span class="line">  <span class="number">4011f</span>b:	<span class="number">5b</span>                   	pop    %rbx</span><br><span class="line">  <span class="number">4011f</span>c:	<span class="number">5</span>d                   	pop    %rbp</span><br><span class="line">  <span class="number">4011f</span>d:	<span class="number">41</span> <span class="number">5</span>c                	pop    %r12</span><br><span class="line">  <span class="number">4011f</span>f:	<span class="number">41</span> <span class="number">5</span>d                	pop    %r13</span><br><span class="line">  <span class="number">401201</span>:	<span class="number">41</span> <span class="number">5</span>e                	pop    %r14</span><br><span class="line">  <span class="number">401203</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>首先读入了6个数字，分别放入了<code>%rsp+0x0、%rsp+0x4、%rsp+0x8、%rsp+0xc、%rsp+0x10、%rsp+0x14</code> 。然后是大循环内嵌小循环，大循环中部分的作用是确定每个数必须&lt;=6；小循环的作用是确定第<code>i</code>个数不和第<code>i+1</code><del>第<code>6</code>个数相同（也就是输入的所有数字不能有相同的）。然后，再是一个大循环，主要作用就是令<code>a[i]=7-a[i],i=1,2,3,4,5,6</code>，就是将存于栈中的数（也是你输入的数）进行对7求补并保存回原位置。接下来又是一个大循环套一个小循环，主要作用是访问一个链表，链表的首地址为<code>0x6032d0</code>，针对输入的第<code>i</code>个数，按照<code>a[i]</code>的值获取链表第<code>a[i]</code>个节点，并把节点首地址放入<code>%rsp+0x20+0x0</code></del>到<code>%rsp+0x20+0x28</code>刚好是6个节点。然后又是一个大循环，主要是说明 <code>%rsp+0x20+0x0</code> ~到<code>%rsp+0x20+0x28</code>存储的链表节点值必须是递减的。找到了各节点的值，我们就可以排序得到节点标号的排序，节点标号的排序恰恰是输入6个数字对7求补的值，然后再对7求补即可得到结果<code>4 3 2 1 6 5</code>。</p>
<h2 id="2-7-secret-phase"><a href="#2-7-secret-phase" class="headerlink" title="2.7 secret phase"></a>2.7 secret phase</h2><p>查看 phase_defused 的 assembly code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00000000004015</span>c4 &lt;phase_defused&gt;:</span><br><span class="line">  <span class="number">4015</span>c4:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">78</span>          	sub    $<span class="number">0x78</span>,%rsp</span><br><span class="line">  <span class="number">4015</span>c8:	<span class="number">64</span> <span class="number">48</span> <span class="number">8b</span> <span class="number">04</span> <span class="number">25</span> <span class="number">28</span> <span class="number">00</span> 	mov    %fs:<span class="number">0x28</span>,%rax</span><br><span class="line">  <span class="number">4015</span>cf:	<span class="number">00</span> <span class="number">00</span> </span><br><span class="line">  <span class="number">4015</span>d1:	<span class="number">48</span> <span class="number">89</span> <span class="number">44</span> <span class="number">24</span> <span class="number">68</span>       	mov    %rax,<span class="number">0x68</span>(%rsp)</span><br><span class="line">  <span class="number">4015</span>d6:	<span class="number">31</span> c0                	<span class="keyword">xor</span>    %eax,%eax</span><br><span class="line">  <span class="number">4015</span>d8:	<span class="number">83</span> <span class="number">3</span>d <span class="number">81</span> <span class="number">21</span> <span class="number">20</span> <span class="number">00</span> <span class="number">06</span> 	cmpl   $<span class="number">0x6</span>,<span class="number">0x202181</span>(%rip)        # <span class="number">603760</span> &lt;num_input_strings&gt;</span><br><span class="line">  <span class="number">4015</span>df:	<span class="number">75</span> <span class="number">5</span>e                	jne    <span class="number">40163f</span> &lt;phase_defused+<span class="number">0x7b</span>&gt;</span><br><span class="line">  <span class="number">4015e1</span>:	<span class="number">4</span>c <span class="number">8</span>d <span class="number">44</span> <span class="number">24</span> <span class="number">10</span>       	lea    <span class="number">0x10</span>(%rsp),%r8</span><br><span class="line">  <span class="number">4015e6</span>:	<span class="number">48</span> <span class="number">8</span>d <span class="number">4</span>c <span class="number">24</span> <span class="number">0</span>c       	lea    <span class="number">0xc</span>(%rsp),%rcx</span><br><span class="line">  <span class="number">4015</span>eb:	<span class="number">48</span> <span class="number">8</span>d <span class="number">54</span> <span class="number">24</span> <span class="number">08</span>       	lea    <span class="number">0x8</span>(%rsp),%rdx</span><br><span class="line">  <span class="number">4015f</span>0:	be <span class="number">19</span> <span class="number">26</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x402619</span>,%esi</span><br><span class="line">  <span class="number">4015f</span>5:	bf <span class="number">70</span> <span class="number">38</span> <span class="number">60</span> <span class="number">00</span>       	mov    $<span class="number">0x603870</span>,%edi</span><br><span class="line">  <span class="number">4015f</span>a:	e8 f1 f5 ff ff       	callq  <span class="number">400b</span>f0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  <span class="number">4015f</span>f:	<span class="number">83</span> f8 <span class="number">03</span>             	cmp    $<span class="number">0x3</span>,%eax</span><br><span class="line">  <span class="number">401602</span>:	<span class="number">75</span> <span class="number">31</span>                	jne    <span class="number">401635</span> &lt;phase_defused+<span class="number">0x71</span>&gt;</span><br><span class="line">  <span class="number">401604</span>:	be <span class="number">22</span> <span class="number">26</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x402622</span>,%esi</span><br><span class="line">  <span class="number">401609</span>:	<span class="number">48</span> <span class="number">8</span>d <span class="number">7</span>c <span class="number">24</span> <span class="number">10</span>       	lea    <span class="number">0x10</span>(%rsp),%rdi</span><br><span class="line">  <span class="number">40160</span>e:	e8 <span class="number">25</span> fd ff ff       	callq  <span class="number">401338</span> &lt;strings_not_equal&gt;</span><br><span class="line">  <span class="number">401613</span>:	<span class="number">85</span> c0                	test   %eax,%eax</span><br><span class="line">  <span class="number">401615</span>:	<span class="number">75</span> <span class="number">1</span>e                	jne    <span class="number">401635</span> &lt;phase_defused+<span class="number">0x71</span>&gt;</span><br><span class="line">  <span class="number">401617</span>:	bf f8 <span class="number">24</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x4024f8</span>,%edi</span><br><span class="line">  <span class="number">40161</span>c:	e8 ef f4 ff ff       	callq  <span class="number">400b</span>10 &lt;<span class="built_in">puts</span>@plt&gt;</span><br><span class="line">  <span class="number">401621</span>:	bf <span class="number">20</span> <span class="number">25</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x402520</span>,%edi</span><br><span class="line">  <span class="number">401626</span>:	e8 e5 f4 ff ff       	callq  <span class="number">400b</span>10 &lt;<span class="built_in">puts</span>@plt&gt;</span><br><span class="line">  <span class="number">40162b</span>:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax</span><br><span class="line">  <span class="number">401630</span>:	e8 <span class="number">0</span>d fc ff ff       	callq  <span class="number">401242</span> &lt;secret_phase&gt;</span><br><span class="line">  <span class="number">401635</span>:	bf <span class="number">58</span> <span class="number">25</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x402558</span>,%edi</span><br><span class="line">  <span class="number">40163</span>a:	e8 d1 f4 ff ff       	callq  <span class="number">400b</span>10 &lt;<span class="built_in">puts</span>@plt&gt;</span><br><span class="line">  <span class="number">40163f</span>:	<span class="number">48</span> <span class="number">8b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">68</span>       	mov    <span class="number">0x68</span>(%rsp),%rax</span><br><span class="line">  <span class="number">401644</span>:	<span class="number">64</span> <span class="number">48</span> <span class="number">33</span> <span class="number">04</span> <span class="number">25</span> <span class="number">28</span> <span class="number">00</span> 	<span class="keyword">xor</span>    %fs:<span class="number">0x28</span>,%rax</span><br><span class="line">  <span class="number">40164b</span>:	<span class="number">00</span> <span class="number">00</span> </span><br><span class="line">  <span class="number">40164</span>d:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">401654</span> &lt;phase_defused+<span class="number">0x90</span>&gt;</span><br><span class="line">  <span class="number">40164f</span>:	e8 dc f4 ff ff       	callq  <span class="number">400b</span>30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">  <span class="number">401654</span>:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">78</span>          	add    $<span class="number">0x78</span>,%rsp</span><br><span class="line">  <span class="number">401658</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>可以知道，第四关和第五关前两个都是输入整型，测试一下发现必须要在第四关（第五关不必要）输入的两个整形后面输入”DrEvil”才能成功触发。在gdb中测试，发现  <code>0x402622:”DrEvil”</code> 。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000401242</span> &lt;secret_phase&gt;:</span><br><span class="line">  <span class="number">401242</span>:	<span class="number">53</span>                   	push   %rbx</span><br><span class="line">  <span class="number">401243</span>:	e8 <span class="number">56</span> <span class="number">02</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40149</span>e &lt;read_line&gt;</span><br><span class="line">  <span class="number">401248</span>:	ba <span class="number">0</span>a <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0xa</span>,%edx</span><br><span class="line">  <span class="number">40124</span>d:	be <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%esi</span><br><span class="line">  <span class="number">401252</span>:	<span class="number">48</span> <span class="number">89</span> c7             	mov    %rax,%rdi</span><br><span class="line">  <span class="number">401255</span>:	e8 <span class="number">76</span> f9 ff ff       	callq  <span class="number">400b</span>d0 &lt;strtol@plt&gt;</span><br><span class="line">  <span class="number">40125</span>a:	<span class="number">48</span> <span class="number">89</span> c3             	mov    %rax,%rbx</span><br><span class="line">  <span class="number">40125</span>d:	<span class="number">8</span>d <span class="number">40</span> ff             	lea    <span class="number">-0x1</span>(%rax),%eax</span><br><span class="line">  <span class="number">401260</span>:	<span class="number">3</span>d e8 <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	cmp    $<span class="number">0x3e8</span>,%eax</span><br><span class="line">  <span class="number">401265</span>:	<span class="number">76</span> <span class="number">05</span>                	jbe    <span class="number">40126</span>c &lt;secret_phase+<span class="number">0x2a</span>&gt;</span><br><span class="line">  <span class="number">401267</span>:	e8 ce <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">40126</span>c:	<span class="number">89</span> de                	mov    %ebx,%esi</span><br><span class="line">  <span class="number">40126</span>e:	bf f0 <span class="number">30</span> <span class="number">60</span> <span class="number">00</span>       	mov    $<span class="number">0x6030f0</span>,%edi</span><br><span class="line">  <span class="number">401273</span>:	e8 <span class="number">8</span>c ff ff ff       	callq  <span class="number">401204</span> &lt;fun7&gt;</span><br><span class="line">  <span class="number">401278</span>:	<span class="number">83</span> f8 <span class="number">02</span>             	cmp    $<span class="number">0x2</span>,%eax</span><br><span class="line">  <span class="number">40127b</span>:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">401282</span> &lt;secret_phase+<span class="number">0x40</span>&gt;</span><br><span class="line">  <span class="number">40127</span>d:	e8 b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">40143</span>a &lt;explode_bomb&gt;</span><br><span class="line">  <span class="number">401282</span>:	bf <span class="number">38</span> <span class="number">24</span> <span class="number">40</span> <span class="number">00</span>       	mov    $<span class="number">0x402438</span>,%edi</span><br><span class="line">  <span class="number">401287</span>:	e8 <span class="number">84</span> f8 ff ff       	callq  <span class="number">400b</span>10 &lt;<span class="built_in">puts</span>@plt&gt;</span><br><span class="line">  <span class="number">40128</span>c:	e8 <span class="number">33</span> <span class="number">03</span> <span class="number">00</span> <span class="number">00</span>       	callq  <span class="number">4015</span>c4 &lt;phase_defused&gt;</span><br><span class="line">  <span class="number">401291</span>:	<span class="number">5b</span>                   	pop    %rbx</span><br><span class="line">  <span class="number">401292</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>查看 func7 的 assembly code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000401204</span> &lt;fun7&gt;:</span><br><span class="line">  <span class="number">401204</span>:	<span class="number">48</span> <span class="number">83</span> ec <span class="number">08</span>          	sub    $<span class="number">0x8</span>,%rsp</span><br><span class="line">  <span class="number">401208</span>:	<span class="number">48</span> <span class="number">85</span> ff             	test   %rdi,%rdi</span><br><span class="line">  <span class="number">40120b</span>:	<span class="number">74</span> <span class="number">2b</span>                	je     <span class="number">401238</span> &lt;fun7+<span class="number">0x34</span>&gt;</span><br><span class="line">  <span class="number">40120</span>d:	<span class="number">8b</span> <span class="number">17</span>                	mov    (%rdi),%edx</span><br><span class="line">  <span class="number">40120f</span>:	<span class="number">39</span> f2                	cmp    %esi,%edx</span><br><span class="line">  <span class="number">401211</span>:	<span class="number">7</span>e <span class="number">0</span>d                	jle    <span class="number">401220</span> &lt;fun7+<span class="number">0x1c</span>&gt;</span><br><span class="line">  <span class="number">401213</span>:	<span class="number">48</span> <span class="number">8b</span> <span class="number">7f</span> <span class="number">08</span>          	mov    <span class="number">0x8</span>(%rdi),%rdi</span><br><span class="line">  <span class="number">401217</span>:	e8 e8 ff ff ff       	callq  <span class="number">401204</span> &lt;fun7&gt;</span><br><span class="line">  <span class="number">40121</span>c:	<span class="number">01</span> c0                	add    %eax,%eax</span><br><span class="line">  <span class="number">40121</span>e:	eb <span class="number">1</span>d                	jmp    <span class="number">40123</span>d &lt;fun7+<span class="number">0x39</span>&gt;</span><br><span class="line">  <span class="number">401220</span>:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax</span><br><span class="line">  <span class="number">401225</span>:	<span class="number">39</span> f2                	cmp    %esi,%edx</span><br><span class="line">  <span class="number">401227</span>:	<span class="number">74</span> <span class="number">14</span>                	je     <span class="number">40123</span>d &lt;fun7+<span class="number">0x39</span>&gt;</span><br><span class="line">  <span class="number">401229</span>:	<span class="number">48</span> <span class="number">8b</span> <span class="number">7f</span> <span class="number">10</span>          	mov    <span class="number">0x10</span>(%rdi),%rdi</span><br><span class="line">  <span class="number">40122</span>d:	e8 d2 ff ff ff       	callq  <span class="number">401204</span> &lt;fun7&gt;</span><br><span class="line">  <span class="number">401232</span>:	<span class="number">8</span>d <span class="number">44</span> <span class="number">00</span> <span class="number">01</span>          	lea    <span class="number">0x1</span>(%rax,%rax,<span class="number">1</span>),%eax</span><br><span class="line">  <span class="number">401236</span>:	eb <span class="number">05</span>                	jmp    <span class="number">40123</span>d &lt;fun7+<span class="number">0x39</span>&gt;</span><br><span class="line">  <span class="number">401238</span>:	b8 ff ff ff ff       	mov    $<span class="number">0xffffffff</span>,%eax</span><br><span class="line">  <span class="number">40123</span>d:	<span class="number">48</span> <span class="number">83</span> c4 <span class="number">08</span>          	add    $<span class="number">0x8</span>,%rsp</span><br><span class="line">  <span class="number">401241</span>:	c3                   	retq</span><br></pre></td></tr></table></figure>

<p>可以推断出 func7 的 c 代码是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func7</span><span class="params">(<span class="keyword">int</span> *p, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (*p &lt; n) <span class="keyword">return</span> <span class="number">2</span> * func7(*(p+<span class="number">8</span>), n) + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (*p == n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">2</span>*fun7(*(p+<span class="number">4</span>), n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据secret_phase的返回值为0得到输入的值与指针指向的值相等，即0x24，对应的十进制为36</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>[csapp] Lab2 Bomb Lab</p><p><a href="https://chenghuawang.github.io/2022/02/02/[csapp] Lab2 Bomb Lab/">https://chenghuawang.github.io/2022/02/02/[csapp] Lab2 Bomb Lab/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>WangCH</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-02-02</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-02-11</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CSAPP/">CSAPP</a><a class="link-muted mr-2" rel="tag" href="/tags/computer-architecture/">computer-architecture</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/02/11/%5Bcsapp%5D%20Lab3%20Attack%20Lab/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[csapp] Lab3 Attack Lab</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/01/30/%5Bcsapp%5D%20Lab1%20Data%20Lab/"><span class="level-item">[csapp] Lab1 Data Lab</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "3b2997439c94e166ffc005743dc3a3ad",
            repo: "https://github.com/chenghuaWang/chenghuaWang.github.io",
            owner: "chenghuaWang",
            clientID: "8f30feed9ef2c6b241d6",
            clientSecret: "63c9084e8a2411e2bc01462ba35a9d1b069b86d1",
            admin: ["chenghuaWang"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/boy.jpg" alt="Ubios"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Ubios</p><p class="is-size-6 is-block">Stay hungry,stay foolish.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">6</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/chenghuaWang" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/chenghuaWang"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CSAPP/"><span class="tag">CSAPP</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DL-EMA/"><span class="tag">DL EMA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/computer-architecture/"><span class="tag">computer-architecture</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/quote/"><span class="tag">quote</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/"><span class="tag">期末复习</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Lab2-Bomb-Lab"><span class="level-left"><span class="level-item">1</span><span class="level-item">Lab2 Bomb Lab</span></span></a></li><li><a class="level is-mobile" href="#1-Introduction"><span class="level-left"><span class="level-item">2</span><span class="level-item">1. Introduction</span></span></a></li><li><a class="level is-mobile" href="#2-Puzzle"><span class="level-left"><span class="level-item">3</span><span class="level-item">2. Puzzle</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-Phase-1"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">2.1 Phase 1</span></span></a></li><li><a class="level is-mobile" href="#2-2-phase-2"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">2.2 phase 2</span></span></a></li><li><a class="level is-mobile" href="#2-3-phase-3"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">2.3 phase 3</span></span></a></li><li><a class="level is-mobile" href="#2-4-phase-4"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">2.4 phase 4</span></span></a></li><li><a class="level is-mobile" href="#2-5-phase-5"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">2.5 phase 5</span></span></a></li><li><a class="level is-mobile" href="#2-6-phase-6-loop-amp-linked-list"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">2.6 phase 6 loop &amp; linked-list</span></span></a></li><li><a class="level is-mobile" href="#2-7-secret-phase"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">2.7 secret phase</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="http://pengzhihui.xyz/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">稚晖的个人站</span></span><span class="level-right"><span class="level-item tag">pengzhihui.xyz</span></span></a></li><li><a class="level is-mobile" href="https://codeforces.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">codeforces</span></span><span class="level-right"><span class="level-item tag">codeforces.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/DL/"><span class="level-start"><span class="level-item">DL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/computer-architecture/"><span class="level-start"><span class="level-item">computer architecture</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-17T12:43:00.000Z">2022-03-17</time></p><p class="title"><a href="/2022/03/17/%5Bcsapp%5D%20Lab5%20Shell%20Lab/">[csapp] Lab5 Shell Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-05T05:50:00.000Z">2022-03-05</time></p><p class="title"><a href="/2022/03/05/%5Bcsapp%5D%20Lab4%20Cache%20Lab/">[csapp] Lab4 Cache Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-11T07:31:00.000Z">2022-02-11</time></p><p class="title"><a href="/2022/02/11/%5Bcsapp%5D%20Lab3%20Attack%20Lab/">[csapp] Lab3 Attack Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-02T05:51:00.000Z">2022-02-02</time></p><p class="title"><a href="/2022/02/02/%5Bcsapp%5D%20Lab2%20Bomb%20Lab/">[csapp] Lab2 Bomb Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-30T05:50:00.000Z">2022-01-30</time></p><p class="title"><a href="/2022/01/30/%5Bcsapp%5D%20Lab1%20Data%20Lab/">[csapp] Lab1 Data Lab</a></p><p class="categories"><a href="/categories/computer-architecture/">computer architecture</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/mylogo_h.png" alt="Ubios home" height="28"><script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5fv1ct9766q&amp;amp;m=7&amp;amp;c=e63100&amp;amp;cr1=ffffff&amp;amp;f=arial&amp;amp;l=0&amp;amp;bv=90&amp;amp;lx=-420&amp;amp;ly=420&amp;amp;hi=20&amp;amp;he=7&amp;amp;hc=a8ddff&amp;amp;rs=80" async="async"></script></a><p class="is-size-7"><span>&copy; 2022 WangCH</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/chenghuaWang/chenghuaWang.github.io"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>